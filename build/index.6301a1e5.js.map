{"mappings":"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","sources":["<anon>","src/app.js","node_modules/pica/dist/pica.js"],"sourcesContent":["\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\nvar $41faaf01e3f65d27$exports = {};\n/*!\n\npica\nhttps://github.com/nodeca/pica\n\n*/ (function(f) {\n    var g;\n    $41faaf01e3f65d27$exports = f();\n})(function() {\n    var define, module1, exports;\n    return (function() {\n        function r(e, n, t) {\n            function o(i, f) {\n                if (!n[i]) {\n                    if (!e[i]) {\n                        var c = undefined;\n                        if (!f && c) return c(i, !0);\n                        if (u) return u(i, !0);\n                        var a = new Error(\"Cannot find module '\" + i + \"'\");\n                        throw a.code = \"MODULE_NOT_FOUND\", a;\n                    }\n                    var p = n[i] = {\n                        exports: {}\n                    };\n                    e[i][0].call(p.exports, function(r) {\n                        var n = e[i][1][r];\n                        return o(n || r);\n                    }, p, p.exports, r, e, n, t);\n                }\n                return n[i].exports;\n            }\n            for(var u = undefined, i = 0; i < t.length; i++)o(t[i]);\n            return o;\n        }\n        return r;\n    })()({\n        1: [\n            function(_dereq_, module1, exports) {\n                // Collection of math functions\n                //\n                // 1. Combine components together\n                // 2. Has async init to load wasm modules\n                //\n                \"use strict\";\n                var Multimath = _dereq_(\"multimath\");\n                var mm_unsharp_mask = _dereq_(\"./mm_unsharp_mask\");\n                var mm_resize = _dereq_(\"./mm_resize\");\n                function MathLib(requested_features) {\n                    var __requested_features = requested_features || [];\n                    var features = {\n                        js: __requested_features.indexOf(\"js\") >= 0,\n                        wasm: __requested_features.indexOf(\"wasm\") >= 0\n                    };\n                    Multimath.call(this, features);\n                    this.features = {\n                        js: features.js,\n                        wasm: features.wasm && this.has_wasm()\n                    };\n                    this.use(mm_unsharp_mask);\n                    this.use(mm_resize);\n                }\n                MathLib.prototype = Object.create(Multimath.prototype);\n                MathLib.prototype.constructor = MathLib;\n                MathLib.prototype.resizeAndUnsharp = function resizeAndUnsharp(options, cache) {\n                    var result = this.resize(options, cache);\n                    if (options.unsharpAmount) this.unsharp_mask(result, options.toWidth, options.toHeight, options.unsharpAmount, options.unsharpRadius, options.unsharpThreshold);\n                    return result;\n                };\n                module1.exports = MathLib;\n            },\n            {\n                \"./mm_resize\": 4,\n                \"./mm_unsharp_mask\": 9,\n                \"multimath\": 19\n            }\n        ],\n        2: [\n            function(_dereq_, module1, exports) {\n                // Resize convolvers, pure JS implementation\n                //\n                \"use strict\"; // Precision of fixed FP values\n                //var FIXED_FRAC_BITS = 14;\n                function clampTo8(i) {\n                    return i < 0 ? 0 : i > 255 ? 255 : i;\n                }\n                function clampNegative(i) {\n                    return i >= 0 ? i : 0;\n                } // Convolve image data in horizontal direction. Can be used for:\n                //\n                // 1. bitmap with premultiplied alpha\n                // 2. bitmap without alpha (all values 255)\n                //\n                // Notes:\n                //\n                // - output is transposed\n                // - output resolution is ~15 bits per channel(for better precision).\n                //\n                function convolveHor(src, dest, srcW, srcH, destW, filters) {\n                    var r, g, b, a;\n                    var filterPtr, filterShift, filterSize;\n                    var srcPtr, srcY, destX, filterVal;\n                    var srcOffset = 0, destOffset = 0; // For each row\n                    for(srcY = 0; srcY < srcH; srcY++){\n                        filterPtr = 0; // Apply precomputed filters to each destination row point\n                        for(destX = 0; destX < destW; destX++){\n                            // Get the filter that determines the current output pixel.\n                            filterShift = filters[filterPtr++];\n                            filterSize = filters[filterPtr++];\n                            srcPtr = srcOffset + filterShift * 4 | 0;\n                            r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n                            for(; filterSize > 0; filterSize--){\n                                filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n                                // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n                                a = a + filterVal * src[srcPtr + 3] | 0;\n                                b = b + filterVal * src[srcPtr + 2] | 0;\n                                g = g + filterVal * src[srcPtr + 1] | 0;\n                                r = r + filterVal * src[srcPtr] | 0;\n                                srcPtr = srcPtr + 4 | 0;\n                            } // Store 15 bits between passes for better precision\n                            // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n                            //\n                            dest[destOffset + 3] = clampNegative(a >> 7);\n                            dest[destOffset + 2] = clampNegative(b >> 7);\n                            dest[destOffset + 1] = clampNegative(g >> 7);\n                            dest[destOffset] = clampNegative(r >> 7);\n                            destOffset = destOffset + srcH * 4 | 0;\n                        }\n                        destOffset = (srcY + 1) * 4 | 0;\n                        srcOffset = (srcY + 1) * srcW * 4 | 0;\n                    }\n                } // Supplementary method for `convolveHor()`\n                //\n                function convolveVert(src, dest, srcW, srcH, destW, filters) {\n                    var r, g, b, a;\n                    var filterPtr, filterShift, filterSize;\n                    var srcPtr, srcY, destX, filterVal;\n                    var srcOffset = 0, destOffset = 0; // For each row\n                    for(srcY = 0; srcY < srcH; srcY++){\n                        filterPtr = 0; // Apply precomputed filters to each destination row point\n                        for(destX = 0; destX < destW; destX++){\n                            // Get the filter that determines the current output pixel.\n                            filterShift = filters[filterPtr++];\n                            filterSize = filters[filterPtr++];\n                            srcPtr = srcOffset + filterShift * 4 | 0;\n                            r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n                            for(; filterSize > 0; filterSize--){\n                                filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n                                // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n                                a = a + filterVal * src[srcPtr + 3] | 0;\n                                b = b + filterVal * src[srcPtr + 2] | 0;\n                                g = g + filterVal * src[srcPtr + 1] | 0;\n                                r = r + filterVal * src[srcPtr] | 0;\n                                srcPtr = srcPtr + 4 | 0;\n                            } // Sync with premultiplied version for exact result match\n                            r >>= 7;\n                            g >>= 7;\n                            b >>= 7;\n                            a >>= 7; // Bring this value back in range + round result.\n                            //\n                            dest[destOffset + 3] = clampTo8(a + 8192 >> 14);\n                            dest[destOffset + 2] = clampTo8(b + 8192 >> 14);\n                            dest[destOffset + 1] = clampTo8(g + 8192 >> 14);\n                            dest[destOffset] = clampTo8(r + 8192 >> 14);\n                            destOffset = destOffset + srcH * 4 | 0;\n                        }\n                        destOffset = (srcY + 1) * 4 | 0;\n                        srcOffset = (srcY + 1) * srcW * 4 | 0;\n                    }\n                } // Premultiply & convolve image data in horizontal direction. Can be used for:\n                //\n                // - Any bitmap data, extracted with `.getImageData()` method (with\n                //   non-premultiplied alpha)\n                //\n                // For images without alpha channel this method is slower than `convolveHor()`\n                //\n                function convolveHorWithPre(src, dest, srcW, srcH, destW, filters) {\n                    var r, g, b, a, alpha;\n                    var filterPtr, filterShift, filterSize;\n                    var srcPtr, srcY, destX, filterVal;\n                    var srcOffset = 0, destOffset = 0; // For each row\n                    for(srcY = 0; srcY < srcH; srcY++){\n                        filterPtr = 0; // Apply precomputed filters to each destination row point\n                        for(destX = 0; destX < destW; destX++){\n                            // Get the filter that determines the current output pixel.\n                            filterShift = filters[filterPtr++];\n                            filterSize = filters[filterPtr++];\n                            srcPtr = srcOffset + filterShift * 4 | 0;\n                            r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n                            for(; filterSize > 0; filterSize--){\n                                filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n                                // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n                                alpha = src[srcPtr + 3];\n                                a = a + filterVal * alpha | 0;\n                                b = b + filterVal * src[srcPtr + 2] * alpha | 0;\n                                g = g + filterVal * src[srcPtr + 1] * alpha | 0;\n                                r = r + filterVal * src[srcPtr] * alpha | 0;\n                                srcPtr = srcPtr + 4 | 0;\n                            } // Premultiply is (* alpha / 255).\n                            // Postpone division for better performance\n                            b = b / 255 | 0;\n                            g = g / 255 | 0;\n                            r = r / 255 | 0; // Store 15 bits between passes for better precision\n                            // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n                            //\n                            dest[destOffset + 3] = clampNegative(a >> 7);\n                            dest[destOffset + 2] = clampNegative(b >> 7);\n                            dest[destOffset + 1] = clampNegative(g >> 7);\n                            dest[destOffset] = clampNegative(r >> 7);\n                            destOffset = destOffset + srcH * 4 | 0;\n                        }\n                        destOffset = (srcY + 1) * 4 | 0;\n                        srcOffset = (srcY + 1) * srcW * 4 | 0;\n                    }\n                } // Supplementary method for `convolveHorWithPre()`\n                //\n                function convolveVertWithPre(src, dest, srcW, srcH, destW, filters) {\n                    var r, g, b, a;\n                    var filterPtr, filterShift, filterSize;\n                    var srcPtr, srcY, destX, filterVal;\n                    var srcOffset = 0, destOffset = 0; // For each row\n                    for(srcY = 0; srcY < srcH; srcY++){\n                        filterPtr = 0; // Apply precomputed filters to each destination row point\n                        for(destX = 0; destX < destW; destX++){\n                            // Get the filter that determines the current output pixel.\n                            filterShift = filters[filterPtr++];\n                            filterSize = filters[filterPtr++];\n                            srcPtr = srcOffset + filterShift * 4 | 0;\n                            r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n                            for(; filterSize > 0; filterSize--){\n                                filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n                                // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n                                a = a + filterVal * src[srcPtr + 3] | 0;\n                                b = b + filterVal * src[srcPtr + 2] | 0;\n                                g = g + filterVal * src[srcPtr + 1] | 0;\n                                r = r + filterVal * src[srcPtr] | 0;\n                                srcPtr = srcPtr + 4 | 0;\n                            } // Downscale to leave room for un-premultiply\n                            r >>= 7;\n                            g >>= 7;\n                            b >>= 7;\n                            a >>= 7; // Un-premultiply\n                            a = clampTo8(a + 8192 >> 14);\n                            if (a > 0) {\n                                r = r * 255 / a | 0;\n                                g = g * 255 / a | 0;\n                                b = b * 255 / a | 0;\n                            } // Bring this value back in range + round result.\n                            // Shift value = FIXED_FRAC_BITS + 7\n                            //\n                            dest[destOffset + 3] = a;\n                            dest[destOffset + 2] = clampTo8(b + 8192 >> 14);\n                            dest[destOffset + 1] = clampTo8(g + 8192 >> 14);\n                            dest[destOffset] = clampTo8(r + 8192 >> 14);\n                            destOffset = destOffset + srcH * 4 | 0;\n                        }\n                        destOffset = (srcY + 1) * 4 | 0;\n                        srcOffset = (srcY + 1) * srcW * 4 | 0;\n                    }\n                }\n                module1.exports = {\n                    convolveHor: convolveHor,\n                    convolveVert: convolveVert,\n                    convolveHorWithPre: convolveHorWithPre,\n                    convolveVertWithPre: convolveVertWithPre\n                };\n            },\n            {}\n        ],\n        3: [\n            function(_dereq_, module1, exports) {\n                // This is autogenerated file from math.wasm, don't edit.\n                //\n                \"use strict\";\n                /* eslint-disable max-len */ module1.exports = \"AGFzbQEAAAAADAZkeWxpbmsAAAAAAAEYA2AGf39/f39/AGAAAGAIf39/f39/f38AAg8BA2VudgZtZW1vcnkCAAADBwYBAAAAAAIGBgF/AEEACweUAQgRX193YXNtX2NhbGxfY3RvcnMAAAtjb252b2x2ZUhvcgABDGNvbnZvbHZlVmVydAACEmNvbnZvbHZlSG9yV2l0aFByZQADE2NvbnZvbHZlVmVydFdpdGhQcmUABApjb252b2x2ZUhWAAUMX19kc29faGFuZGxlAwAYX193YXNtX2FwcGx5X2RhdGFfcmVsb2NzAAAKyA4GAwABC4wDARB/AkAgA0UNACAERQ0AIANBAnQhFQNAQQAhE0EAIQsDQCALQQJqIQcCfyALQQF0IAVqIgYuAQIiC0UEQEEAIQhBACEGQQAhCUEAIQogBwwBCyASIAYuAQBqIQhBACEJQQAhCiALIRRBACEOIAchBkEAIQ8DQCAFIAZBAXRqLgEAIhAgACAIQQJ0aigCACIRQRh2bCAPaiEPIBFB/wFxIBBsIAlqIQkgEUEQdkH/AXEgEGwgDmohDiARQQh2Qf8BcSAQbCAKaiEKIAhBAWohCCAGQQFqIQYgFEEBayIUDQALIAlBB3UhCCAKQQd1IQYgDkEHdSEJIA9BB3UhCiAHIAtqCyELIAEgDEEBdCIHaiAIQQAgCEEAShs7AQAgASAHQQJyaiAGQQAgBkEAShs7AQAgASAHQQRyaiAJQQAgCUEAShs7AQAgASAHQQZyaiAKQQAgCkEAShs7AQAgDCAVaiEMIBNBAWoiEyAERw0ACyANQQFqIg0gAmwhEiANQQJ0IQwgAyANRw0ACwsL2gMBD38CQCADRQ0AIARFDQAgAkECdCEUA0AgCyEMQQAhE0EAIQIDQCACQQJqIQYCfyACQQF0IAVqIgcuAQIiAkUEQEEAIQhBACEHQQAhCkEAIQkgBgwBCyAHLgEAQQJ0IBJqIQhBACEJIAIhCkEAIQ0gBiEHQQAhDkEAIQ8DQCAFIAdBAXRqLgEAIhAgACAIQQF0IhFqLwEAbCAJaiEJIAAgEUEGcmovAQAgEGwgDmohDiAAIBFBBHJqLwEAIBBsIA9qIQ8gACARQQJyai8BACAQbCANaiENIAhBBGohCCAHQQFqIQcgCkEBayIKDQALIAlBB3UhCCANQQd1IQcgDkEHdSEKIA9BB3UhCSACIAZqCyECIAEgDEECdGogB0GAQGtBDnUiBkH/ASAGQf8BSBsiBkEAIAZBAEobQQh0QYD+A3EgCUGAQGtBDnUiBkH/ASAGQf8BSBsiBkEAIAZBAEobQRB0QYCA/AdxIApBgEBrQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG0EYdHJyIAhBgEBrQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG3I2AgAgAyAMaiEMIBNBAWoiEyAERw0ACyAUIAtBAWoiC2whEiADIAtHDQALCwuSAwEQfwJAIANFDQAgBEUNACADQQJ0IRUDQEEAIRNBACEGA0AgBkECaiEIAn8gBkEBdCAFaiIGLgECIgdFBEBBACEJQQAhDEEAIQ1BACEOIAgMAQsgEiAGLgEAaiEJQQAhDkEAIQ1BACEMIAchFEEAIQ8gCCEGA0AgBSAGQQF0ai4BACAAIAlBAnRqKAIAIhBBGHZsIhEgD2ohDyARIBBBEHZB/wFxbCAMaiEMIBEgEEEIdkH/AXFsIA1qIQ0gESAQQf8BcWwgDmohDiAJQQFqIQkgBkEBaiEGIBRBAWsiFA0ACyAPQQd1IQkgByAIagshBiABIApBAXQiCGogDkH/AW1BB3UiB0EAIAdBAEobOwEAIAEgCEECcmogDUH/AW1BB3UiB0EAIAdBAEobOwEAIAEgCEEEcmogDEH/AW1BB3UiB0EAIAdBAEobOwEAIAEgCEEGcmogCUEAIAlBAEobOwEAIAogFWohCiATQQFqIhMgBEcNAAsgC0EBaiILIAJsIRIgC0ECdCEKIAMgC0cNAAsLC4IEAQ9/AkAgA0UNACAERQ0AIAJBAnQhFANAIAshDEEAIRJBACEHA0AgB0ECaiEKAn8gB0EBdCAFaiICLgECIhNFBEBBACEIQQAhCUEAIQYgCiEHQQAMAQsgAi4BAEECdCARaiEJQQAhByATIQJBACENIAohBkEAIQ5BACEPA0AgBSAGQQF0ai4BACIIIAAgCUEBdCIQai8BAGwgB2ohByAAIBBBBnJqLwEAIAhsIA5qIQ4gACAQQQRyai8BACAIbCAPaiEPIAAgEEECcmovAQAgCGwgDWohDSAJQQRqIQkgBkEBaiEGIAJBAWsiAg0ACyAHQQd1IQggDUEHdSEJIA9BB3UhBiAKIBNqIQcgDkEHdQtBgEBrQQ51IgJB/wEgAkH/AUgbIgJBACACQQBKGyIKQf8BcQRAIAlB/wFsIAJtIQkgCEH/AWwgAm0hCCAGQf8BbCACbSEGCyABIAxBAnRqIAlBgEBrQQ51IgJB/wEgAkH/AUgbIgJBACACQQBKG0EIdEGA/gNxIAZBgEBrQQ51IgJB/wEgAkH/AUgbIgJBACACQQBKG0EQdEGAgPwHcSAKQRh0ciAIQYBAa0EOdSICQf8BIAJB/wFIGyICQQAgAkEAShtycjYCACADIAxqIQwgEkEBaiISIARHDQALIBQgC0EBaiILbCERIAMgC0cNAAsLC0AAIAcEQEEAIAIgAyAEIAUgABADIAJBACAEIAUgBiABEAQPC0EAIAIgAyAEIAUgABABIAJBACAEIAUgBiABEAIL\";\n            },\n            {}\n        ],\n        4: [\n            function(_dereq_, module1, exports) {\n                \"use strict\";\n                module1.exports = {\n                    name: \"resize\",\n                    fn: _dereq_(\"./resize\"),\n                    wasm_fn: _dereq_(\"./resize_wasm\"),\n                    wasm_src: _dereq_(\"./convolve_wasm_base64\")\n                };\n            },\n            {\n                \"./convolve_wasm_base64\": 3,\n                \"./resize\": 5,\n                \"./resize_wasm\": 8\n            }\n        ],\n        5: [\n            function(_dereq_, module1, exports) {\n                \"use strict\";\n                var createFilters = _dereq_(\"./resize_filter_gen\");\n                var _require = _dereq_(\"./convolve\"), convolveHor = _require.convolveHor, convolveVert = _require.convolveVert, convolveHorWithPre = _require.convolveHorWithPre, convolveVertWithPre = _require.convolveVertWithPre;\n                function hasAlpha(src, width, height) {\n                    var ptr = 3, len = width * height * 4 | 0;\n                    while(ptr < len){\n                        if (src[ptr] !== 255) return true;\n                        ptr = ptr + 4 | 0;\n                    }\n                    return false;\n                }\n                function resetAlpha(dst, width, height) {\n                    var ptr = 3, len = width * height * 4 | 0;\n                    while(ptr < len){\n                        dst[ptr] = 0xFF;\n                        ptr = ptr + 4 | 0;\n                    }\n                }\n                module1.exports = function resize(options) {\n                    var src = options.src;\n                    var srcW = options.width;\n                    var srcH = options.height;\n                    var destW = options.toWidth;\n                    var destH = options.toHeight;\n                    var scaleX = options.scaleX || options.toWidth / options.width;\n                    var scaleY = options.scaleY || options.toHeight / options.height;\n                    var offsetX = options.offsetX || 0;\n                    var offsetY = options.offsetY || 0;\n                    var dest = options.dest || new Uint8Array(destW * destH * 4);\n                    var filter = typeof options.filter === \"undefined\" ? \"mks2013\" : options.filter;\n                    var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX), filtersY = createFilters(filter, srcH, destH, scaleY, offsetY);\n                    var tmp = new Uint16Array(destW * srcH * 4); // Autodetect if alpha channel exists, and use appropriate method\n                    if (hasAlpha(src, srcW, srcH)) {\n                        convolveHorWithPre(src, tmp, srcW, srcH, destW, filtersX);\n                        convolveVertWithPre(tmp, dest, srcH, destW, destH, filtersY);\n                    } else {\n                        convolveHor(src, tmp, srcW, srcH, destW, filtersX);\n                        convolveVert(tmp, dest, srcH, destW, destH, filtersY);\n                        resetAlpha(dest, destW, destH);\n                    }\n                    return dest;\n                };\n            },\n            {\n                \"./convolve\": 2,\n                \"./resize_filter_gen\": 6\n            }\n        ],\n        6: [\n            function(_dereq_, module1, exports) {\n                // Calculate convolution filters for each destination point,\n                // and pack data to Int16Array:\n                //\n                // [ shift, length, data..., shift2, length2, data..., ... ]\n                //\n                // - shift - offset in src image\n                // - length - filter length (in src points)\n                // - data - filter values sequence\n                //\n                \"use strict\";\n                var FILTER_INFO = _dereq_(\"./resize_filter_info\"); // Precision of fixed FP values\n                var FIXED_FRAC_BITS = 14;\n                function toFixedPoint(num) {\n                    return Math.round(num * ((1 << FIXED_FRAC_BITS) - 1));\n                }\n                module1.exports = function resizeFilterGen(filter, srcSize, destSize, scale, offset) {\n                    var filterFunction = FILTER_INFO.filter[filter].fn;\n                    var scaleInverted = 1.0 / scale;\n                    var scaleClamped = Math.min(1.0, scale); // For upscale\n                    // Filter window (averaging interval), scaled to src image\n                    var srcWindow = FILTER_INFO.filter[filter].win / scaleClamped;\n                    var destPixel, srcPixel, srcFirst, srcLast, filterElementSize, floatFilter, fxpFilter, total, pxl, idx, floatVal, filterTotal, filterVal;\n                    var leftNotEmpty, rightNotEmpty, filterShift, filterSize;\n                    var maxFilterElementSize = Math.floor((srcWindow + 1) * 2);\n                    var packedFilter = new Int16Array((maxFilterElementSize + 2) * destSize);\n                    var packedFilterPtr = 0;\n                    var slowCopy = !packedFilter.subarray || !packedFilter.set; // For each destination pixel calculate source range and built filter values\n                    for(destPixel = 0; destPixel < destSize; destPixel++){\n                        // Scaling should be done relative to central pixel point\n                        srcPixel = (destPixel + 0.5) * scaleInverted + offset;\n                        srcFirst = Math.max(0, Math.floor(srcPixel - srcWindow));\n                        srcLast = Math.min(srcSize - 1, Math.ceil(srcPixel + srcWindow));\n                        filterElementSize = srcLast - srcFirst + 1;\n                        floatFilter = new Float32Array(filterElementSize);\n                        fxpFilter = new Int16Array(filterElementSize);\n                        total = 0.0; // Fill filter values for calculated range\n                        for(pxl = srcFirst, idx = 0; pxl <= srcLast; pxl++, idx++){\n                            floatVal = filterFunction((pxl + 0.5 - srcPixel) * scaleClamped);\n                            total += floatVal;\n                            floatFilter[idx] = floatVal;\n                        } // Normalize filter, convert to fixed point and accumulate conversion error\n                        filterTotal = 0;\n                        for(idx = 0; idx < floatFilter.length; idx++){\n                            filterVal = floatFilter[idx] / total;\n                            filterTotal += filterVal;\n                            fxpFilter[idx] = toFixedPoint(filterVal);\n                        } // Compensate normalization error, to minimize brightness drift\n                        fxpFilter[destSize >> 1] += toFixedPoint(1.0 - filterTotal); //\n                        // Now pack filter to useable form\n                        //\n                        // 1. Trim heading and tailing zero values, and compensate shitf/length\n                        // 2. Put all to single array in this format:\n                        //\n                        //    [ pos shift, data length, value1, value2, value3, ... ]\n                        //\n                        leftNotEmpty = 0;\n                        while(leftNotEmpty < fxpFilter.length && fxpFilter[leftNotEmpty] === 0)leftNotEmpty++;\n                        if (leftNotEmpty < fxpFilter.length) {\n                            rightNotEmpty = fxpFilter.length - 1;\n                            while(rightNotEmpty > 0 && fxpFilter[rightNotEmpty] === 0)rightNotEmpty--;\n                            filterShift = srcFirst + leftNotEmpty;\n                            filterSize = rightNotEmpty - leftNotEmpty + 1;\n                            packedFilter[packedFilterPtr++] = filterShift; // shift\n                            packedFilter[packedFilterPtr++] = filterSize; // size\n                            if (!slowCopy) {\n                                packedFilter.set(fxpFilter.subarray(leftNotEmpty, rightNotEmpty + 1), packedFilterPtr);\n                                packedFilterPtr += filterSize;\n                            } else // fallback for old IE < 11, without subarray/set methods\n                            for(idx = leftNotEmpty; idx <= rightNotEmpty; idx++)packedFilter[packedFilterPtr++] = fxpFilter[idx];\n                        } else {\n                            // zero data, write header only\n                            packedFilter[packedFilterPtr++] = 0; // shift\n                            packedFilter[packedFilterPtr++] = 0; // size\n                        }\n                    }\n                    return packedFilter;\n                };\n            },\n            {\n                \"./resize_filter_info\": 7\n            }\n        ],\n        7: [\n            function(_dereq_, module1, exports) {\n                // Filter definitions to build tables for\n                // resizing convolvers.\n                //\n                // Presets for quality 0..3. Filter functions + window size\n                //\n                \"use strict\";\n                var filter = {\n                    // Nearest neibor\n                    box: {\n                        win: 0.5,\n                        fn: function fn(x) {\n                            if (x < 0) x = -x;\n                            return x < 0.5 ? 1.0 : 0.0;\n                        }\n                    },\n                    // // Hamming\n                    hamming: {\n                        win: 1.0,\n                        fn: function fn(x) {\n                            if (x < 0) x = -x;\n                            if (x >= 1.0) return 0.0;\n                            if (x < 1.19209290E-07) return 1.0;\n                            var xpi = x * Math.PI;\n                            return Math.sin(xpi) / xpi * (0.54 + 0.46 * Math.cos(xpi / 1.0));\n                        }\n                    },\n                    // Lanczos, win = 2\n                    lanczos2: {\n                        win: 2.0,\n                        fn: function fn(x) {\n                            if (x < 0) x = -x;\n                            if (x >= 2.0) return 0.0;\n                            if (x < 1.19209290E-07) return 1.0;\n                            var xpi = x * Math.PI;\n                            return Math.sin(xpi) / xpi * Math.sin(xpi / 2.0) / (xpi / 2.0);\n                        }\n                    },\n                    // Lanczos, win = 3\n                    lanczos3: {\n                        win: 3.0,\n                        fn: function fn(x) {\n                            if (x < 0) x = -x;\n                            if (x >= 3.0) return 0.0;\n                            if (x < 1.19209290E-07) return 1.0;\n                            var xpi = x * Math.PI;\n                            return Math.sin(xpi) / xpi * Math.sin(xpi / 3.0) / (xpi / 3.0);\n                        }\n                    },\n                    // Magic Kernel Sharp 2013, win = 2.5\n                    // http://johncostella.com/magic/\n                    mks2013: {\n                        win: 2.5,\n                        fn: function fn(x) {\n                            if (x < 0) x = -x;\n                            if (x >= 2.5) return 0.0;\n                            if (x >= 1.5) return -0.125 * (x - 2.5) * (x - 2.5);\n                            if (x >= 0.5) return 0.25 * (4 * x * x - 11 * x + 7);\n                            return 1.0625 - 1.75 * x * x;\n                        }\n                    }\n                };\n                module1.exports = {\n                    filter: filter,\n                    // Legacy mapping\n                    f2q: {\n                        box: 0,\n                        hamming: 1,\n                        lanczos2: 2,\n                        lanczos3: 3\n                    },\n                    q2f: [\n                        \"box\",\n                        \"hamming\",\n                        \"lanczos2\",\n                        \"lanczos3\"\n                    ]\n                };\n            },\n            {}\n        ],\n        8: [\n            function(_dereq_, module1, exports) {\n                \"use strict\";\n                var createFilters = _dereq_(\"./resize_filter_gen\");\n                function hasAlpha(src, width, height) {\n                    var ptr = 3, len = width * height * 4 | 0;\n                    while(ptr < len){\n                        if (src[ptr] !== 255) return true;\n                        ptr = ptr + 4 | 0;\n                    }\n                    return false;\n                }\n                function resetAlpha(dst, width, height) {\n                    var ptr = 3, len = width * height * 4 | 0;\n                    while(ptr < len){\n                        dst[ptr] = 0xFF;\n                        ptr = ptr + 4 | 0;\n                    }\n                }\n                function asUint8Array(src) {\n                    return new Uint8Array(src.buffer, 0, src.byteLength);\n                }\n                var IS_LE = true; // should not crash everything on module load in old browsers\n                try {\n                    IS_LE = new Uint32Array(new Uint8Array([\n                        1,\n                        0,\n                        0,\n                        0\n                    ]).buffer)[0] === 1;\n                } catch (__) {}\n                function copyInt16asLE(src, target, target_offset) {\n                    if (IS_LE) {\n                        target.set(asUint8Array(src), target_offset);\n                        return;\n                    }\n                    for(var ptr = target_offset, i = 0; i < src.length; i++){\n                        var data = src[i];\n                        target[ptr++] = data & 0xFF;\n                        target[ptr++] = data >> 8 & 0xFF;\n                    }\n                }\n                module1.exports = function resize_wasm(options) {\n                    var src = options.src;\n                    var srcW = options.width;\n                    var srcH = options.height;\n                    var destW = options.toWidth;\n                    var destH = options.toHeight;\n                    var scaleX = options.scaleX || options.toWidth / options.width;\n                    var scaleY = options.scaleY || options.toHeight / options.height;\n                    var offsetX = options.offsetX || 0.0;\n                    var offsetY = options.offsetY || 0.0;\n                    var dest = options.dest || new Uint8Array(destW * destH * 4);\n                    var filter = typeof options.filter === \"undefined\" ? \"mks2013\" : options.filter;\n                    var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX), filtersY = createFilters(filter, srcH, destH, scaleY, offsetY); // destination is 0 too.\n                    var src_offset = 0;\n                    var src_size = Math.max(src.byteLength, dest.byteLength); // buffer between convolve passes\n                    var tmp_offset = this.__align(src_offset + src_size);\n                    var tmp_size = srcH * destW * 8; // 2 bytes per channel\n                    var filtersX_offset = this.__align(tmp_offset + tmp_size);\n                    var filtersY_offset = this.__align(filtersX_offset + filtersX.byteLength);\n                    var alloc_bytes = filtersY_offset + filtersY.byteLength;\n                    var instance = this.__instance(\"resize\", alloc_bytes); //\n                    // Fill memory block with data to process\n                    //\n                    var mem = new Uint8Array(this.__memory.buffer);\n                    var mem32 = new Uint32Array(this.__memory.buffer); // 32-bit copy is much faster in chrome\n                    var src32 = new Uint32Array(src.buffer);\n                    mem32.set(src32); // We should guarantee LE bytes order. Filters are not big, so\n                    // speed difference is not significant vs direct .set()\n                    copyInt16asLE(filtersX, mem, filtersX_offset);\n                    copyInt16asLE(filtersY, mem, filtersY_offset); // Now call webassembly method\n                    // emsdk does method names with '_'\n                    var fn = instance.exports.convolveHV || instance.exports._convolveHV;\n                    if (hasAlpha(src, srcW, srcH)) fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 1);\n                    else {\n                        fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 0);\n                        resetAlpha(dest, destW, destH);\n                    } //\n                    // Copy data back to typed array\n                    //\n                    // 32-bit copy is much faster in chrome\n                    var dest32 = new Uint32Array(dest.buffer);\n                    dest32.set(new Uint32Array(this.__memory.buffer, 0, destH * destW));\n                    return dest;\n                };\n            },\n            {\n                \"./resize_filter_gen\": 6\n            }\n        ],\n        9: [\n            function(_dereq_, module1, exports) {\n                \"use strict\";\n                module1.exports = {\n                    name: \"unsharp_mask\",\n                    fn: _dereq_(\"./unsharp_mask\"),\n                    wasm_fn: _dereq_(\"./unsharp_mask_wasm\"),\n                    wasm_src: _dereq_(\"./unsharp_mask_wasm_base64\")\n                };\n            },\n            {\n                \"./unsharp_mask\": 10,\n                \"./unsharp_mask_wasm\": 11,\n                \"./unsharp_mask_wasm_base64\": 12\n            }\n        ],\n        10: [\n            function(_dereq_, module1, exports) {\n                // Unsharp mask filter\n                //\n                // http://stackoverflow.com/a/23322820/1031804\n                // USM(O) = O + (2 * (Amount / 100) * (O - GB))\n                // GB - gaussian blur.\n                //\n                // Image is converted from RGB to HSV, unsharp mask is applied to the\n                // brightness channel and then image is converted back to RGB.\n                //\n                \"use strict\";\n                var glur_mono16 = _dereq_(\"glur/mono16\");\n                function hsv_v16(img, width, height) {\n                    var size = width * height;\n                    var out = new Uint16Array(size);\n                    var r, g, b, max;\n                    for(var i = 0; i < size; i++){\n                        r = img[4 * i];\n                        g = img[4 * i + 1];\n                        b = img[4 * i + 2];\n                        max = r >= g && r >= b ? r : g >= b && g >= r ? g : b;\n                        out[i] = max << 8;\n                    }\n                    return out;\n                }\n                module1.exports = function unsharp(img, width, height, amount, radius, threshold) {\n                    var v1, v2, vmul;\n                    var diff, iTimes4;\n                    if (amount === 0 || radius < 0.5) return;\n                    if (radius > 2.0) radius = 2.0;\n                    var brightness = hsv_v16(img, width, height);\n                    var blured = new Uint16Array(brightness); // copy, because blur modify src\n                    glur_mono16(blured, width, height, radius);\n                    var amountFp = amount / 100 * 0x1000 + 0.5 | 0;\n                    var thresholdFp = threshold << 8;\n                    var size = width * height;\n                    /* eslint-disable indent */ for(var i = 0; i < size; i++){\n                        v1 = brightness[i];\n                        diff = v1 - blured[i];\n                        if (Math.abs(diff) >= thresholdFp) {\n                            // add unsharp mask to the brightness channel\n                            v2 = v1 + (amountFp * diff + 0x800 >> 12); // Both v1 and v2 are within [0.0 .. 255.0] (0000-FF00) range, never going into\n                            // [255.003 .. 255.996] (FF01-FFFF). This allows to round this value as (x+.5)|0\n                            // later without overflowing.\n                            v2 = v2 > 0xff00 ? 0xff00 : v2;\n                            v2 = v2 < 0x0000 ? 0x0000 : v2; // Avoid division by 0. V=0 means rgb(0,0,0), unsharp with unsharpAmount>0 cannot\n                            // change this value (because diff between colors gets inflated), so no need to verify correctness.\n                            v1 = v1 !== 0 ? v1 : 1; // Multiplying V in HSV model by a constant is equivalent to multiplying each component\n                            // in RGB by the same constant (same for HSL), see also:\n                            // https://beesbuzz.biz/code/16-hsv-color-transforms\n                            vmul = (v2 << 12) / v1 | 0; // Result will be in [0..255] range because:\n                            //  - all numbers are positive\n                            //  - r,g,b <= (v1/256)\n                            //  - r,g,b,(v1/256),(v2/256) <= 255\n                            // So highest this number can get is X*255/X+0.5=255.5 which is < 256 and rounds down.\n                            iTimes4 = i * 4;\n                            img[iTimes4] = img[iTimes4] * vmul + 0x800 >> 12; // R\n                            img[iTimes4 + 1] = img[iTimes4 + 1] * vmul + 0x800 >> 12; // G\n                            img[iTimes4 + 2] = img[iTimes4 + 2] * vmul + 0x800 >> 12; // B\n                        }\n                    }\n                };\n            },\n            {\n                \"glur/mono16\": 18\n            }\n        ],\n        11: [\n            function(_dereq_, module1, exports) {\n                \"use strict\";\n                module1.exports = function unsharp(img, width, height, amount, radius, threshold) {\n                    if (amount === 0 || radius < 0.5) return;\n                    if (radius > 2.0) radius = 2.0;\n                    var pixels = width * height;\n                    var img_bytes_cnt = pixels * 4;\n                    var hsv_bytes_cnt = pixels * 2;\n                    var blur_bytes_cnt = pixels * 2;\n                    var blur_line_byte_cnt = Math.max(width, height) * 4; // float32 array\n                    var blur_coeffs_byte_cnt = 32; // float32 array\n                    var img_offset = 0;\n                    var hsv_offset = img_bytes_cnt;\n                    var blur_offset = hsv_offset + hsv_bytes_cnt;\n                    var blur_tmp_offset = blur_offset + blur_bytes_cnt;\n                    var blur_line_offset = blur_tmp_offset + blur_bytes_cnt;\n                    var blur_coeffs_offset = blur_line_offset + blur_line_byte_cnt;\n                    var instance = this.__instance(\"unsharp_mask\", img_bytes_cnt + hsv_bytes_cnt + blur_bytes_cnt * 2 + blur_line_byte_cnt + blur_coeffs_byte_cnt, {\n                        exp: Math.exp\n                    }); // 32-bit copy is much faster in chrome\n                    var img32 = new Uint32Array(img.buffer);\n                    var mem32 = new Uint32Array(this.__memory.buffer);\n                    mem32.set(img32); // HSL\n                    var fn = instance.exports.hsv_v16 || instance.exports._hsv_v16;\n                    fn(img_offset, hsv_offset, width, height); // BLUR\n                    fn = instance.exports.blurMono16 || instance.exports._blurMono16;\n                    fn(hsv_offset, blur_offset, blur_tmp_offset, blur_line_offset, blur_coeffs_offset, width, height, radius); // UNSHARP\n                    fn = instance.exports.unsharp || instance.exports._unsharp;\n                    fn(img_offset, img_offset, hsv_offset, blur_offset, width, height, amount, threshold); // 32-bit copy is much faster in chrome\n                    img32.set(new Uint32Array(this.__memory.buffer, 0, pixels));\n                };\n            },\n            {}\n        ],\n        12: [\n            function(_dereq_, module1, exports) {\n                // This is autogenerated file from math.wasm, don't edit.\n                //\n                \"use strict\";\n                /* eslint-disable max-len */ module1.exports = \"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\";\n            },\n            {}\n        ],\n        13: [\n            function(_dereq_, module1, exports) {\n                \"use strict\";\n                var GC_INTERVAL = 100;\n                function Pool(create, idle) {\n                    this.create = create;\n                    this.available = [];\n                    this.acquired = {};\n                    this.lastId = 1;\n                    this.timeoutId = 0;\n                    this.idle = idle || 2000;\n                }\n                Pool.prototype.acquire = function() {\n                    var _this = this;\n                    var resource;\n                    if (this.available.length !== 0) resource = this.available.pop();\n                    else {\n                        resource = this.create();\n                        resource.id = this.lastId++;\n                        resource.release = function() {\n                            return _this.release(resource);\n                        };\n                    }\n                    this.acquired[resource.id] = resource;\n                    return resource;\n                };\n                Pool.prototype.release = function(resource) {\n                    var _this2 = this;\n                    delete this.acquired[resource.id];\n                    resource.lastUsed = Date.now();\n                    this.available.push(resource);\n                    if (this.timeoutId === 0) this.timeoutId = setTimeout(function() {\n                        return _this2.gc();\n                    }, GC_INTERVAL);\n                };\n                Pool.prototype.gc = function() {\n                    var _this3 = this;\n                    var now = Date.now();\n                    this.available = this.available.filter(function(resource) {\n                        if (now - resource.lastUsed > _this3.idle) {\n                            resource.destroy();\n                            return false;\n                        }\n                        return true;\n                    });\n                    if (this.available.length !== 0) this.timeoutId = setTimeout(function() {\n                        return _this3.gc();\n                    }, GC_INTERVAL);\n                    else this.timeoutId = 0;\n                };\n                module1.exports = Pool;\n            },\n            {}\n        ],\n        14: [\n            function(_dereq_, module1, exports) {\n                // Add intermediate resizing steps when scaling down by a very large factor.\n                //\n                // For example, when resizing 10000x10000 down to 10x10, it'll resize it to\n                // 300x300 first.\n                //\n                // It's needed because tiler has issues when the entire tile is scaled down\n                // to a few pixels (1024px source tile with border size 3 should result in\n                // at least 3+3+2 = 8px target tile, so max scale factor is 128 here).\n                //\n                // Also, adding intermediate steps can speed up processing if we use lower\n                // quality algorithms for first stages.\n                //\n                \"use strict\"; // min size = 0 results in infinite loop,\n                // min size = 1 can consume large amount of memory\n                var MIN_INNER_TILE_SIZE = 2;\n                module1.exports = function createStages(fromWidth, fromHeight, toWidth, toHeight, srcTileSize, destTileBorder) {\n                    var scaleX = toWidth / fromWidth;\n                    var scaleY = toHeight / fromHeight; // derived from createRegions equation:\n                    // innerTileWidth = pixelFloor(srcTileSize * scaleX) - 2 * destTileBorder;\n                    var minScale = (2 * destTileBorder + MIN_INNER_TILE_SIZE + 1) / srcTileSize; // refuse to scale image multiple times by less than twice each time,\n                    // it could only happen because of invalid options\n                    if (minScale > 0.5) return [\n                        [\n                            toWidth,\n                            toHeight\n                        ]\n                    ];\n                    var stageCount = Math.ceil(Math.log(Math.min(scaleX, scaleY)) / Math.log(minScale)); // no additional resizes are necessary,\n                    // stageCount can be zero or be negative when enlarging the image\n                    if (stageCount <= 1) return [\n                        [\n                            toWidth,\n                            toHeight\n                        ]\n                    ];\n                    var result = [];\n                    for(var i = 0; i < stageCount; i++){\n                        var width = Math.round(Math.pow(Math.pow(fromWidth, stageCount - i - 1) * Math.pow(toWidth, i + 1), 1 / stageCount));\n                        var height = Math.round(Math.pow(Math.pow(fromHeight, stageCount - i - 1) * Math.pow(toHeight, i + 1), 1 / stageCount));\n                        result.push([\n                            width,\n                            height\n                        ]);\n                    }\n                    return result;\n                };\n            },\n            {}\n        ],\n        15: [\n            function(_dereq_, module1, exports) {\n                // Split original image into multiple 1024x1024 chunks to reduce memory usage\n                // (images have to be unpacked into typed arrays for resizing) and allow\n                // parallel processing of multiple tiles at a time.\n                //\n                \"use strict\";\n                /*\n * pixelFloor and pixelCeil are modified versions of Math.floor and Math.ceil\n * functions which take into account floating point arithmetic errors.\n * Those errors can cause undesired increments/decrements of sizes and offsets:\n * Math.ceil(36 / (36 / 500)) = 501\n * pixelCeil(36 / (36 / 500)) = 500\n */ var PIXEL_EPSILON = 1e-5;\n                function pixelFloor(x) {\n                    var nearest = Math.round(x);\n                    if (Math.abs(x - nearest) < PIXEL_EPSILON) return nearest;\n                    return Math.floor(x);\n                }\n                function pixelCeil(x) {\n                    var nearest = Math.round(x);\n                    if (Math.abs(x - nearest) < PIXEL_EPSILON) return nearest;\n                    return Math.ceil(x);\n                }\n                module1.exports = function createRegions(options) {\n                    var scaleX = options.toWidth / options.width;\n                    var scaleY = options.toHeight / options.height;\n                    var innerTileWidth = pixelFloor(options.srcTileSize * scaleX) - 2 * options.destTileBorder;\n                    var innerTileHeight = pixelFloor(options.srcTileSize * scaleY) - 2 * options.destTileBorder; // prevent infinite loop, this should never happen\n                    if (innerTileWidth < 1 || innerTileHeight < 1) throw new Error(\"Internal error in pica: target tile width/height is too small.\");\n                    var x, y;\n                    var innerX, innerY, toTileWidth, toTileHeight;\n                    var tiles = [];\n                    var tile; // we go top-to-down instead of left-to-right to make image displayed from top to\n                    // doesn in the browser\n                    for(innerY = 0; innerY < options.toHeight; innerY += innerTileHeight)for(innerX = 0; innerX < options.toWidth; innerX += innerTileWidth){\n                        x = innerX - options.destTileBorder;\n                        if (x < 0) x = 0;\n                        toTileWidth = innerX + innerTileWidth + options.destTileBorder - x;\n                        if (x + toTileWidth >= options.toWidth) toTileWidth = options.toWidth - x;\n                        y = innerY - options.destTileBorder;\n                        if (y < 0) y = 0;\n                        toTileHeight = innerY + innerTileHeight + options.destTileBorder - y;\n                        if (y + toTileHeight >= options.toHeight) toTileHeight = options.toHeight - y;\n                        tile = {\n                            toX: x,\n                            toY: y,\n                            toWidth: toTileWidth,\n                            toHeight: toTileHeight,\n                            toInnerX: innerX,\n                            toInnerY: innerY,\n                            toInnerWidth: innerTileWidth,\n                            toInnerHeight: innerTileHeight,\n                            offsetX: x / scaleX - pixelFloor(x / scaleX),\n                            offsetY: y / scaleY - pixelFloor(y / scaleY),\n                            scaleX: scaleX,\n                            scaleY: scaleY,\n                            x: pixelFloor(x / scaleX),\n                            y: pixelFloor(y / scaleY),\n                            width: pixelCeil(toTileWidth / scaleX),\n                            height: pixelCeil(toTileHeight / scaleY)\n                        };\n                        tiles.push(tile);\n                    }\n                    return tiles;\n                };\n            },\n            {}\n        ],\n        16: [\n            function(_dereq_, module1, exports) {\n                \"use strict\";\n                function objClass(obj) {\n                    return Object.prototype.toString.call(obj);\n                }\n                module1.exports.isCanvas = function isCanvas(element) {\n                    var cname = objClass(element);\n                    return cname === \"[object HTMLCanvasElement]\" || cname === \"[object OffscreenCanvas]\" || cname === \"[object Canvas]\" /* node-canvas */ ;\n                };\n                module1.exports.isImage = function isImage(element) {\n                    return objClass(element) === \"[object HTMLImageElement]\";\n                };\n                module1.exports.isImageBitmap = function isImageBitmap(element) {\n                    return objClass(element) === \"[object ImageBitmap]\";\n                };\n                module1.exports.limiter = function limiter(concurrency) {\n                    var active = 0, queue = [];\n                    function roll() {\n                        if (active < concurrency && queue.length) {\n                            active++;\n                            queue.shift()();\n                        }\n                    }\n                    return function limit(fn) {\n                        return new Promise(function(resolve, reject) {\n                            queue.push(function() {\n                                fn().then(function(result) {\n                                    resolve(result);\n                                    active--;\n                                    roll();\n                                }, function(err) {\n                                    reject(err);\n                                    active--;\n                                    roll();\n                                });\n                            });\n                            roll();\n                        });\n                    };\n                };\n                module1.exports.cib_quality_name = function cib_quality_name(num) {\n                    switch(num){\n                        case 0:\n                            return \"pixelated\";\n                        case 1:\n                            return \"low\";\n                        case 2:\n                            return \"medium\";\n                    }\n                    return \"high\";\n                };\n                module1.exports.cib_support = function cib_support(createCanvas) {\n                    return Promise.resolve().then(function() {\n                        if (typeof createImageBitmap === \"undefined\") return false;\n                        var c = createCanvas(100, 100);\n                        return createImageBitmap(c, 0, 0, 100, 100, {\n                            resizeWidth: 10,\n                            resizeHeight: 10,\n                            resizeQuality: \"high\"\n                        }).then(function(bitmap) {\n                            var status = bitmap.width === 10; // Branch below is filtered on upper level. We do not call resize\n                            // detection for basic ImageBitmap.\n                            //\n                            // https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap\n                            // old Crome 51 has ImageBitmap without .close(). Then this code\n                            // will throw and return 'false' as expected.\n                            //\n                            bitmap.close();\n                            c = null;\n                            return status;\n                        });\n                    })[\"catch\"](function() {\n                        return false;\n                    });\n                };\n                module1.exports.worker_offscreen_canvas_support = function worker_offscreen_canvas_support() {\n                    return new Promise(function(resolve, reject) {\n                        if (typeof OffscreenCanvas === \"undefined\") {\n                            // if OffscreenCanvas is present, we assume browser supports Worker and built-in Promise as well\n                            resolve(false);\n                            return;\n                        }\n                        function workerPayload(self) {\n                            if (typeof createImageBitmap === \"undefined\") {\n                                self.postMessage(false);\n                                return;\n                            }\n                            Promise.resolve().then(function() {\n                                var canvas = new OffscreenCanvas(10, 10); // test that 2d context can be used in worker\n                                var ctx = canvas.getContext(\"2d\");\n                                ctx.rect(0, 0, 1, 1); // test that cib can be used to return image bitmap from worker\n                                return createImageBitmap(canvas, 0, 0, 1, 1);\n                            }).then(function() {\n                                return self.postMessage(true);\n                            }, function() {\n                                return self.postMessage(false);\n                            });\n                        }\n                        var code = btoa(\"(\".concat(workerPayload.toString(), \")(self);\"));\n                        var w = new Worker(\"data:text/javascript;base64,\".concat(code));\n                        w.onmessage = function(ev) {\n                            return resolve(ev.data);\n                        };\n                        w.onerror = reject;\n                    }).then(function(result) {\n                        return result;\n                    }, function() {\n                        return false;\n                    });\n                }; // Check if canvas.getContext('2d').getImageData can be used,\n                // FireFox randomizes the output of that function in `privacy.resistFingerprinting` mode\n                module1.exports.can_use_canvas = function can_use_canvas(createCanvas) {\n                    var usable = false;\n                    try {\n                        var canvas = createCanvas(2, 1);\n                        var ctx = canvas.getContext(\"2d\");\n                        var d = ctx.createImageData(2, 1);\n                        d.data[0] = 12;\n                        d.data[1] = 23;\n                        d.data[2] = 34;\n                        d.data[3] = 255;\n                        d.data[4] = 45;\n                        d.data[5] = 56;\n                        d.data[6] = 67;\n                        d.data[7] = 255;\n                        ctx.putImageData(d, 0, 0);\n                        d = null;\n                        d = ctx.getImageData(0, 0, 2, 1);\n                        if (d.data[0] === 12 && d.data[1] === 23 && d.data[2] === 34 && d.data[3] === 255 && d.data[4] === 45 && d.data[5] === 56 && d.data[6] === 67 && d.data[7] === 255) usable = true;\n                    } catch (err) {}\n                    return usable;\n                }; // Check if createImageBitmap(img, sx, sy, sw, sh) signature works correctly\n                // with JPEG images oriented with Exif;\n                // https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n                // TODO: remove after it's fixed in chrome for at least 2 releases\n                module1.exports.cib_can_use_region = function cib_can_use_region() {\n                    return new Promise(function(resolve) {\n                        // `Image` check required for use in `ServiceWorker`\n                        if (typeof Image === \"undefined\" || typeof createImageBitmap === \"undefined\") {\n                            resolve(false);\n                            return;\n                        }\n                        var image = new Image();\n                        image.src = \"data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z\";\n                        image.onload = function() {\n                            createImageBitmap(image, 0, 0, image.width, image.height).then(function(bitmap) {\n                                if (bitmap.width === image.width && bitmap.height === image.height) resolve(true);\n                                else resolve(false);\n                            }, function() {\n                                return resolve(false);\n                            });\n                        };\n                        image.onerror = function() {\n                            return resolve(false);\n                        };\n                    });\n                };\n            },\n            {}\n        ],\n        17: [\n            function(_dereq_, module1, exports) {\n                // Web Worker wrapper for image resize function\n                \"use strict\";\n                module1.exports = function() {\n                    var MathLib = _dereq_(\"./mathlib\");\n                    var mathLib;\n                    /* eslint-disable no-undef */ onmessage = function onmessage1(ev) {\n                        var tileOpts = ev.data.opts;\n                        var returnBitmap = false;\n                        if (!tileOpts.src && tileOpts.srcBitmap) {\n                            var canvas = new OffscreenCanvas(tileOpts.width, tileOpts.height);\n                            var ctx = canvas.getContext(\"2d\");\n                            ctx.drawImage(tileOpts.srcBitmap, 0, 0);\n                            tileOpts.src = ctx.getImageData(0, 0, tileOpts.width, tileOpts.height).data;\n                            canvas.width = canvas.height = 0;\n                            canvas = null;\n                            tileOpts.srcBitmap.close();\n                            tileOpts.srcBitmap = null; // Temporary force out data to typed array, because Chrome have artefacts\n                        // https://github.com/nodeca/pica/issues/223\n                        // returnBitmap = true;\n                        }\n                        if (!mathLib) mathLib = new MathLib(ev.data.features); // Use multimath's sync auto-init. Avoid Promise use in old browsers,\n                        // because polyfills are not propagated to webworker.\n                        var data = mathLib.resizeAndUnsharp(tileOpts);\n                        if (returnBitmap) {\n                            var toImageData = new ImageData(new Uint8ClampedArray(data), tileOpts.toWidth, tileOpts.toHeight);\n                            var _canvas = new OffscreenCanvas(tileOpts.toWidth, tileOpts.toHeight);\n                            var _ctx = _canvas.getContext(\"2d\");\n                            _ctx.putImageData(toImageData, 0, 0);\n                            createImageBitmap(_canvas).then(function(bitmap) {\n                                postMessage({\n                                    bitmap: bitmap\n                                }, [\n                                    bitmap\n                                ]);\n                            });\n                        } else postMessage({\n                            data: data\n                        }, [\n                            data.buffer\n                        ]);\n                    };\n                };\n            },\n            {\n                \"./mathlib\": 1\n            }\n        ],\n        18: [\n            function(_dereq_, module1, exports) {\n                // Calculate Gaussian blur of an image using IIR filter\n                // The method is taken from Intel's white paper and code example attached to it:\n                // https://software.intel.com/en-us/articles/iir-gaussian-blur-filter\n                // -implementation-using-intel-advanced-vector-extensions\n                var a0, a1, a2, a3, b1, b2, left_corner, right_corner;\n                function gaussCoef(sigma) {\n                    if (sigma < 0.5) sigma = 0.5;\n                    var a = Math.exp(0.527076) / sigma, g1 = Math.exp(-a), g2 = Math.exp(-2 * a), k = (1 - g1) * (1 - g1) / (1 + 2 * a * g1 - g2);\n                    a0 = k;\n                    a1 = k * (a - 1) * g1;\n                    a2 = k * (a + 1) * g1;\n                    a3 = -k * g2;\n                    b1 = 2 * g1;\n                    b2 = -g2;\n                    left_corner = (a0 + a1) / (1 - b1 - b2);\n                    right_corner = (a2 + a3) / (1 - b1 - b2);\n                    // Attempt to force type to FP32.\n                    return new Float32Array([\n                        a0,\n                        a1,\n                        a2,\n                        a3,\n                        b1,\n                        b2,\n                        left_corner,\n                        right_corner\n                    ]);\n                }\n                function convolveMono16(src, out, line, coeff, width, height) {\n                    // takes src image and writes the blurred and transposed result into out\n                    var prev_src, curr_src, curr_out, prev_out, prev_prev_out;\n                    var src_index, out_index, line_index;\n                    var i, j;\n                    var coeff_a0, coeff_a1, coeff_b1, coeff_b2;\n                    for(i = 0; i < height; i++){\n                        src_index = i * width;\n                        out_index = i;\n                        line_index = 0;\n                        // left to right\n                        prev_src = src[src_index];\n                        prev_prev_out = prev_src * coeff[6];\n                        prev_out = prev_prev_out;\n                        coeff_a0 = coeff[0];\n                        coeff_a1 = coeff[1];\n                        coeff_b1 = coeff[4];\n                        coeff_b2 = coeff[5];\n                        for(j = 0; j < width; j++){\n                            curr_src = src[src_index];\n                            curr_out = curr_src * coeff_a0 + prev_src * coeff_a1 + prev_out * coeff_b1 + prev_prev_out * coeff_b2;\n                            prev_prev_out = prev_out;\n                            prev_out = curr_out;\n                            prev_src = curr_src;\n                            line[line_index] = prev_out;\n                            line_index++;\n                            src_index++;\n                        }\n                        src_index--;\n                        line_index--;\n                        out_index += height * (width - 1);\n                        // right to left\n                        prev_src = src[src_index];\n                        prev_prev_out = prev_src * coeff[7];\n                        prev_out = prev_prev_out;\n                        curr_src = prev_src;\n                        coeff_a0 = coeff[2];\n                        coeff_a1 = coeff[3];\n                        for(j = width - 1; j >= 0; j--){\n                            curr_out = curr_src * coeff_a0 + prev_src * coeff_a1 + prev_out * coeff_b1 + prev_prev_out * coeff_b2;\n                            prev_prev_out = prev_out;\n                            prev_out = curr_out;\n                            prev_src = curr_src;\n                            curr_src = src[src_index];\n                            out[out_index] = line[line_index] + prev_out;\n                            src_index--;\n                            line_index--;\n                            out_index -= height;\n                        }\n                    }\n                }\n                function blurMono16(src, width, height, radius) {\n                    // Quick exit on zero radius\n                    if (!radius) return;\n                    var out = new Uint16Array(src.length), tmp_line = new Float32Array(Math.max(width, height));\n                    var coeff = gaussCoef(radius);\n                    convolveMono16(src, out, tmp_line, coeff, width, height, radius);\n                    convolveMono16(out, src, tmp_line, coeff, height, width, radius);\n                }\n                module1.exports = blurMono16;\n            },\n            {}\n        ],\n        19: [\n            function(_dereq_, module1, exports) {\n                \"use strict\";\n                var assign = _dereq_(\"object-assign\");\n                var base64decode = _dereq_(\"./lib/base64decode\");\n                var hasWebAssembly = _dereq_(\"./lib/wa_detect\");\n                var DEFAULT_OPTIONS = {\n                    js: true,\n                    wasm: true\n                };\n                function MultiMath(options) {\n                    if (!(this instanceof MultiMath)) return new MultiMath(options);\n                    var opts = assign({}, DEFAULT_OPTIONS, options || {});\n                    this.options = opts;\n                    this.__cache = {};\n                    this.__init_promise = null;\n                    this.__modules = opts.modules || {};\n                    this.__memory = null;\n                    this.__wasm = {};\n                    this.__isLE = new Uint32Array(new Uint8Array([\n                        1,\n                        0,\n                        0,\n                        0\n                    ]).buffer)[0] === 1;\n                    if (!this.options.js && !this.options.wasm) throw new Error('mathlib: at least \"js\" or \"wasm\" should be enabled');\n                }\n                MultiMath.prototype.has_wasm = hasWebAssembly;\n                MultiMath.prototype.use = function(module1) {\n                    this.__modules[module1.name] = module1;\n                    // Pin the best possible implementation\n                    if (this.options.wasm && this.has_wasm() && module1.wasm_fn) this[module1.name] = module1.wasm_fn;\n                    else this[module1.name] = module1.fn;\n                    return this;\n                };\n                MultiMath.prototype.init = function() {\n                    if (this.__init_promise) return this.__init_promise;\n                    if (!this.options.js && this.options.wasm && !this.has_wasm()) return Promise.reject(new Error('mathlib: only \"wasm\" was enabled, but it\\'s not supported'));\n                    var self = this;\n                    this.__init_promise = Promise.all(Object.keys(self.__modules).map(function(name) {\n                        var module1 = self.__modules[name];\n                        if (!self.options.wasm || !self.has_wasm() || !module1.wasm_fn) return null;\n                        // If already compiled - exit\n                        if (self.__wasm[name]) return null;\n                        // Compile wasm source\n                        return WebAssembly.compile(self.__base64decode(module1.wasm_src)).then(function(m) {\n                            self.__wasm[name] = m;\n                        });\n                    })).then(function() {\n                        return self;\n                    });\n                    return this.__init_promise;\n                };\n                ////////////////////////////////////////////////////////////////////////////////\n                // Methods below are for internal use from plugins\n                // Simple decode base64 to typed array. Useful to load embedded webassembly\n                // code. You probably don't need to call this method directly.\n                //\n                MultiMath.prototype.__base64decode = base64decode;\n                // Increase current memory to include specified number of bytes. Do nothing if\n                // size is already ok. You probably don't need to call this method directly,\n                // because it will be invoked from `.__instance()`.\n                //\n                MultiMath.prototype.__reallocate = function mem_grow_to(bytes) {\n                    if (!this.__memory) {\n                        this.__memory = new WebAssembly.Memory({\n                            initial: Math.ceil(bytes / 65536)\n                        });\n                        return this.__memory;\n                    }\n                    var mem_size = this.__memory.buffer.byteLength;\n                    if (mem_size < bytes) this.__memory.grow(Math.ceil((bytes - mem_size) / 65536));\n                    return this.__memory;\n                };\n                // Returns instantinated webassembly item by name, with specified memory size\n                // and environment.\n                // - use cache if available\n                // - do sync module init, if async init was not called earlier\n                // - allocate memory if not enougth\n                // - can export functions to webassembly via \"env_extra\",\n                //   for example, { exp: Math.exp }\n                //\n                MultiMath.prototype.__instance = function instance(name, memsize, env_extra) {\n                    if (memsize) this.__reallocate(memsize);\n                    // If .init() was not called, do sync compile\n                    if (!this.__wasm[name]) {\n                        var module1 = this.__modules[name];\n                        this.__wasm[name] = new WebAssembly.Module(this.__base64decode(module1.wasm_src));\n                    }\n                    if (!this.__cache[name]) {\n                        var env_base = {\n                            memoryBase: 0,\n                            memory: this.__memory,\n                            tableBase: 0,\n                            table: new WebAssembly.Table({\n                                initial: 0,\n                                element: \"anyfunc\"\n                            })\n                        };\n                        this.__cache[name] = new WebAssembly.Instance(this.__wasm[name], {\n                            env: assign(env_base, env_extra || {})\n                        });\n                    }\n                    return this.__cache[name];\n                };\n                // Helper to calculate memory aligh for pointers. Webassembly does not require\n                // this, but you may wish to experiment. Default base = 8;\n                //\n                MultiMath.prototype.__align = function align(number, base) {\n                    base = base || 8;\n                    var reminder = number % base;\n                    return number + (reminder ? base - reminder : 0);\n                };\n                module1.exports = MultiMath;\n            },\n            {\n                \"./lib/base64decode\": 20,\n                \"./lib/wa_detect\": 21,\n                \"object-assign\": 22\n            }\n        ],\n        20: [\n            function(_dereq_, module1, exports) {\n                // base64 decode str -> Uint8Array, to load WA modules\n                //\n                \"use strict\";\n                var BASE64_MAP = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n                module1.exports = function base64decode(str) {\n                    var input = str.replace(/[\\r\\n=]/g, \"\"), max = input.length;\n                    var out = new Uint8Array(max * 3 >> 2);\n                    // Collect by 6*4 bits (3 bytes)\n                    var bits = 0;\n                    var ptr = 0;\n                    for(var idx = 0; idx < max; idx++){\n                        if (idx % 4 === 0 && idx) {\n                            out[ptr++] = bits >> 16 & 0xFF;\n                            out[ptr++] = bits >> 8 & 0xFF;\n                            out[ptr++] = bits & 0xFF;\n                        }\n                        bits = bits << 6 | BASE64_MAP.indexOf(input.charAt(idx));\n                    }\n                    // Dump tail\n                    var tailbits = max % 4 * 6;\n                    if (tailbits === 0) {\n                        out[ptr++] = bits >> 16 & 0xFF;\n                        out[ptr++] = bits >> 8 & 0xFF;\n                        out[ptr++] = bits & 0xFF;\n                    } else if (tailbits === 18) {\n                        out[ptr++] = bits >> 10 & 0xFF;\n                        out[ptr++] = bits >> 2 & 0xFF;\n                    } else if (tailbits === 12) out[ptr++] = bits >> 4 & 0xFF;\n                    return out;\n                };\n            },\n            {}\n        ],\n        21: [\n            function(_dereq_, module1, exports) {\n                // Detect WebAssembly support.\n                // - Check global WebAssembly object\n                // - Try to load simple module (can be disabled via CSP)\n                //\n                \"use strict\";\n                var wa;\n                module1.exports = function hasWebAssembly() {\n                    // use cache if called before;\n                    if (typeof wa !== \"undefined\") return wa;\n                    wa = false;\n                    if (typeof WebAssembly === \"undefined\") return wa;\n                    // If WebAssenbly is disabled, code can throw on compile\n                    try {\n                        // https://github.com/brion/min-wasm-fail/blob/master/min-wasm-fail.in.js\n                        // Additional check that WA internals are correct\n                        /* eslint-disable comma-spacing, max-len */ var bin = new Uint8Array([\n                            0,\n                            97,\n                            115,\n                            109,\n                            1,\n                            0,\n                            0,\n                            0,\n                            1,\n                            6,\n                            1,\n                            96,\n                            1,\n                            127,\n                            1,\n                            127,\n                            3,\n                            2,\n                            1,\n                            0,\n                            5,\n                            3,\n                            1,\n                            0,\n                            1,\n                            7,\n                            8,\n                            1,\n                            4,\n                            116,\n                            101,\n                            115,\n                            116,\n                            0,\n                            0,\n                            10,\n                            16,\n                            1,\n                            14,\n                            0,\n                            32,\n                            0,\n                            65,\n                            1,\n                            54,\n                            2,\n                            0,\n                            32,\n                            0,\n                            40,\n                            2,\n                            0,\n                            11\n                        ]);\n                        var module1 = new WebAssembly.Module(bin);\n                        var instance = new WebAssembly.Instance(module1, {});\n                        // test storing to and loading from a non-zero location via a parameter.\n                        // Safari on iOS 11.2.5 returns 0 unexpectedly at non-zero locations\n                        if (instance.exports.test(4) !== 0) wa = true;\n                        return wa;\n                    } catch (__) {}\n                    return wa;\n                };\n            },\n            {}\n        ],\n        22: [\n            function(_dereq_, module1, exports) {\n                /*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/ \"use strict\";\n                /* eslint-disable no-unused-vars */ var getOwnPropertySymbols = Object.getOwnPropertySymbols;\n                var hasOwnProperty = Object.prototype.hasOwnProperty;\n                var propIsEnumerable = Object.prototype.propertyIsEnumerable;\n                function toObject(val) {\n                    if (val === null || val === undefined) throw new TypeError(\"Object.assign cannot be called with null or undefined\");\n                    return Object(val);\n                }\n                function shouldUseNative() {\n                    try {\n                        if (!Object.assign) return false;\n                        // Detect buggy property enumeration order in older V8 versions.\n                        // https://bugs.chromium.org/p/v8/issues/detail?id=4118\n                        var test1 = new String(\"abc\"); // eslint-disable-line no-new-wrappers\n                        test1[5] = \"de\";\n                        if (Object.getOwnPropertyNames(test1)[0] === \"5\") return false;\n                        // https://bugs.chromium.org/p/v8/issues/detail?id=3056\n                        var test2 = {};\n                        for(var i = 0; i < 10; i++)test2[\"_\" + String.fromCharCode(i)] = i;\n                        var order2 = Object.getOwnPropertyNames(test2).map(function(n) {\n                            return test2[n];\n                        });\n                        if (order2.join(\"\") !== \"0123456789\") return false;\n                        // https://bugs.chromium.org/p/v8/issues/detail?id=3056\n                        var test3 = {};\n                        \"abcdefghijklmnopqrst\".split(\"\").forEach(function(letter) {\n                            test3[letter] = letter;\n                        });\n                        if (Object.keys(Object.assign({}, test3)).join(\"\") !== \"abcdefghijklmnopqrst\") return false;\n                        return true;\n                    } catch (err) {\n                        // We don't expect any of the above to throw, but better to be safe.\n                        return false;\n                    }\n                }\n                module1.exports = shouldUseNative() ? Object.assign : function(target, source) {\n                    var from;\n                    var to = toObject(target);\n                    var symbols;\n                    for(var s = 1; s < arguments.length; s++){\n                        from = Object(arguments[s]);\n                        for(var key in from)if (hasOwnProperty.call(from, key)) to[key] = from[key];\n                        if (getOwnPropertySymbols) {\n                            symbols = getOwnPropertySymbols(from);\n                            for(var i = 0; i < symbols.length; i++)if (propIsEnumerable.call(from, symbols[i])) to[symbols[i]] = from[symbols[i]];\n                        }\n                    }\n                    return to;\n                };\n            },\n            {}\n        ],\n        23: [\n            function(_dereq_, module1, exports) {\n                var bundleFn = arguments[3];\n                var sources = arguments[4];\n                var cache = arguments[5];\n                var stringify = JSON.stringify;\n                module1.exports = function(fn, options) {\n                    var wkey;\n                    var cacheKeys = Object.keys(cache);\n                    for(var i = 0, l = cacheKeys.length; i < l; i++){\n                        var key = cacheKeys[i];\n                        var exp = cache[key].exports;\n                        // Using babel as a transpiler to use esmodule, the export will always\n                        // be an object with the default export as a property of it. To ensure\n                        // the existing api and babel esmodule exports are both supported we\n                        // check for both\n                        if (exp === fn || exp && exp.default === fn) {\n                            wkey = key;\n                            break;\n                        }\n                    }\n                    if (!wkey) {\n                        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n                        var wcache = {};\n                        for(var i = 0, l = cacheKeys.length; i < l; i++){\n                            var key = cacheKeys[i];\n                            wcache[key] = key;\n                        }\n                        sources[wkey] = [\n                            \"function(require,module,exports){\" + fn + \"(self); }\",\n                            wcache\n                        ];\n                    }\n                    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n                    var scache = {};\n                    scache[wkey] = wkey;\n                    sources[skey] = [\n                        \"function(require,module,exports){var f = require(\" + stringify(wkey) + \");\" + \"(f.default ? f.default : f)(self);\" + \"}\",\n                        scache\n                    ];\n                    var workerSources = {};\n                    resolveSources(skey);\n                    function resolveSources(key) {\n                        workerSources[key] = true;\n                        for(var depPath in sources[key][1]){\n                            var depKey = sources[key][1][depPath];\n                            if (!workerSources[depKey]) resolveSources(depKey);\n                        }\n                    }\n                    var src = \"(\" + bundleFn + \")({\" + Object.keys(workerSources).map(function(key) {\n                        return stringify(key) + \":[\" + sources[key][0] + \",\" + stringify(sources[key][1]) + \"]\";\n                    }).join(\",\") + \"},{},[\" + stringify(skey) + \"])\";\n                    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                    var blob = new Blob([\n                        src\n                    ], {\n                        type: \"text/javascript\"\n                    });\n                    if (options && options.bare) return blob;\n                    var workerUrl = URL.createObjectURL(blob);\n                    var worker = new Worker(workerUrl);\n                    worker.objectURL = workerUrl;\n                    return worker;\n                };\n            },\n            {}\n        ],\n        \"/index.js\": [\n            function(_dereq_, module1, exports) {\n                \"use strict\";\n                function _slicedToArray(arr, i) {\n                    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n                }\n                function _nonIterableRest() {\n                    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n                }\n                function _unsupportedIterableToArray(o, minLen) {\n                    if (!o) return;\n                    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n                    var n = Object.prototype.toString.call(o).slice(8, -1);\n                    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n                    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n                    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n                }\n                function _arrayLikeToArray(arr, len) {\n                    if (len == null || len > arr.length) len = arr.length;\n                    for(var i = 0, arr2 = new Array(len); i < len; i++)arr2[i] = arr[i];\n                    return arr2;\n                }\n                function _iterableToArrayLimit(arr, i) {\n                    var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n                    if (_i == null) return;\n                    var _arr = [];\n                    var _n = true;\n                    var _d = false;\n                    var _s, _e;\n                    try {\n                        for(_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true){\n                            _arr.push(_s.value);\n                            if (i && _arr.length === i) break;\n                        }\n                    } catch (err) {\n                        _d = true;\n                        _e = err;\n                    } finally{\n                        try {\n                            if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n                        } finally{\n                            if (_d) throw _e;\n                        }\n                    }\n                    return _arr;\n                }\n                function _arrayWithHoles(arr) {\n                    if (Array.isArray(arr)) return arr;\n                }\n                var assign = _dereq_(\"object-assign\");\n                var webworkify = _dereq_(\"webworkify\");\n                var MathLib = _dereq_(\"./lib/mathlib\");\n                var Pool = _dereq_(\"./lib/pool\");\n                var utils = _dereq_(\"./lib/utils\");\n                var worker = _dereq_(\"./lib/worker\");\n                var createStages = _dereq_(\"./lib/stepper\");\n                var createRegions = _dereq_(\"./lib/tiler\");\n                var filter_info = _dereq_(\"./lib/mm_resize/resize_filter_info\"); // Deduplicate pools & limiters with the same configs\n                // when user creates multiple pica instances.\n                var singletones = {};\n                var NEED_SAFARI_FIX = false;\n                try {\n                    if (typeof navigator !== \"undefined\" && navigator.userAgent) NEED_SAFARI_FIX = navigator.userAgent.indexOf(\"Safari\") >= 0;\n                } catch (e) {}\n                var concurrency = 1;\n                if (typeof navigator !== \"undefined\") concurrency = Math.min(navigator.hardwareConcurrency || 1, 4);\n                var DEFAULT_PICA_OPTS = {\n                    tile: 1024,\n                    concurrency: concurrency,\n                    features: [\n                        \"js\",\n                        \"wasm\",\n                        \"ww\"\n                    ],\n                    idle: 2000,\n                    createCanvas: function createCanvas(width, height) {\n                        var tmpCanvas = document.createElement(\"canvas\");\n                        tmpCanvas.width = width;\n                        tmpCanvas.height = height;\n                        return tmpCanvas;\n                    }\n                };\n                var DEFAULT_RESIZE_OPTS = {\n                    filter: \"mks2013\",\n                    unsharpAmount: 0,\n                    unsharpRadius: 0.0,\n                    unsharpThreshold: 0\n                };\n                var CAN_NEW_IMAGE_DATA = false;\n                var CAN_CREATE_IMAGE_BITMAP = false;\n                var CAN_USE_CANVAS_GET_IMAGE_DATA = false;\n                var CAN_USE_OFFSCREEN_CANVAS = false;\n                var CAN_USE_CIB_REGION_FOR_IMAGE = false;\n                function workerFabric() {\n                    return {\n                        value: webworkify(worker),\n                        destroy: function destroy() {\n                            this.value.terminate();\n                            if (typeof window !== \"undefined\") {\n                                var url = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                                if (url && url.revokeObjectURL && this.value.objectURL) url.revokeObjectURL(this.value.objectURL);\n                            }\n                        }\n                    };\n                } ////////////////////////////////////////////////////////////////////////////////\n                // API methods\n                function Pica(options) {\n                    if (!(this instanceof Pica)) return new Pica(options);\n                    this.options = assign({}, DEFAULT_PICA_OPTS, options || {});\n                    var limiter_key = \"lk_\".concat(this.options.concurrency); // Share limiters to avoid multiple parallel workers when user creates\n                    // multiple pica instances.\n                    this.__limit = singletones[limiter_key] || utils.limiter(this.options.concurrency);\n                    if (!singletones[limiter_key]) singletones[limiter_key] = this.__limit; // List of supported features, according to options & browser/node.js\n                    this.features = {\n                        js: false,\n                        // pure JS implementation, can be disabled for testing\n                        wasm: false,\n                        // webassembly implementation for heavy functions\n                        cib: false,\n                        // resize via createImageBitmap (only FF at this moment)\n                        ww: false // webworkers\n                    };\n                    this.__workersPool = null; // Store requested features for webworkers\n                    this.__requested_features = [];\n                    this.__mathlib = null;\n                }\n                Pica.prototype.init = function() {\n                    var _this = this;\n                    if (this.__initPromise) return this.__initPromise; // Test if we can create ImageData without canvas and memory copy\n                    if (typeof ImageData !== \"undefined\" && typeof Uint8ClampedArray !== \"undefined\") try {\n                        /* eslint-disable no-new */ new ImageData(new Uint8ClampedArray(400), 10, 10);\n                        CAN_NEW_IMAGE_DATA = true;\n                    } catch (__) {}\n                     // ImageBitmap can be effective in 2 places:\n                    //\n                    // 1. Threaded jpeg unpack (basic)\n                    // 2. Built-in resize (blocked due problem in chrome, see issue #89)\n                    //\n                    // For basic use we also need ImageBitmap wo support .close() method,\n                    // see https://developer.mozilla.org/ru/docs/Web/API/ImageBitmap\n                    if (typeof ImageBitmap !== \"undefined\") {\n                        if (ImageBitmap.prototype && ImageBitmap.prototype.close) CAN_CREATE_IMAGE_BITMAP = true;\n                        else this.debug(\"ImageBitmap does not support .close(), disabled\");\n                    }\n                    var features = this.options.features.slice();\n                    if (features.indexOf(\"all\") >= 0) features = [\n                        \"cib\",\n                        \"wasm\",\n                        \"js\",\n                        \"ww\"\n                    ];\n                    this.__requested_features = features;\n                    this.__mathlib = new MathLib(features); // Check WebWorker support if requested\n                    if (features.indexOf(\"ww\") >= 0) {\n                        if (typeof window !== \"undefined\" && \"Worker\" in window) // IE <= 11 don't allow to create webworkers from string. We should check it.\n                        // https://connect.microsoft.com/IE/feedback/details/801810/web-workers-from-blob-urls-in-ie-10-and-11\n                        try {\n                            var wkr = _dereq_(\"webworkify\")(function() {});\n                            wkr.terminate();\n                            this.features.ww = true; // pool uniqueness depends on pool config + webworker config\n                            var wpool_key = \"wp_\".concat(JSON.stringify(this.options));\n                            if (singletones[wpool_key]) this.__workersPool = singletones[wpool_key];\n                            else {\n                                this.__workersPool = new Pool(workerFabric, this.options.idle);\n                                singletones[wpool_key] = this.__workersPool;\n                            }\n                        } catch (__) {}\n                    }\n                    var initMath = this.__mathlib.init().then(function(mathlib) {\n                        // Copy detected features\n                        assign(_this.features, mathlib.features);\n                    });\n                    var checkCibResize;\n                    if (!CAN_CREATE_IMAGE_BITMAP) checkCibResize = Promise.resolve(false);\n                    else checkCibResize = utils.cib_support(this.options.createCanvas).then(function(status) {\n                        if (_this.features.cib && features.indexOf(\"cib\") < 0) {\n                            _this.debug(\"createImageBitmap() resize supported, but disabled by config\");\n                            return;\n                        }\n                        if (features.indexOf(\"cib\") >= 0) _this.features.cib = status;\n                    });\n                    CAN_USE_CANVAS_GET_IMAGE_DATA = utils.can_use_canvas(this.options.createCanvas);\n                    var checkOffscreenCanvas;\n                    if (CAN_CREATE_IMAGE_BITMAP && CAN_NEW_IMAGE_DATA && features.indexOf(\"ww\") !== -1) checkOffscreenCanvas = utils.worker_offscreen_canvas_support();\n                    else checkOffscreenCanvas = Promise.resolve(false);\n                    checkOffscreenCanvas = checkOffscreenCanvas.then(function(result) {\n                        CAN_USE_OFFSCREEN_CANVAS = result;\n                    }); // we use createImageBitmap to crop image data and pass it to workers,\n                    // so need to check whether function works correctly;\n                    // https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n                    var checkCibRegion = utils.cib_can_use_region().then(function(result) {\n                        CAN_USE_CIB_REGION_FOR_IMAGE = result;\n                    }); // Init math lib. That's async because can load some\n                    this.__initPromise = Promise.all([\n                        initMath,\n                        checkCibResize,\n                        checkOffscreenCanvas,\n                        checkCibRegion\n                    ]).then(function() {\n                        return _this;\n                    });\n                    return this.__initPromise;\n                }; // Call resizer in webworker or locally, depending on config\n                Pica.prototype.__invokeResize = function(tileOpts, opts) {\n                    var _this2 = this;\n                    // Share cache between calls:\n                    //\n                    // - wasm instance\n                    // - wasm memory object\n                    //\n                    opts.__mathCache = opts.__mathCache || {};\n                    return Promise.resolve().then(function() {\n                        if (!_this2.features.ww) // not possible to have ImageBitmap here if user disabled WW\n                        return {\n                            data: _this2.__mathlib.resizeAndUnsharp(tileOpts, opts.__mathCache)\n                        };\n                        return new Promise(function(resolve, reject) {\n                            var w = _this2.__workersPool.acquire();\n                            if (opts.cancelToken) opts.cancelToken[\"catch\"](function(err) {\n                                return reject(err);\n                            });\n                            w.value.onmessage = function(ev) {\n                                w.release();\n                                if (ev.data.err) reject(ev.data.err);\n                                else resolve(ev.data);\n                            };\n                            var transfer = [];\n                            if (tileOpts.src) transfer.push(tileOpts.src.buffer);\n                            if (tileOpts.srcBitmap) transfer.push(tileOpts.srcBitmap);\n                            w.value.postMessage({\n                                opts: tileOpts,\n                                features: _this2.__requested_features,\n                                preload: {\n                                    wasm_nodule: _this2.__mathlib.__\n                                }\n                            }, transfer);\n                        });\n                    });\n                }; // this function can return promise if createImageBitmap is used\n                Pica.prototype.__extractTileData = function(tile, from, opts, stageEnv, extractTo) {\n                    if (this.features.ww && CAN_USE_OFFSCREEN_CANVAS && // can use canvas because canvas doesn't have orientation;\n                    // see https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n                    (utils.isCanvas(from) || CAN_USE_CIB_REGION_FOR_IMAGE)) {\n                        this.debug(\"Create tile for OffscreenCanvas\");\n                        return createImageBitmap(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height).then(function(bitmap) {\n                            extractTo.srcBitmap = bitmap;\n                            return extractTo;\n                        });\n                    } // Extract tile RGBA buffer, depending on input type\n                    if (utils.isCanvas(from)) {\n                        if (!stageEnv.srcCtx) stageEnv.srcCtx = from.getContext(\"2d\"); // If input is Canvas - extract region data directly\n                        this.debug(\"Get tile pixel data\");\n                        extractTo.src = stageEnv.srcCtx.getImageData(tile.x, tile.y, tile.width, tile.height).data;\n                        return extractTo;\n                    } // If input is Image or decoded to ImageBitmap,\n                    // draw region to temporary canvas and extract data from it\n                    //\n                    // Note! Attempt to reuse this canvas causes significant slowdown in chrome\n                    //\n                    this.debug(\"Draw tile imageBitmap/image to temporary canvas\");\n                    var tmpCanvas = this.options.createCanvas(tile.width, tile.height);\n                    var tmpCtx = tmpCanvas.getContext(\"2d\");\n                    tmpCtx.globalCompositeOperation = \"copy\";\n                    tmpCtx.drawImage(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height, 0, 0, tile.width, tile.height);\n                    this.debug(\"Get tile pixel data\");\n                    extractTo.src = tmpCtx.getImageData(0, 0, tile.width, tile.height).data; // Safari 12 workaround\n                    // https://github.com/nodeca/pica/issues/199\n                    tmpCanvas.width = tmpCanvas.height = 0;\n                    return extractTo;\n                };\n                Pica.prototype.__landTileData = function(tile, result, stageEnv) {\n                    var toImageData;\n                    this.debug(\"Convert raw rgba tile result to ImageData\");\n                    if (result.bitmap) {\n                        stageEnv.toCtx.drawImage(result.bitmap, tile.toX, tile.toY);\n                        return null;\n                    }\n                    if (CAN_NEW_IMAGE_DATA) // this branch is for modern browsers\n                    // If `new ImageData()` & Uint8ClampedArray suported\n                    toImageData = new ImageData(new Uint8ClampedArray(result.data), tile.toWidth, tile.toHeight);\n                    else {\n                        // fallback for `node-canvas` and old browsers\n                        // (IE11 has ImageData but does not support `new ImageData()`)\n                        toImageData = stageEnv.toCtx.createImageData(tile.toWidth, tile.toHeight);\n                        if (toImageData.data.set) toImageData.data.set(result.data);\n                        else // IE9 don't have `.set()`\n                        for(var i = toImageData.data.length - 1; i >= 0; i--)toImageData.data[i] = result.data[i];\n                    }\n                    this.debug(\"Draw tile\");\n                    if (NEED_SAFARI_FIX) // Safari draws thin white stripes between tiles without this fix\n                    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth + 1e-5, tile.toInnerHeight + 1e-5);\n                    else stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth, tile.toInnerHeight);\n                    return null;\n                };\n                Pica.prototype.__tileAndResize = function(from, to, opts) {\n                    var _this3 = this;\n                    var stageEnv = {\n                        srcCtx: null,\n                        srcImageBitmap: null,\n                        isImageBitmapReused: false,\n                        toCtx: null\n                    };\n                    var processTile = function processTile(tile) {\n                        return _this3.__limit(function() {\n                            if (opts.canceled) return opts.cancelToken;\n                            var tileOpts = {\n                                width: tile.width,\n                                height: tile.height,\n                                toWidth: tile.toWidth,\n                                toHeight: tile.toHeight,\n                                scaleX: tile.scaleX,\n                                scaleY: tile.scaleY,\n                                offsetX: tile.offsetX,\n                                offsetY: tile.offsetY,\n                                filter: opts.filter,\n                                unsharpAmount: opts.unsharpAmount,\n                                unsharpRadius: opts.unsharpRadius,\n                                unsharpThreshold: opts.unsharpThreshold\n                            };\n                            _this3.debug(\"Invoke resize math\");\n                            return Promise.resolve(tileOpts).then(function(tileOpts) {\n                                return _this3.__extractTileData(tile, from, opts, stageEnv, tileOpts);\n                            }).then(function(tileOpts) {\n                                _this3.debug(\"Invoke resize math\");\n                                return _this3.__invokeResize(tileOpts, opts);\n                            }).then(function(result) {\n                                if (opts.canceled) return opts.cancelToken;\n                                stageEnv.srcImageData = null;\n                                return _this3.__landTileData(tile, result, stageEnv);\n                            });\n                        });\n                    }; // Need to normalize data source first. It can be canvas or image.\n                    // If image - try to decode in background if possible\n                    return Promise.resolve().then(function() {\n                        stageEnv.toCtx = to.getContext(\"2d\");\n                        if (utils.isCanvas(from)) return null;\n                        if (utils.isImageBitmap(from)) {\n                            stageEnv.srcImageBitmap = from;\n                            stageEnv.isImageBitmapReused = true;\n                            return null;\n                        }\n                        if (utils.isImage(from)) {\n                            // try do decode image in background for faster next operations;\n                            // if we're using offscreen canvas, cib is called per tile, so not needed here\n                            if (!CAN_CREATE_IMAGE_BITMAP) return null;\n                            _this3.debug(\"Decode image via createImageBitmap\");\n                            return createImageBitmap(from).then(function(imageBitmap) {\n                                stageEnv.srcImageBitmap = imageBitmap;\n                            }) // Suppress error to use fallback, if method fails\n                            [\"catch\"](function(e) {\n                                return null;\n                            });\n                        }\n                        throw new Error('Pica: \".from\" should be Image, Canvas or ImageBitmap');\n                    }).then(function() {\n                        if (opts.canceled) return opts.cancelToken;\n                        _this3.debug(\"Calculate tiles\"); //\n                        // Here we are with \"normalized\" source,\n                        // follow to tiling\n                        //\n                        var regions = createRegions({\n                            width: opts.width,\n                            height: opts.height,\n                            srcTileSize: _this3.options.tile,\n                            toWidth: opts.toWidth,\n                            toHeight: opts.toHeight,\n                            destTileBorder: opts.__destTileBorder\n                        });\n                        var jobs = regions.map(function(tile) {\n                            return processTile(tile);\n                        });\n                        function cleanup(stageEnv) {\n                            if (stageEnv.srcImageBitmap) {\n                                if (!stageEnv.isImageBitmapReused) stageEnv.srcImageBitmap.close();\n                                stageEnv.srcImageBitmap = null;\n                            }\n                        }\n                        _this3.debug(\"Process tiles\");\n                        return Promise.all(jobs).then(function() {\n                            _this3.debug(\"Finished!\");\n                            cleanup(stageEnv);\n                            return to;\n                        }, function(err) {\n                            cleanup(stageEnv);\n                            throw err;\n                        });\n                    });\n                };\n                Pica.prototype.__processStages = function(stages, from, to, opts) {\n                    var _this4 = this;\n                    if (opts.canceled) return opts.cancelToken;\n                    var _stages$shift = stages.shift(), _stages$shift2 = _slicedToArray(_stages$shift, 2), toWidth = _stages$shift2[0], toHeight = _stages$shift2[1];\n                    var isLastStage = stages.length === 0; // Optimization for legacy filters -\n                    // only use user-defined quality for the last stage,\n                    // use simpler (Hamming) filter for the first stages where\n                    // scale factor is large enough (more than 2-3)\n                    //\n                    // For advanced filters (mks2013 and custom) - skip optimization,\n                    // because need to apply sharpening every time\n                    var filter;\n                    if (isLastStage || filter_info.q2f.indexOf(opts.filter) < 0) filter = opts.filter;\n                    else if (opts.filter === \"box\") filter = \"box\";\n                    else filter = \"hamming\";\n                    opts = assign({}, opts, {\n                        toWidth: toWidth,\n                        toHeight: toHeight,\n                        filter: filter\n                    });\n                    var tmpCanvas;\n                    if (!isLastStage) // create temporary canvas\n                    tmpCanvas = this.options.createCanvas(toWidth, toHeight);\n                    return this.__tileAndResize(from, isLastStage ? to : tmpCanvas, opts).then(function() {\n                        if (isLastStage) return to;\n                        opts.width = toWidth;\n                        opts.height = toHeight;\n                        return _this4.__processStages(stages, tmpCanvas, to, opts);\n                    }).then(function(res) {\n                        if (tmpCanvas) // Safari 12 workaround\n                        // https://github.com/nodeca/pica/issues/199\n                        tmpCanvas.width = tmpCanvas.height = 0;\n                        return res;\n                    });\n                };\n                Pica.prototype.__resizeViaCreateImageBitmap = function(from, to, opts) {\n                    var _this5 = this;\n                    var toCtx = to.getContext(\"2d\");\n                    this.debug(\"Resize via createImageBitmap()\");\n                    return createImageBitmap(from, {\n                        resizeWidth: opts.toWidth,\n                        resizeHeight: opts.toHeight,\n                        resizeQuality: utils.cib_quality_name(filter_info.f2q[opts.filter])\n                    }).then(function(imageBitmap) {\n                        if (opts.canceled) return opts.cancelToken; // if no unsharp - draw directly to output canvas\n                        if (!opts.unsharpAmount) {\n                            toCtx.drawImage(imageBitmap, 0, 0);\n                            imageBitmap.close();\n                            toCtx = null;\n                            _this5.debug(\"Finished!\");\n                            return to;\n                        }\n                        _this5.debug(\"Unsharp result\");\n                        var tmpCanvas = _this5.options.createCanvas(opts.toWidth, opts.toHeight);\n                        var tmpCtx = tmpCanvas.getContext(\"2d\");\n                        tmpCtx.drawImage(imageBitmap, 0, 0);\n                        imageBitmap.close();\n                        var iData = tmpCtx.getImageData(0, 0, opts.toWidth, opts.toHeight);\n                        _this5.__mathlib.unsharp_mask(iData.data, opts.toWidth, opts.toHeight, opts.unsharpAmount, opts.unsharpRadius, opts.unsharpThreshold);\n                        toCtx.putImageData(iData, 0, 0); // Safari 12 workaround\n                        // https://github.com/nodeca/pica/issues/199\n                        tmpCanvas.width = tmpCanvas.height = 0;\n                        iData = tmpCtx = tmpCanvas = toCtx = null;\n                        _this5.debug(\"Finished!\");\n                        return to;\n                    });\n                };\n                Pica.prototype.resize = function(from, to, options) {\n                    var _this6 = this;\n                    this.debug(\"Start resize...\");\n                    var opts = assign({}, DEFAULT_RESIZE_OPTS);\n                    if (!isNaN(options)) opts = assign(opts, {\n                        quality: options\n                    });\n                    else if (options) opts = assign(opts, options);\n                    opts.toWidth = to.width;\n                    opts.toHeight = to.height;\n                    opts.width = from.naturalWidth || from.width;\n                    opts.height = from.naturalHeight || from.height; // Legacy `.quality` option\n                    if (Object.prototype.hasOwnProperty.call(opts, \"quality\")) {\n                        if (opts.quality < 0 || opts.quality > 3) throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n                        opts.filter = filter_info.q2f[opts.quality];\n                    } // Prevent stepper from infinite loop\n                    if (to.width === 0 || to.height === 0) return Promise.reject(new Error(\"Invalid output size: \".concat(to.width, \"x\").concat(to.height)));\n                    if (opts.unsharpRadius > 2) opts.unsharpRadius = 2;\n                    opts.canceled = false;\n                    if (opts.cancelToken) // Wrap cancelToken to avoid successive resolve & set flag\n                    opts.cancelToken = opts.cancelToken.then(function(data) {\n                        opts.canceled = true;\n                        throw data;\n                    }, function(err) {\n                        opts.canceled = true;\n                        throw err;\n                    });\n                    var DEST_TILE_BORDER = 3; // Max possible filter window size\n                    opts.__destTileBorder = Math.ceil(Math.max(DEST_TILE_BORDER, 2.5 * opts.unsharpRadius | 0));\n                    return this.init().then(function() {\n                        if (opts.canceled) return opts.cancelToken; // if createImageBitmap supports resize, just do it and return\n                        if (_this6.features.cib) {\n                            if (filter_info.q2f.indexOf(opts.filter) >= 0) return _this6.__resizeViaCreateImageBitmap(from, to, opts);\n                            _this6.debug(\"cib is enabled, but not supports provided filter, fallback to manual math\");\n                        }\n                        if (!CAN_USE_CANVAS_GET_IMAGE_DATA) {\n                            var err = new Error(\"Pica: cannot use getImageData on canvas, make sure fingerprinting protection isn't enabled\");\n                            err.code = \"ERR_GET_IMAGE_DATA\";\n                            throw err;\n                        } //\n                        // No easy way, let's resize manually via arrays\n                        //\n                        var stages = createStages(opts.width, opts.height, opts.toWidth, opts.toHeight, _this6.options.tile, opts.__destTileBorder);\n                        return _this6.__processStages(stages, from, to, opts);\n                    });\n                }; // RGBA buffer resize\n                //\n                Pica.prototype.resizeBuffer = function(options) {\n                    var _this7 = this;\n                    var opts = assign({}, DEFAULT_RESIZE_OPTS, options); // Legacy `.quality` option\n                    if (Object.prototype.hasOwnProperty.call(opts, \"quality\")) {\n                        if (opts.quality < 0 || opts.quality > 3) throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n                        opts.filter = filter_info.q2f[opts.quality];\n                    }\n                    return this.init().then(function() {\n                        return _this7.__mathlib.resizeAndUnsharp(opts);\n                    });\n                };\n                Pica.prototype.toBlob = function(canvas, mimeType, quality) {\n                    mimeType = mimeType || \"image/png\";\n                    return new Promise(function(resolve) {\n                        if (canvas.toBlob) {\n                            canvas.toBlob(function(blob) {\n                                return resolve(blob);\n                            }, mimeType, quality);\n                            return;\n                        }\n                        if (canvas.convertToBlob) {\n                            resolve(canvas.convertToBlob({\n                                type: mimeType,\n                                quality: quality\n                            }));\n                            return;\n                        } // Fallback for old browsers\n                        var asString = atob(canvas.toDataURL(mimeType, quality).split(\",\")[1]);\n                        var len = asString.length;\n                        var asBuffer = new Uint8Array(len);\n                        for(var i = 0; i < len; i++)asBuffer[i] = asString.charCodeAt(i);\n                        resolve(new Blob([\n                            asBuffer\n                        ], {\n                            type: mimeType\n                        }));\n                    });\n                };\n                Pica.prototype.debug = function() {};\n                module1.exports = Pica;\n            },\n            {\n                \"./lib/mathlib\": 1,\n                \"./lib/mm_resize/resize_filter_info\": 7,\n                \"./lib/pool\": 13,\n                \"./lib/stepper\": 14,\n                \"./lib/tiler\": 15,\n                \"./lib/utils\": 16,\n                \"./lib/worker\": 17,\n                \"object-assign\": 22,\n                \"webworkify\": 23\n            }\n        ]\n    }, {}, [])(\"/index.js\");\n});\n\n\nconst $e73bf42412feb220$var$dropArea = document.getElementById(\"drop-area\");\nconst $e73bf42412feb220$var$previewList = document.getElementById(\"preview-list\");\nconst $e73bf42412feb220$var$downloadAllButton = document.querySelector(\".download-all\");\nconst $e73bf42412feb220$var$resolutionSelect = document.querySelector(\".resolution-select\");\nconst $e73bf42412feb220$var$resolutionDropdown = document.getElementById(\"resolution-dropdown\");\nconst $e73bf42412feb220$var$applyResolutionButton = document.getElementById(\"apply-resolution\");\nconst $e73bf42412feb220$var$uploadButton = document.getElementById(\"upload-button\");\nconst $e73bf42412feb220$var$fileInput = document.getElementById(\"file-input\");\nconst $e73bf42412feb220$var$customResWidth = document.getElementById(\"width\");\nconst $e73bf42412feb220$var$customResHeight = document.getElementById(\"height\");\nconst $e73bf42412feb220$var$loader = document.querySelector(\".loader\");\nconst $e73bf42412feb220$var$fileCounter = document.querySelector(\".file-counter\");\nconst $e73bf42412feb220$var$fileCounterContent = document.querySelector(\".file-counter p\");\nconst $e73bf42412feb220$var$finishedHeading = document.querySelector(\".finished-heading\");\nlet $e73bf42412feb220$var$items = [];\nlet $e73bf42412feb220$var$itemIdCounter = 0;\nlet $e73bf42412feb220$var$cropSize = {\n    \"width\": null,\n    \"height\": null\n};\nlet $e73bf42412feb220$var$previewTimer = null;\nlet $e73bf42412feb220$var$currentGlobalSize = null;\n// Initialize Pica\nconst $e73bf42412feb220$var$pica = (0, (/*@__PURE__*/$parcel$interopDefault($41faaf01e3f65d27$exports)))();\n// Drag and drop events\n$e73bf42412feb220$var$dropArea.addEventListener(\"dragover\", (e)=>{\n    e.preventDefault();\n    $e73bf42412feb220$var$dropArea.classList.add(\"drag-over\");\n});\n$e73bf42412feb220$var$dropArea.addEventListener(\"dragleave\", ()=>$e73bf42412feb220$var$dropArea.classList.remove(\"drag-over\"));\n$e73bf42412feb220$var$dropArea.addEventListener(\"drop\", async (e)=>{\n    e.preventDefault();\n    $e73bf42412feb220$var$dropArea.classList.remove(\"drag-over\");\n    await $e73bf42412feb220$var$handleIncomingFiles(e.dataTransfer.files);\n    $e73bf42412feb220$var$resolutionSelect.classList.remove(\"hidden\");\n    $e73bf42412feb220$var$updateFileCounter();\n});\n$e73bf42412feb220$var$uploadButton.addEventListener(\"click\", ()=>$e73bf42412feb220$var$fileInput.click());\n$e73bf42412feb220$var$fileInput.addEventListener(\"change\", async (e)=>{\n    await $e73bf42412feb220$var$handleIncomingFiles(e.target.files);\n    $e73bf42412feb220$var$fileInput.value = \"\";\n});\n$e73bf42412feb220$var$resolutionDropdown.addEventListener(\"change\", $e73bf42412feb220$var$schedulePreviewUpdate);\n$e73bf42412feb220$var$customResWidth.addEventListener(\"input\", $e73bf42412feb220$var$schedulePreviewUpdate);\n$e73bf42412feb220$var$customResHeight.addEventListener(\"input\", $e73bf42412feb220$var$schedulePreviewUpdate);\nasync function $e73bf42412feb220$var$handleIncomingFiles(fileList) {\n    const preparedFiles = await Promise.all(Array.from(fileList).map((file)=>$e73bf42412feb220$var$prepareFileForProcessing(file)));\n    preparedFiles.filter(Boolean).forEach((file)=>{\n        $e73bf42412feb220$var$addItem(file);\n    });\n    $e73bf42412feb220$var$resolutionSelect.classList.remove(\"hidden\");\n    $e73bf42412feb220$var$updateFileCounter();\n    $e73bf42412feb220$var$schedulePreviewUpdate();\n}\nfunction $e73bf42412feb220$var$isHeicFile(file) {\n    if (!file) return false;\n    const type = (file.type || \"\").toLowerCase();\n    return type === \"image/heic\" || type === \"image/heif\" || /\\.hei(c|f)$/i.test(file.name || \"\");\n}\nasync function $e73bf42412feb220$var$prepareFileForProcessing(file) {\n    if (!$e73bf42412feb220$var$isHeicFile(file)) return file;\n    if (typeof window.heic2any !== \"function\") {\n        alert(\"HEIC conversion library failed to load. Please refresh and try again.\");\n        return null;\n    }\n    try {\n        const converted = await window.heic2any({\n            blob: file,\n            toType: \"image/jpeg\",\n            quality: 0.9\n        });\n        const convertedBlob = Array.isArray(converted) ? converted[0] : converted;\n        const baseName = (file.name || \"image\").replace(/\\.[^/.]+$/, \"\");\n        return new File([\n            convertedBlob\n        ], `${baseName}.jpg`, {\n            type: \"image/jpeg\",\n            lastModified: file.lastModified || Date.now()\n        });\n    } catch (err) {\n        console.error(`Failed to convert ${file.name} from HEIC:`, err);\n        alert(`Could not convert ${file.name}. Please export it as JPG/PNG and retry.`);\n        return null;\n    }\n}\nfunction $e73bf42412feb220$var$handleFiles(cropSize) {\n    if ($e73bf42412feb220$var$items.length === 0) {\n        alert(\"No images to crop\");\n        return;\n    }\n    $e73bf42412feb220$var$fileCounterContent.innerText = `Cropping...`;\n    $e73bf42412feb220$var$loader.classList.remove(\"hidden\");\n    $e73bf42412feb220$var$resolutionSelect.classList.add(\"hidden\");\n    $e73bf42412feb220$var$items.forEach((item)=>{\n        const sizeToUse = $e73bf42412feb220$var$getItemTargetSize(item, cropSize);\n        if (!sizeToUse) return;\n        if (item.status === \"ready\" && item.cropSize && item.cropSize.width === sizeToUse.width && item.cropSize.height === sizeToUse.height) return;\n        item.cropSize = {\n            width: sizeToUse.width,\n            height: sizeToUse.height\n        };\n        $e73bf42412feb220$var$processItem(item);\n    });\n}\nfunction $e73bf42412feb220$var$handleLoader() {\n    const processingCount = $e73bf42412feb220$var$items.filter((item)=>item.status === \"processing\").length;\n    if (processingCount === 0) $e73bf42412feb220$var$loader.classList.add(\"hidden\");\n}\nfunction $e73bf42412feb220$var$isImagePlural(files) {\n    if (files.length > 1) return \"images\";\n    else return \"image\";\n}\nfunction $e73bf42412feb220$var$handleEnableFileCounter(files) {\n    $e73bf42412feb220$var$fileCounterContent.innerText = `${files.length} ${$e73bf42412feb220$var$isImagePlural(files)} ready for cropping`;\n    $e73bf42412feb220$var$fileCounter.style.backgroundColor = \"#6cc5e9\";\n    $e73bf42412feb220$var$fileCounter.classList.remove(\"hidden\");\n}\nfunction $e73bf42412feb220$var$handleDisableFileCounter(files) {\n    $e73bf42412feb220$var$fileCounterContent.innerText = `${files.length} ${$e73bf42412feb220$var$isImagePlural(files)} cropped`;\n    $e73bf42412feb220$var$fileCounter.style.backgroundColor = \"#94d600\";\n}\nfunction $e73bf42412feb220$var$updateFileCounter() {\n    if ($e73bf42412feb220$var$items.length === 0) {\n        $e73bf42412feb220$var$fileCounter.classList.add(\"hidden\");\n        return;\n    }\n    const readyCount = $e73bf42412feb220$var$items.filter((item)=>item.status === \"ready\").length;\n    const queuedCount = $e73bf42412feb220$var$items.filter((item)=>item.status === \"queued\").length;\n    const pendingCount = $e73bf42412feb220$var$items.filter((item)=>item.status === \"pending\").length;\n    const processingCount = $e73bf42412feb220$var$items.filter((item)=>item.status === \"processing\").length;\n    if (processingCount > 0) {\n        $e73bf42412feb220$var$fileCounterContent.innerText = `Cropping ${processingCount} ${$e73bf42412feb220$var$isImagePlural($e73bf42412feb220$var$items)}`;\n        $e73bf42412feb220$var$fileCounter.style.backgroundColor = \"#6cc5e9\";\n    } else if (pendingCount > 0) {\n        $e73bf42412feb220$var$fileCounterContent.innerText = `${pendingCount} ${$e73bf42412feb220$var$isImagePlural($e73bf42412feb220$var$items)} ready to apply`;\n        $e73bf42412feb220$var$fileCounter.style.backgroundColor = \"#f9d04a\";\n    } else if (readyCount > 0) {\n        $e73bf42412feb220$var$fileCounterContent.innerText = `${readyCount} ${$e73bf42412feb220$var$isImagePlural($e73bf42412feb220$var$items)} ready`;\n        $e73bf42412feb220$var$fileCounter.style.backgroundColor = \"#94d600\";\n    } else {\n        $e73bf42412feb220$var$fileCounterContent.innerText = `${queuedCount} ${$e73bf42412feb220$var$isImagePlural($e73bf42412feb220$var$items)} ready for cropping`;\n        $e73bf42412feb220$var$fileCounter.style.backgroundColor = \"#6cc5e9\";\n    }\n    $e73bf42412feb220$var$fileCounter.classList.remove(\"hidden\");\n    $e73bf42412feb220$var$updateDownloadAllVisibility();\n    $e73bf42412feb220$var$updateApplyButtonLabel();\n}\nfunction $e73bf42412feb220$var$processItem(item) {\n    $e73bf42412feb220$var$setItemState(item, \"processing\");\n    $e73bf42412feb220$var$updateFileCounter();\n    new Compressor(item.file, {\n        quality: 0.8,\n        success: (compressedFile)=>{\n            const reader = new FileReader();\n            reader.onload = ()=>$e73bf42412feb220$var$createPreview(reader.result, compressedFile, item);\n            reader.readAsDataURL(compressedFile);\n        },\n        error (err) {\n            console.error(`Error compressing ${item.file.name}:`, err);\n        }\n    });\n}\nfunction $e73bf42412feb220$var$handleUserEntry() {\n    if ($e73bf42412feb220$var$resolutionDropdown.value && ($e73bf42412feb220$var$customResWidth.value || $e73bf42412feb220$var$customResHeight.value)) {\n        console.log(Boolean($e73bf42412feb220$var$resolutionDropdown.value));\n        alert(\"Please use only the dropdown or a custom size\");\n    } else if ($e73bf42412feb220$var$customResWidth.value && $e73bf42412feb220$var$customResHeight.value) {\n        $e73bf42412feb220$var$cropSize.width = $e73bf42412feb220$var$customResWidth.value;\n        $e73bf42412feb220$var$cropSize.height = $e73bf42412feb220$var$customResHeight.value;\n        $e73bf42412feb220$var$currentGlobalSize = {\n            width: parseInt($e73bf42412feb220$var$cropSize.width, 10),\n            height: parseInt($e73bf42412feb220$var$cropSize.height, 10)\n        };\n        $e73bf42412feb220$var$handleFiles($e73bf42412feb220$var$cropSize);\n    } else if ($e73bf42412feb220$var$resolutionDropdown.value) {\n        let selectedResolution = $e73bf42412feb220$var$resolutionDropdown.value.split(\"x\");\n        $e73bf42412feb220$var$cropSize.width = parseInt(selectedResolution[0]);\n        $e73bf42412feb220$var$cropSize.height = parseInt(selectedResolution[1]);\n        $e73bf42412feb220$var$currentGlobalSize = {\n            width: $e73bf42412feb220$var$cropSize.width,\n            height: $e73bf42412feb220$var$cropSize.height\n        };\n        $e73bf42412feb220$var$handleFiles($e73bf42412feb220$var$cropSize);\n    } else {\n        const hasCustomPending = $e73bf42412feb220$var$items.some((item)=>item.sizeMode === \"custom\" && item.cropSize);\n        if (hasCustomPending) {\n            $e73bf42412feb220$var$handleFiles(null);\n            return;\n        }\n        alert(\"Please select a size or enter a custom size.\");\n    }\n}\n// Use dropdown selection for resolution when no size in filename\n$e73bf42412feb220$var$applyResolutionButton.onclick = ()=>{\n    $e73bf42412feb220$var$handleUserEntry();\n};\n// Create preview with Smartcrop for cropping accuracy\nfunction $e73bf42412feb220$var$createPreview(imageSrc, file, item) {\n    const img = new Image();\n    img.src = imageSrc;\n    img.onload = ()=>{\n        const useExistingCrop = item.autoCrop && item.autoCropSize && item.autoCropSize.width === item.cropSize.width && item.autoCropSize.height === item.cropSize.height;\n        const cropPromise = useExistingCrop ? Promise.resolve({\n            topCrop: item.autoCrop\n        }) : smartcrop.crop(img, {\n            width: item.cropSize.width,\n            height: item.cropSize.height\n        });\n        cropPromise.then((result)=>{\n            const crop = result.topCrop;\n            item.autoCrop = crop;\n            item.autoCropSize = {\n                width: item.cropSize.width,\n                height: item.cropSize.height\n            };\n            item.originalWidth = img.width;\n            item.originalHeight = img.height;\n            $e73bf42412feb220$var$updateItemCropOverlays(item);\n            // Create an offscreen canvas to apply the crop\n            const canvas = document.createElement(\"canvas\");\n            canvas.width = crop.width;\n            canvas.height = crop.height;\n            const ctx = canvas.getContext(\"2d\");\n            // Draw the optimal crop area\n            ctx.drawImage(img, crop.x, crop.y, crop.width, crop.height, 0, 0, canvas.width, canvas.height // Draw on entire canvas\n            );\n            const downscaleCanvas = document.createElement(\"canvas\");\n            downscaleCanvas.width = item.cropSize.width;\n            downscaleCanvas.height = item.cropSize.height;\n            // Use Pica to resize the cropped image to the target dimensions (cropSize)\n            $e73bf42412feb220$var$pica.resize(canvas, downscaleCanvas, {\n                unsharpAmount: 80,\n                unsharpThreshold: 100,\n                quality: 3\n            }).then(()=>{\n                // Convert resized canvas to Blob (JPEG format)\n                downscaleCanvas.toBlob((blob)=>{\n                    const croppedImageURL = URL.createObjectURL(blob);\n                    item.blob = blob;\n                    $e73bf42412feb220$var$updateItemPreview(item, croppedImageURL);\n                    $e73bf42412feb220$var$handleLoader();\n                    $e73bf42412feb220$var$updateFileCounter();\n                }, \"image/jpeg\", 0.9); // Set JPEG quality to 90%\n            }).catch((err)=>{\n                console.error(\"Error resizing image:\", err);\n            });\n        });\n    };\n}\nfunction $e73bf42412feb220$var$addItem(file) {\n    const id = ++$e73bf42412feb220$var$itemIdCounter;\n    const previewUrl = URL.createObjectURL(file);\n    const item = {\n        id: id,\n        file: file,\n        previewUrl: previewUrl,\n        status: \"queued\",\n        cropSize: null,\n        blob: null,\n        croppedUrl: null,\n        autoCrop: null,\n        autoCropSize: null,\n        originalWidth: null,\n        originalHeight: null,\n        sizeMode: \"global\",\n        el: null,\n        statusEl: null,\n        imgEl: null,\n        originalImgEl: null,\n        overlayEl: null,\n        shadeEls: null,\n        cropBoxEl: null,\n        thumbWrapEl: null,\n        sizeSelectEl: null,\n        sizeResetEl: null,\n        downloadBtn: null\n    };\n    $e73bf42412feb220$var$items.push(item);\n    $e73bf42412feb220$var$createListItem(item);\n    $e73bf42412feb220$var$updateFileCounter();\n}\nfunction $e73bf42412feb220$var$createListItem(item) {\n    const listItem = document.createElement(\"li\");\n    listItem.classList.add(\"queue-item\");\n    listItem.dataset.id = item.id;\n    const thumbWrap = document.createElement(\"div\");\n    thumbWrap.classList.add(\"thumb-wrap\");\n    const croppedImage = document.createElement(\"img\");\n    const originalImage = document.createElement(\"img\");\n    const overlay = document.createElement(\"div\");\n    const shadeTop = document.createElement(\"div\");\n    const shadeRight = document.createElement(\"div\");\n    const shadeBottom = document.createElement(\"div\");\n    const shadeLeft = document.createElement(\"div\");\n    const cropBox = document.createElement(\"div\");\n    const imageInfoContainer = document.createElement(\"div\");\n    const sizeRow = document.createElement(\"div\");\n    const imageNameInfo = document.createElement(\"p\");\n    const imageStatus = document.createElement(\"span\");\n    const imageSizeDelta = document.createElement(\"p\");\n    const statusHelp = document.createElement(\"p\");\n    imageInfoContainer.classList.add(\"image-info\");\n    imageNameInfo.classList.add(\"image-name\");\n    imageStatus.classList.add(\"image-status\");\n    imageNameInfo.innerText = item.file.name;\n    imageStatus.innerText = \"Queued\";\n    imageSizeDelta.classList.add(\"image-size-delta\");\n    statusHelp.classList.add(\"status-help\");\n    imageSizeDelta.innerText = `File size: ${$e73bf42412feb220$var$formatFileSize(item.file.size)} \\u{2192} `;\n    croppedImage.classList.add(\"thumb-cropped\");\n    originalImage.classList.add(\"thumb-original\");\n    overlay.classList.add(\"thumb-overlay\");\n    cropBox.classList.add(\"thumb-crop-box\");\n    shadeTop.classList.add(\"thumb-shade\", \"shade-top\");\n    shadeRight.classList.add(\"thumb-shade\", \"shade-right\");\n    shadeBottom.classList.add(\"thumb-shade\", \"shade-bottom\");\n    shadeLeft.classList.add(\"thumb-shade\", \"shade-left\");\n    croppedImage.src = item.previewUrl;\n    originalImage.src = item.previewUrl;\n    overlay.appendChild(shadeTop);\n    overlay.appendChild(shadeRight);\n    overlay.appendChild(shadeBottom);\n    overlay.appendChild(shadeLeft);\n    overlay.appendChild(cropBox);\n    thumbWrap.appendChild(croppedImage);\n    thumbWrap.appendChild(originalImage);\n    thumbWrap.appendChild(overlay);\n    imageInfoContainer.appendChild(imageStatus);\n    imageInfoContainer.appendChild(imageNameInfo);\n    imageInfoContainer.appendChild(statusHelp);\n    sizeRow.classList.add(\"size-row\");\n    const sizeSelect = $e73bf42412feb220$var$buildItemSizeSelect(item);\n    const sizeReset = document.createElement(\"button\");\n    sizeReset.classList.add(\"item-size-reset\");\n    sizeReset.innerText = \"Reset\";\n    sizeReset.disabled = true;\n    sizeReset.onclick = ()=>$e73bf42412feb220$var$resetItemSize(item);\n    sizeRow.appendChild(sizeSelect);\n    sizeRow.appendChild(sizeReset);\n    imageInfoContainer.appendChild(sizeRow);\n    listItem.appendChild(thumbWrap);\n    listItem.appendChild(imageInfoContainer);\n    const downloadButton = document.createElement(\"button\");\n    downloadButton.classList.add(\"download-button\");\n    downloadButton.disabled = true;\n    const downloadIcon = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n    const downloadIconPath1 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n    const downloadIconPath2 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n    downloadIcon.setAttribute(\"viewBox\", \"0 0 29.978 29.978\");\n    downloadIcon.setAttribute(\"width\", \"20\");\n    downloadIcon.setAttribute(\"height\", \"20\");\n    downloadIconPath1.setAttribute(\"d\", \"M25.462,19.105v6.848H4.515v-6.848H0.489v8.861c0,1.111,0.9,2.012,2.016,2.012h24.967c1.115,0,2.016-0.9,2.016-2.012v-8.861H25.462z\");\n    downloadIconPath2.setAttribute(\"d\", \"M14.62,18.426l-5.764-6.965c0,0-0.877-0.828,0.074-0.828s3.248,0,3.248,0s0-0.557,0-1.416c0-2.449,0-6.906,0-8.723c0,0-0.129-0.494,0.615-0.494c0.75,0,4.035,0,4.572,0c0.536,0,0.524,0.416,0.524,0.416c0,1.762,0,6.373,0,8.742c0,0.768,0,1.266,0,1.266s1.842,0,2.998,0c1.154,0,0.285,0.867,0.285,0.867s-4.904,6.51-5.588,7.193C15.092,18.979,14.62,18.426,14.62,18.426z\");\n    downloadIcon.appendChild(downloadIconPath1);\n    downloadIcon.appendChild(downloadIconPath2);\n    downloadButton.appendChild(downloadIcon);\n    downloadButton.onclick = ()=>$e73bf42412feb220$var$downloadImage(item);\n    const removeButton = document.createElement(\"button\");\n    removeButton.classList.add(\"remove-button\");\n    const removeIcon = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n    const removeIconPath = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n    removeIcon.setAttribute(\"viewBox\", \"0 0 24 24\");\n    removeIcon.setAttribute(\"width\", \"22\");\n    removeIcon.setAttribute(\"height\", \"22\");\n    removeIconPath.setAttribute(\"d\", \"M6.4 5.3 12 10.9l5.6-5.6 1.1 1.1L13.1 12l5.6 5.6-1.1 1.1L12 13.1l-5.6 5.6-1.1-1.1L10.9 12 5.3 6.4z\");\n    removeIcon.appendChild(removeIconPath);\n    removeButton.appendChild(removeIcon);\n    removeButton.setAttribute(\"aria-label\", \"Remove image\");\n    removeButton.title = \"Remove image\";\n    listItem.appendChild(removeButton);\n    removeButton.onclick = ()=>$e73bf42412feb220$var$removeItem(item.id);\n    const actionsContainer = document.createElement(\"div\");\n    actionsContainer.classList.add(\"item-actions\");\n    actionsContainer.appendChild(imageSizeDelta);\n    actionsContainer.appendChild(downloadButton);\n    imageInfoContainer.appendChild(actionsContainer);\n    $e73bf42412feb220$var$finishedHeading.classList.remove(\"hidden\");\n    $e73bf42412feb220$var$previewList.appendChild(listItem);\n    item.el = listItem;\n    item.statusEl = imageStatus;\n    item.statusHelpEl = statusHelp;\n    item.imgEl = croppedImage;\n    item.originalImgEl = originalImage;\n    item.overlayEl = overlay;\n    item.shadeEls = {\n        shadeTop: shadeTop,\n        shadeRight: shadeRight,\n        shadeBottom: shadeBottom,\n        shadeLeft: shadeLeft\n    };\n    item.cropBoxEl = cropBox;\n    item.thumbWrapEl = thumbWrap;\n    item.sizeSelectEl = sizeSelect;\n    item.sizeResetEl = sizeReset;\n    item.downloadBtn = downloadButton;\n    item.sizeDeltaEl = imageSizeDelta;\n    $e73bf42412feb220$var$updateItemStatusChip(item);\n    $e73bf42412feb220$var$updateItemSizeSelectLabel(item);\n    $e73bf42412feb220$var$initCropDrag(item);\n}\nfunction $e73bf42412feb220$var$setItemState(item, state) {\n    item.status = state;\n    $e73bf42412feb220$var$updateItemStatusChip(item);\n    if (state === \"ready\") item.downloadBtn.disabled = false;\n    else item.downloadBtn.disabled = true;\n    $e73bf42412feb220$var$updateApplyButtonLabel();\n}\nfunction $e73bf42412feb220$var$updateItemPreview(item, croppedImageURL) {\n    if (item.croppedUrl) URL.revokeObjectURL(item.croppedUrl);\n    item.croppedUrl = croppedImageURL;\n    item.imgEl.src = croppedImageURL;\n    $e73bf42412feb220$var$setItemState(item, \"ready\");\n    $e73bf42412feb220$var$updateItemSizeDelta(item);\n    $e73bf42412feb220$var$updateDownloadAllVisibility();\n}\nfunction $e73bf42412feb220$var$updateItemSizeDelta(item) {\n    if (!item.sizeDeltaEl) return;\n    const originalSize = item.file.size;\n    if (!item.blob) {\n        item.sizeDeltaEl.innerText = `File size: ${$e73bf42412feb220$var$formatFileSize(originalSize)} \\u{2192} \\u{2014}`;\n        return;\n    }\n    const newSize = item.blob.size;\n    const delta = originalSize === 0 ? 0 : Math.round((1 - newSize / originalSize) * 100);\n    const sign = delta >= 0 ? \"reduced\" : \"increased\";\n    item.sizeDeltaEl.innerText = `File size: ${$e73bf42412feb220$var$formatFileSize(originalSize)} \\u{2192} ${$e73bf42412feb220$var$formatFileSize(newSize)} (${Math.abs(delta)}% ${sign})`;\n}\nfunction $e73bf42412feb220$var$updateItemCropOverlays(item) {\n    if (!item.autoCrop || !item.originalWidth || !item.originalHeight) return;\n    $e73bf42412feb220$var$updateItemCropOverlayForWrap(item, item.thumbWrapEl, item.cropBoxEl, item.shadeEls);\n}\nfunction $e73bf42412feb220$var$updateItemCropOverlayForWrap(item, wrapEl, cropBoxEl, shadeEls) {\n    if (!wrapEl || !cropBoxEl || !shadeEls) return;\n    const metrics = $e73bf42412feb220$var$getWrapMetrics(item, wrapEl);\n    if (!metrics) return;\n    const cropDisplay = $e73bf42412feb220$var$getDisplayCrop(item, metrics);\n    cropBoxEl.style.left = `${cropDisplay.x}px`;\n    cropBoxEl.style.top = `${cropDisplay.y}px`;\n    cropBoxEl.style.width = `${cropDisplay.width}px`;\n    cropBoxEl.style.height = `${cropDisplay.height}px`;\n    shadeEls.shadeTop.style.left = `0px`;\n    shadeEls.shadeTop.style.top = `0px`;\n    shadeEls.shadeTop.style.width = `${metrics.wrapWidth}px`;\n    shadeEls.shadeTop.style.height = `${cropDisplay.y}px`;\n    shadeEls.shadeBottom.style.left = `0px`;\n    shadeEls.shadeBottom.style.top = `${cropDisplay.y + cropDisplay.height}px`;\n    shadeEls.shadeBottom.style.width = `${metrics.wrapWidth}px`;\n    shadeEls.shadeBottom.style.height = `${metrics.wrapHeight - (cropDisplay.y + cropDisplay.height)}px`;\n    shadeEls.shadeLeft.style.left = `0px`;\n    shadeEls.shadeLeft.style.top = `${cropDisplay.y}px`;\n    shadeEls.shadeLeft.style.width = `${cropDisplay.x}px`;\n    shadeEls.shadeLeft.style.height = `${cropDisplay.height}px`;\n    shadeEls.shadeRight.style.left = `${cropDisplay.x + cropDisplay.width}px`;\n    shadeEls.shadeRight.style.top = `${cropDisplay.y}px`;\n    shadeEls.shadeRight.style.width = `${metrics.wrapWidth - (cropDisplay.x + cropDisplay.width)}px`;\n    shadeEls.shadeRight.style.height = `${cropDisplay.height}px`;\n}\nfunction $e73bf42412feb220$var$getPreviewCropSize() {\n    if ($e73bf42412feb220$var$resolutionDropdown.value && ($e73bf42412feb220$var$customResWidth.value || $e73bf42412feb220$var$customResHeight.value)) return null;\n    if ($e73bf42412feb220$var$customResWidth.value && $e73bf42412feb220$var$customResHeight.value) return {\n        width: parseInt($e73bf42412feb220$var$customResWidth.value, 10),\n        height: parseInt($e73bf42412feb220$var$customResHeight.value, 10)\n    };\n    if ($e73bf42412feb220$var$resolutionDropdown.value) {\n        const selectedResolution = $e73bf42412feb220$var$resolutionDropdown.value.split(\"x\");\n        return {\n            width: parseInt(selectedResolution[0], 10),\n            height: parseInt(selectedResolution[1], 10)\n        };\n    }\n    return null;\n}\nfunction $e73bf42412feb220$var$schedulePreviewUpdate() {\n    if ($e73bf42412feb220$var$previewTimer) clearTimeout($e73bf42412feb220$var$previewTimer);\n    $e73bf42412feb220$var$previewTimer = setTimeout(()=>{\n        const previewSize = $e73bf42412feb220$var$getPreviewCropSize();\n        if (!previewSize) return;\n        const sizeChanged = !$e73bf42412feb220$var$currentGlobalSize || $e73bf42412feb220$var$currentGlobalSize.width !== previewSize.width || $e73bf42412feb220$var$currentGlobalSize.height !== previewSize.height;\n        $e73bf42412feb220$var$currentGlobalSize = {\n            width: previewSize.width,\n            height: previewSize.height\n        };\n        $e73bf42412feb220$var$items.forEach((item)=>{\n            if (item.sizeMode === \"custom\") {\n                $e73bf42412feb220$var$updateItemSizeSelectLabel(item);\n                return;\n            }\n            if (sizeChanged && item.status === \"ready\") $e73bf42412feb220$var$clearItemReadyState(item);\n            if (item.status === \"queued\" || sizeChanged) {\n                item.cropSize = {\n                    width: previewSize.width,\n                    height: previewSize.height\n                };\n                $e73bf42412feb220$var$setItemState(item, \"pending\");\n            }\n            $e73bf42412feb220$var$updateItemSizeSelectLabel(item);\n            $e73bf42412feb220$var$generateAutoCropPreview(item, previewSize);\n        });\n        $e73bf42412feb220$var$updateFileCounter();\n    }, 250);\n}\nfunction $e73bf42412feb220$var$generateAutoCropPreview(item, previewSize) {\n    if (!item.previewUrl) return;\n    if (item.autoCropSize && item.autoCropSize.width === previewSize.width && item.autoCropSize.height === previewSize.height) {\n        $e73bf42412feb220$var$updateItemCropOverlays(item);\n        return;\n    }\n    const img = new Image();\n    img.src = item.previewUrl;\n    img.onload = ()=>{\n        smartcrop.crop(img, {\n            width: previewSize.width,\n            height: previewSize.height\n        }).then((result)=>{\n            item.autoCrop = result.topCrop;\n            item.autoCropSize = {\n                width: previewSize.width,\n                height: previewSize.height\n            };\n            item.originalWidth = img.width;\n            item.originalHeight = img.height;\n            $e73bf42412feb220$var$updateItemCropOverlays(item);\n        });\n    };\n}\nfunction $e73bf42412feb220$var$updateItemStatusChip(item) {\n    if (!item.statusEl || !item.el) return;\n    item.statusEl.classList.remove(\"status-queued\", \"status-pending\", \"status-processing\", \"status-ready\");\n    item.el.classList.remove(\"state-queued\", \"state-pending\", \"state-processing\", \"state-ready\");\n    let label = \"\";\n    let helpText = \"\";\n    if (item.status === \"queued\") {\n        label = \"Queued\";\n        helpText = \"Select a size to preview the crop.\";\n        item.statusEl.classList.add(\"status-queued\");\n        item.el.classList.add(\"state-queued\");\n    } else if (item.status === \"pending\") {\n        label = \"Pending\";\n        helpText = \"Preview ready. Click Apply to crop.\";\n        item.statusEl.classList.add(\"status-pending\");\n        item.el.classList.add(\"state-pending\");\n    } else if (item.status === \"processing\") {\n        label = \"Processing\";\n        helpText = \"Cropping and compressing...\";\n        item.statusEl.classList.add(\"status-processing\");\n        item.el.classList.add(\"state-processing\");\n    } else if (item.status === \"ready\") {\n        label = \"Ready\";\n        helpText = \"Ready to download.\";\n        item.statusEl.classList.add(\"status-ready\");\n        item.el.classList.add(\"state-ready\");\n    }\n    item.statusEl.innerText = label;\n    if (item.statusHelpEl) item.statusHelpEl.innerText = helpText;\n}\nfunction $e73bf42412feb220$var$updateApplyButtonLabel() {\n    const pendingCount = $e73bf42412feb220$var$items.filter((item)=>item.status === \"pending\").length;\n    if (pendingCount > 0) {\n        $e73bf42412feb220$var$resolutionSelect.classList.remove(\"hidden\");\n        $e73bf42412feb220$var$applyResolutionButton.disabled = false;\n        $e73bf42412feb220$var$applyResolutionButton.innerText = `Apply resolution (${pendingCount})`;\n    } else {\n        $e73bf42412feb220$var$applyResolutionButton.disabled = true;\n        $e73bf42412feb220$var$applyResolutionButton.innerText = \"Apply resolution\";\n    }\n}\nfunction $e73bf42412feb220$var$clearItemReadyState(item) {\n    if (item.croppedUrl) URL.revokeObjectURL(item.croppedUrl);\n    item.croppedUrl = null;\n    item.blob = null;\n    if (item.cropSize) $e73bf42412feb220$var$setItemState(item, \"pending\");\n    else $e73bf42412feb220$var$setItemState(item, \"queued\");\n    $e73bf42412feb220$var$updateItemSizeDelta(item);\n    $e73bf42412feb220$var$updateFileCounter();\n}\nfunction $e73bf42412feb220$var$buildItemSizeSelect(item) {\n    const select = document.createElement(\"select\");\n    select.classList.add(\"item-size-select\");\n    const followOption = document.createElement(\"option\");\n    followOption.value = \"\";\n    followOption.innerText = \"Follow global size\";\n    select.appendChild(followOption);\n    Array.from($e73bf42412feb220$var$resolutionDropdown.options).forEach((option)=>{\n        if (option.disabled) {\n            const opt = document.createElement(\"option\");\n            opt.disabled = true;\n            opt.innerText = option.text;\n            select.appendChild(opt);\n            return;\n        }\n        if (option.value === \"\") return;\n        const opt = document.createElement(\"option\");\n        opt.value = option.value;\n        opt.innerText = option.text;\n        select.appendChild(opt);\n    });\n    select.addEventListener(\"change\", ()=>{\n        if (!select.value) {\n            item.sizeMode = \"global\";\n            item.sizeResetEl.disabled = true;\n            if (item.blob) $e73bf42412feb220$var$clearItemReadyState(item);\n            if ($e73bf42412feb220$var$currentGlobalSize) {\n                item.cropSize = {\n                    width: $e73bf42412feb220$var$currentGlobalSize.width,\n                    height: $e73bf42412feb220$var$currentGlobalSize.height\n                };\n                $e73bf42412feb220$var$setItemState(item, \"pending\");\n                $e73bf42412feb220$var$generateAutoCropPreview(item, item.cropSize);\n            } else {\n                item.cropSize = null;\n                $e73bf42412feb220$var$setItemState(item, \"queued\");\n            }\n        } else {\n            const parts = select.value.split(\"x\");\n            item.sizeMode = \"custom\";\n            item.sizeResetEl.disabled = false;\n            if (item.blob) $e73bf42412feb220$var$clearItemReadyState(item);\n            item.cropSize = {\n                width: parseInt(parts[0], 10),\n                height: parseInt(parts[1], 10)\n            };\n            $e73bf42412feb220$var$setItemState(item, \"pending\");\n            $e73bf42412feb220$var$generateAutoCropPreview(item, item.cropSize);\n        }\n        $e73bf42412feb220$var$updateItemSizeSelectLabel(item);\n        $e73bf42412feb220$var$updateFileCounter();\n    });\n    return select;\n}\nfunction $e73bf42412feb220$var$resetItemSize(item) {\n    if (!item.sizeSelectEl) return;\n    item.sizeSelectEl.value = \"\";\n    item.sizeMode = \"global\";\n    item.sizeResetEl.disabled = true;\n    if (item.blob) $e73bf42412feb220$var$clearItemReadyState(item);\n    if ($e73bf42412feb220$var$currentGlobalSize) {\n        item.cropSize = {\n            width: $e73bf42412feb220$var$currentGlobalSize.width,\n            height: $e73bf42412feb220$var$currentGlobalSize.height\n        };\n        $e73bf42412feb220$var$setItemState(item, \"pending\");\n        $e73bf42412feb220$var$generateAutoCropPreview(item, item.cropSize);\n    } else {\n        item.cropSize = null;\n        $e73bf42412feb220$var$setItemState(item, \"queued\");\n    }\n    $e73bf42412feb220$var$updateItemSizeSelectLabel(item);\n    $e73bf42412feb220$var$updateFileCounter();\n}\nfunction $e73bf42412feb220$var$updateItemSizeSelectLabel(item) {\n    if (!item.sizeSelectEl) return;\n    const firstOption = item.sizeSelectEl.options[0];\n    if (!$e73bf42412feb220$var$currentGlobalSize) firstOption.innerText = \"Follow global size\";\n    else firstOption.innerText = `Follow global (${$e73bf42412feb220$var$currentGlobalSize.width}x${$e73bf42412feb220$var$currentGlobalSize.height})`;\n}\nfunction $e73bf42412feb220$var$getItemTargetSize(item, globalSize) {\n    if (item.sizeMode === \"custom\" && item.cropSize) return item.cropSize;\n    if (globalSize && globalSize.width && globalSize.height) return {\n        width: globalSize.width,\n        height: globalSize.height\n    };\n    return null;\n}\nfunction $e73bf42412feb220$var$getWrapMetrics(item, wrapEl) {\n    if (!wrapEl) return null;\n    const wrapWidth = wrapEl.clientWidth;\n    const wrapHeight = wrapEl.clientHeight;\n    if (!wrapWidth || !wrapHeight) return null;\n    const scale = Math.min(wrapWidth / item.originalWidth, wrapHeight / item.originalHeight);\n    const displayWidth = item.originalWidth * scale;\n    const displayHeight = item.originalHeight * scale;\n    const offsetX = (wrapWidth - displayWidth) / 2;\n    const offsetY = (wrapHeight - displayHeight) / 2;\n    return {\n        wrapWidth: wrapWidth,\n        wrapHeight: wrapHeight,\n        scale: scale,\n        displayWidth: displayWidth,\n        displayHeight: displayHeight,\n        offsetX: offsetX,\n        offsetY: offsetY\n    };\n}\nfunction $e73bf42412feb220$var$getDisplayCrop(item, metrics) {\n    return {\n        x: item.autoCrop.x * metrics.scale + metrics.offsetX,\n        y: item.autoCrop.y * metrics.scale + metrics.offsetY,\n        width: item.autoCrop.width * metrics.scale,\n        height: item.autoCrop.height * metrics.scale\n    };\n}\nfunction $e73bf42412feb220$var$initCropDrag(item) {\n    if (!item.cropBoxEl || !item.thumbWrapEl) return;\n    let dragState = null;\n    const onPointerMove = (e)=>{\n        if (!dragState) return;\n        const dx = e.clientX - dragState.startX;\n        const dy = e.clientY - dragState.startY;\n        const nextX = $e73bf42412feb220$var$clamp(dragState.startCropX + dx, dragState.bounds.minX, dragState.bounds.maxX);\n        const nextY = $e73bf42412feb220$var$clamp(dragState.startCropY + dy, dragState.bounds.minY, dragState.bounds.maxY);\n        item.autoCrop.x = (nextX - dragState.metrics.offsetX) / dragState.metrics.scale;\n        item.autoCrop.y = (nextY - dragState.metrics.offsetY) / dragState.metrics.scale;\n        $e73bf42412feb220$var$updateItemCropOverlays(item);\n    };\n    const onPointerUp = ()=>{\n        if (!dragState) return;\n        dragState = null;\n        item.el.classList.remove(\"is-dragging\");\n        window.removeEventListener(\"pointermove\", onPointerMove);\n        window.removeEventListener(\"pointerup\", onPointerUp);\n    };\n    item.cropBoxEl.addEventListener(\"pointerdown\", (e)=>{\n        if (!item.autoCrop || !item.thumbWrapEl) return;\n        if (item.blob) $e73bf42412feb220$var$clearItemReadyState(item);\n        const metrics = $e73bf42412feb220$var$getWrapMetrics(item, item.thumbWrapEl);\n        if (!metrics) return;\n        const cropDisplay = $e73bf42412feb220$var$getDisplayCrop(item, metrics);\n        dragState = {\n            startX: e.clientX,\n            startY: e.clientY,\n            startCropX: cropDisplay.x,\n            startCropY: cropDisplay.y,\n            metrics: metrics,\n            bounds: {\n                minX: metrics.offsetX,\n                minY: metrics.offsetY,\n                maxX: metrics.offsetX + metrics.displayWidth - cropDisplay.width,\n                maxY: metrics.offsetY + metrics.displayHeight - cropDisplay.height\n            }\n        };\n        item.el.classList.add(\"is-dragging\");\n        item.cropBoxEl.setPointerCapture(e.pointerId);\n        window.addEventListener(\"pointermove\", onPointerMove);\n        window.addEventListener(\"pointerup\", onPointerUp);\n    });\n}\nfunction $e73bf42412feb220$var$clamp(value, min, max) {\n    return Math.min(Math.max(value, min), max);\n}\nfunction $e73bf42412feb220$var$formatFileSize(bytes) {\n    if (bytes < 1024) return `${bytes} B`;\n    const kb = bytes / 1024;\n    if (kb < 1024) return `${kb.toFixed(1)} KB`;\n    const mb = kb / 1024;\n    return `${mb.toFixed(2)} MB`;\n}\nfunction $e73bf42412feb220$var$removeItem(id) {\n    const index = $e73bf42412feb220$var$items.findIndex((item)=>item.id === id);\n    if (index === -1) return;\n    const item = $e73bf42412feb220$var$items[index];\n    if (item.previewUrl) URL.revokeObjectURL(item.previewUrl);\n    if (item.croppedUrl) URL.revokeObjectURL(item.croppedUrl);\n    if (item.el) item.el.remove();\n    $e73bf42412feb220$var$items.splice(index, 1);\n    if ($e73bf42412feb220$var$items.length === 0) {\n        $e73bf42412feb220$var$downloadAllButton.classList.add(\"hidden\");\n        $e73bf42412feb220$var$finishedHeading.classList.add(\"hidden\");\n        $e73bf42412feb220$var$loader.classList.add(\"hidden\");\n    }\n    $e73bf42412feb220$var$updateFileCounter();\n}\nfunction $e73bf42412feb220$var$updateDownloadAllVisibility() {\n    const readyCount = $e73bf42412feb220$var$items.filter((item)=>item.status === \"ready\").length;\n    if (readyCount > 0) $e73bf42412feb220$var$downloadAllButton.classList.remove(\"hidden\");\n    else $e73bf42412feb220$var$downloadAllButton.classList.add(\"hidden\");\n}\nfunction $e73bf42412feb220$var$downloadImage(item) {\n    if (!item.blob) return;\n    const link = document.createElement(\"a\");\n    link.href = URL.createObjectURL(item.blob);\n    //link.download = `cropped_${fileName.replace(/\\.[^/.]+$/, \".jpg\")}`; // Replace extension with .jpg\n    link.download = `${item.file.name.replace(/\\.[^/.]+$/, \"\")}_${item.cropSize.width}x${item.cropSize.height}px.jpg`; // Replace extension with .jpg\n    link.click();\n}\n$e73bf42412feb220$var$downloadAllButton.onclick = ()=>$e73bf42412feb220$var$downloadAllCroppedImages();\nfunction $e73bf42412feb220$var$downloadAllCroppedImages() {\n    const zip = new JSZip();\n    //croppedImages.forEach(image => zip.file(`${cropSize.width}x${cropSize.height}_${image.name.replace(/\\.[^/.]+$/, \".jpg\")}`, image.blob));\n    $e73bf42412feb220$var$items.filter((item)=>item.status === \"ready\").forEach((item)=>zip.file(`${item.file.name.replace(/\\.[^/.]+$/, \"\")}_${item.cropSize.width}x${item.cropSize.height}.jpg`, item.blob));\n    zip.generateAsync({\n        type: \"blob\"\n    }).then((blob)=>{\n        const link = document.createElement(\"a\");\n        link.href = URL.createObjectURL(blob);\n        link.download = \"all_cropped_images.zip\";\n        link.click();\n    });\n}\n\n\n//# sourceMappingURL=index.6301a1e5.js.map\n","import Pica from 'pica';\n\nconst dropArea = document.getElementById(\"drop-area\");\nconst previewList = document.getElementById(\"preview-list\");\nconst downloadAllButton = document.querySelector(\".download-all\");\nconst resolutionSelect = document.querySelector(\".resolution-select\");\nconst resolutionDropdown = document.getElementById(\"resolution-dropdown\");\nconst applyResolutionButton = document.getElementById(\"apply-resolution\");\nconst uploadButton = document.getElementById(\"upload-button\");\nconst fileInput = document.getElementById(\"file-input\");\nconst customResWidth = document.getElementById(\"width\");\nconst customResHeight = document.getElementById(\"height\");\nconst loader = document.querySelector(\".loader\");\nconst fileCounter = document.querySelector(\".file-counter\");\nconst fileCounterContent = document.querySelector(\".file-counter p\");\nconst finishedHeading = document.querySelector(\".finished-heading\");\nlet items = [];\nlet itemIdCounter = 0;\nlet cropSize = {\n  \"width\": null,\n  \"height\": null\n};\nlet previewTimer = null;\nlet currentGlobalSize = null;\n\n// Initialize Pica\nconst pica = Pica();\n\n// Drag and drop events\ndropArea.addEventListener(\"dragover\", (e) => {\n  e.preventDefault();\n  dropArea.classList.add(\"drag-over\");\n});\n\ndropArea.addEventListener(\"dragleave\", () => dropArea.classList.remove(\"drag-over\"));\n\ndropArea.addEventListener(\"drop\", async (e) => {\n  e.preventDefault();\n  dropArea.classList.remove(\"drag-over\");\n  await handleIncomingFiles(e.dataTransfer.files);\n  resolutionSelect.classList.remove('hidden');\n  updateFileCounter();\n});\n\nuploadButton.addEventListener(\"click\", () => fileInput.click());\nfileInput.addEventListener(\"change\", async (e) => {\n  await handleIncomingFiles(e.target.files);\n  fileInput.value = \"\";\n});\nresolutionDropdown.addEventListener(\"change\", schedulePreviewUpdate);\ncustomResWidth.addEventListener(\"input\", schedulePreviewUpdate);\ncustomResHeight.addEventListener(\"input\", schedulePreviewUpdate);\n\nasync function handleIncomingFiles(fileList) {\n  const preparedFiles = await Promise.all(\n    Array.from(fileList).map(file => prepareFileForProcessing(file))\n  );\n  preparedFiles.filter(Boolean).forEach(file => {\n    addItem(file);\n  });\n  resolutionSelect.classList.remove('hidden');\n  updateFileCounter();\n  schedulePreviewUpdate();\n}\n\nfunction isHeicFile(file) {\n  if (!file) return false;\n  const type = (file.type || \"\").toLowerCase();\n  return type === \"image/heic\" ||\n    type === \"image/heif\" ||\n    /\\.hei(c|f)$/i.test(file.name || \"\");\n}\n\nasync function prepareFileForProcessing(file) {\n  if (!isHeicFile(file)) return file;\n  if (typeof window.heic2any !== \"function\") {\n    alert(\"HEIC conversion library failed to load. Please refresh and try again.\");\n    return null;\n  }\n  try {\n    const converted = await window.heic2any({\n      blob: file,\n      toType: \"image/jpeg\",\n      quality: 0.9\n    });\n    const convertedBlob = Array.isArray(converted) ? converted[0] : converted;\n    const baseName = (file.name || \"image\").replace(/\\.[^/.]+$/, \"\");\n    return new File([convertedBlob], `${baseName}.jpg`, {\n      type: \"image/jpeg\",\n      lastModified: file.lastModified || Date.now()\n    });\n  } catch (err) {\n    console.error(`Failed to convert ${file.name} from HEIC:`, err);\n    alert(`Could not convert ${file.name}. Please export it as JPG/PNG and retry.`);\n    return null;\n  }\n}\n\nfunction handleFiles(cropSize) {\n  if (items.length === 0) {\n    alert(\"No images to crop\");\n    return;\n  }\n  fileCounterContent.innerText = `Cropping...`;\n  loader.classList.remove('hidden');\n  resolutionSelect.classList.add('hidden');\n  items.forEach(item => {\n    const sizeToUse = getItemTargetSize(item, cropSize);\n    if (!sizeToUse) return;\n    if (item.status === \"ready\" && item.cropSize &&\n        item.cropSize.width === sizeToUse.width &&\n        item.cropSize.height === sizeToUse.height) {\n      return;\n    }\n    item.cropSize = { width: sizeToUse.width, height: sizeToUse.height };\n    processItem(item);\n  });\n}\n\nfunction handleLoader() {\n  const processingCount = items.filter(item => item.status === \"processing\").length;\n  if (processingCount === 0) {\n    loader.classList.add('hidden');\n  }\n}\n\nfunction isImagePlural(files) {\n  if (files.length > 1) {\n    return \"images\";\n  } else {\n    return \"image\";\n  }\n}\n\nfunction handleEnableFileCounter(files) {\n  fileCounterContent.innerText = `${files.length} ${isImagePlural(files)} ready for cropping`;\n  fileCounter.style.backgroundColor = \"#6cc5e9\"\n  fileCounter.classList.remove(\"hidden\");\n}\n\nfunction handleDisableFileCounter(files) {\n  fileCounterContent.innerText = `${files.length} ${isImagePlural(files)} cropped`;\n  fileCounter.style.backgroundColor = \"#94d600\"\n}\n\nfunction updateFileCounter() {\n  if (items.length === 0) {\n    fileCounter.classList.add(\"hidden\");\n    return;\n  }\n  const readyCount = items.filter(item => item.status === \"ready\").length;\n  const queuedCount = items.filter(item => item.status === \"queued\").length;\n  const pendingCount = items.filter(item => item.status === \"pending\").length;\n  const processingCount = items.filter(item => item.status === \"processing\").length;\n  if (processingCount > 0) {\n    fileCounterContent.innerText = `Cropping ${processingCount} ${isImagePlural(items)}`;\n    fileCounter.style.backgroundColor = \"#6cc5e9\";\n  } else if (pendingCount > 0) {\n    fileCounterContent.innerText = `${pendingCount} ${isImagePlural(items)} ready to apply`;\n    fileCounter.style.backgroundColor = \"#f9d04a\";\n  } else if (readyCount > 0) {\n    fileCounterContent.innerText = `${readyCount} ${isImagePlural(items)} ready`;\n    fileCounter.style.backgroundColor = \"#94d600\";\n  } else {\n    fileCounterContent.innerText = `${queuedCount} ${isImagePlural(items)} ready for cropping`;\n    fileCounter.style.backgroundColor = \"#6cc5e9\";\n  }\n  fileCounter.classList.remove(\"hidden\");\n  updateDownloadAllVisibility();\n  updateApplyButtonLabel();\n}\n\nfunction processItem(item) {\n  setItemState(item, \"processing\");\n  updateFileCounter();\n  new Compressor(item.file, {\n    quality: 0.8, // Set compression quality (0-1)\n    success: (compressedFile) => {\n      const reader = new FileReader();\n      reader.onload = () => createPreview(reader.result, compressedFile, item);\n      reader.readAsDataURL(compressedFile);\n    },\n    error(err) {\n      console.error(`Error compressing ${item.file.name}:`, err);\n    }\n  });\n}\n\nfunction handleUserEntry() {\n  if (resolutionDropdown.value && (customResWidth.value || customResHeight.value)) {\n    console.log(Boolean(resolutionDropdown.value));\n    \n    alert(\"Please use only the dropdown or a custom size\");\n  } else if (customResWidth.value && customResHeight.value) {\n    cropSize.width = customResWidth.value;\n    cropSize.height = customResHeight.value;\n    currentGlobalSize = { width: parseInt(cropSize.width, 10), height: parseInt(cropSize.height, 10) };\n    handleFiles(cropSize);\n  } else if (resolutionDropdown.value) {\n    let selectedResolution = resolutionDropdown.value.split(\"x\");\n    cropSize.width = parseInt(selectedResolution[0]);\n    cropSize.height = parseInt(selectedResolution[1]);\n    currentGlobalSize = { width: cropSize.width, height: cropSize.height };\n    handleFiles(cropSize);\n  } else {\n    const hasCustomPending = items.some(item => item.sizeMode === \"custom\" && item.cropSize);\n    if (hasCustomPending) {\n      handleFiles(null);\n      return;\n    }\n    alert(\"Please select a size or enter a custom size.\");\n  }\n}\n\n// Use dropdown selection for resolution when no size in filename\napplyResolutionButton.onclick = () => {\n  handleUserEntry();\n};\n\n// Create preview with Smartcrop for cropping accuracy\n\nfunction createPreview(imageSrc, file, item) {\n  const img = new Image();\n  img.src = imageSrc;\n  img.onload = () => {\n    const useExistingCrop = item.autoCrop &&\n      item.autoCropSize &&\n      item.autoCropSize.width === item.cropSize.width &&\n      item.autoCropSize.height === item.cropSize.height;\n    const cropPromise = useExistingCrop\n      ? Promise.resolve({ topCrop: item.autoCrop })\n      : smartcrop.crop(img, { width: item.cropSize.width, height: item.cropSize.height });\n\n    cropPromise.then(result => {\n      const crop = result.topCrop;\n      item.autoCrop = crop;\n      item.autoCropSize = { width: item.cropSize.width, height: item.cropSize.height };\n      item.originalWidth = img.width;\n      item.originalHeight = img.height;\n      updateItemCropOverlays(item);\n\n      // Create an offscreen canvas to apply the crop\n      const canvas = document.createElement(\"canvas\");\n      canvas.width = crop.width;\n      canvas.height = crop.height;\n      const ctx = canvas.getContext(\"2d\");\n\n      // Draw the optimal crop area\n      ctx.drawImage(\n        img,\n        crop.x, crop.y, crop.width, crop.height,  // Source crop area from Smartcrop\n        0, 0, canvas.width, canvas.height         // Draw on entire canvas\n      );\n      \n\n      const downscaleCanvas = document.createElement(\"canvas\");\n      downscaleCanvas.width = item.cropSize.width;\n      downscaleCanvas.height = item.cropSize.height;\n\n      // Use Pica to resize the cropped image to the target dimensions (cropSize)\n      pica.resize(canvas, downscaleCanvas, {\n        unsharpAmount: 80,     // Optional: Use unsharp mask for quality\n        unsharpThreshold: 100,   // Optional: Set threshold for unsharp mask\n        quality: 3,            // Use the best quality option\n      }).then(() => {\n        // Convert resized canvas to Blob (JPEG format)\n        downscaleCanvas.toBlob((blob) => {\n          const croppedImageURL = URL.createObjectURL(blob);\n          item.blob = blob;\n          updateItemPreview(item, croppedImageURL);\n          handleLoader();\n          updateFileCounter();\n        }, \"image/jpeg\", 0.9);  // Set JPEG quality to 90%\n      }).catch((err) => {\n        console.error(\"Error resizing image:\", err);\n      });\n    });\n  };\n}\n\nfunction addItem(file) {\n  const id = ++itemIdCounter;\n  const previewUrl = URL.createObjectURL(file);\n  const item = {\n    id,\n    file,\n    previewUrl,\n    status: \"queued\",\n    cropSize: null,\n    blob: null,\n    croppedUrl: null,\n    autoCrop: null,\n    autoCropSize: null,\n    originalWidth: null,\n    originalHeight: null,\n    sizeMode: \"global\",\n    el: null,\n    statusEl: null,\n    imgEl: null,\n    originalImgEl: null,\n    overlayEl: null,\n    shadeEls: null,\n    cropBoxEl: null,\n    thumbWrapEl: null,\n    sizeSelectEl: null,\n    sizeResetEl: null,\n    downloadBtn: null\n  };\n  items.push(item);\n  createListItem(item);\n  updateFileCounter();\n}\n\nfunction createListItem(item) {\n  const listItem = document.createElement(\"li\");\n  listItem.classList.add(\"queue-item\");\n  listItem.dataset.id = item.id;\n  const thumbWrap = document.createElement(\"div\");\n  thumbWrap.classList.add(\"thumb-wrap\");\n  const croppedImage = document.createElement(\"img\");\n  const originalImage = document.createElement(\"img\");\n  const overlay = document.createElement(\"div\");\n  const shadeTop = document.createElement(\"div\");\n  const shadeRight = document.createElement(\"div\");\n  const shadeBottom = document.createElement(\"div\");\n  const shadeLeft = document.createElement(\"div\");\n  const cropBox = document.createElement(\"div\");\n  const imageInfoContainer = document.createElement(\"div\");\n  const sizeRow = document.createElement(\"div\");\n  const imageNameInfo = document.createElement(\"p\");\n  const imageStatus = document.createElement(\"span\");\n  const imageSizeDelta = document.createElement(\"p\");\n  const statusHelp = document.createElement(\"p\");\n  imageInfoContainer.classList.add(\"image-info\");\n  imageNameInfo.classList.add(\"image-name\");\n  imageStatus.classList.add(\"image-status\");\n  imageNameInfo.innerText = item.file.name;\n  imageStatus.innerText = \"Queued\";\n  imageSizeDelta.classList.add(\"image-size-delta\");\n  statusHelp.classList.add(\"status-help\");\n  imageSizeDelta.innerText = `File size: ${formatFileSize(item.file.size)}  `;\n  croppedImage.classList.add(\"thumb-cropped\");\n  originalImage.classList.add(\"thumb-original\");\n  overlay.classList.add(\"thumb-overlay\");\n  cropBox.classList.add(\"thumb-crop-box\");\n  shadeTop.classList.add(\"thumb-shade\", \"shade-top\");\n  shadeRight.classList.add(\"thumb-shade\", \"shade-right\");\n  shadeBottom.classList.add(\"thumb-shade\", \"shade-bottom\");\n  shadeLeft.classList.add(\"thumb-shade\", \"shade-left\");\n  croppedImage.src = item.previewUrl;\n  originalImage.src = item.previewUrl;\n  overlay.appendChild(shadeTop);\n  overlay.appendChild(shadeRight);\n  overlay.appendChild(shadeBottom);\n  overlay.appendChild(shadeLeft);\n  overlay.appendChild(cropBox);\n  thumbWrap.appendChild(croppedImage);\n  thumbWrap.appendChild(originalImage);\n  thumbWrap.appendChild(overlay);\n  imageInfoContainer.appendChild(imageStatus);\n  imageInfoContainer.appendChild(imageNameInfo);\n  imageInfoContainer.appendChild(statusHelp);\n  sizeRow.classList.add(\"size-row\");\n  const sizeSelect = buildItemSizeSelect(item);\n  const sizeReset = document.createElement(\"button\");\n  sizeReset.classList.add(\"item-size-reset\");\n  sizeReset.innerText = \"Reset\";\n  sizeReset.disabled = true;\n  sizeReset.onclick = () => resetItemSize(item);\n  sizeRow.appendChild(sizeSelect);\n  sizeRow.appendChild(sizeReset);\n  imageInfoContainer.appendChild(sizeRow);\n  listItem.appendChild(thumbWrap);\n  listItem.appendChild(imageInfoContainer);\n\n  const downloadButton = document.createElement(\"button\");\n  downloadButton.classList.add(\"download-button\");\n  downloadButton.disabled = true;\n  const downloadIcon = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n  const downloadIconPath1 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n  const downloadIconPath2 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n\n  downloadIcon.setAttribute(\"viewBox\", \"0 0 29.978 29.978\");\n  downloadIcon.setAttribute(\"width\", \"20\");\n  downloadIcon.setAttribute(\"height\", \"20\");\n  downloadIconPath1.setAttribute(\"d\", \"M25.462,19.105v6.848H4.515v-6.848H0.489v8.861c0,1.111,0.9,2.012,2.016,2.012h24.967c1.115,0,2.016-0.9,2.016-2.012v-8.861H25.462z\");\n  downloadIconPath2.setAttribute(\"d\",\"M14.62,18.426l-5.764-6.965c0,0-0.877-0.828,0.074-0.828s3.248,0,3.248,0s0-0.557,0-1.416c0-2.449,0-6.906,0-8.723c0,0-0.129-0.494,0.615-0.494c0.75,0,4.035,0,4.572,0c0.536,0,0.524,0.416,0.524,0.416c0,1.762,0,6.373,0,8.742c0,0.768,0,1.266,0,1.266s1.842,0,2.998,0c1.154,0,0.285,0.867,0.285,0.867s-4.904,6.51-5.588,7.193C15.092,18.979,14.62,18.426,14.62,18.426z\");\n  downloadIcon.appendChild(downloadIconPath1);\n  downloadIcon.appendChild(downloadIconPath2);\n  downloadButton.appendChild(downloadIcon);\n  downloadButton.onclick = () => downloadImage(item);\n\n  const removeButton = document.createElement(\"button\");\n  removeButton.classList.add(\"remove-button\");\n  const removeIcon = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n  const removeIconPath = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n  removeIcon.setAttribute(\"viewBox\", \"0 0 24 24\");\n  removeIcon.setAttribute(\"width\", \"22\");\n  removeIcon.setAttribute(\"height\", \"22\");\n  removeIconPath.setAttribute(\"d\", \"M6.4 5.3 12 10.9l5.6-5.6 1.1 1.1L13.1 12l5.6 5.6-1.1 1.1L12 13.1l-5.6 5.6-1.1-1.1L10.9 12 5.3 6.4z\");\n  removeIcon.appendChild(removeIconPath);\n  removeButton.appendChild(removeIcon);\n  removeButton.setAttribute(\"aria-label\", \"Remove image\");\n  removeButton.title = \"Remove image\";\n  listItem.appendChild(removeButton);\n  removeButton.onclick = () => removeItem(item.id);\n\n  const actionsContainer = document.createElement(\"div\");\n  actionsContainer.classList.add(\"item-actions\");\n  actionsContainer.appendChild(imageSizeDelta);\n  actionsContainer.appendChild(downloadButton);\n  imageInfoContainer.appendChild(actionsContainer);\n  finishedHeading.classList.remove('hidden');\n\n  previewList.appendChild(listItem);\n  item.el = listItem;\n  item.statusEl = imageStatus;\n  item.statusHelpEl = statusHelp;\n  item.imgEl = croppedImage;\n  item.originalImgEl = originalImage;\n  item.overlayEl = overlay;\n  item.shadeEls = { shadeTop, shadeRight, shadeBottom, shadeLeft };\n  item.cropBoxEl = cropBox;\n  item.thumbWrapEl = thumbWrap;\n  item.sizeSelectEl = sizeSelect;\n  item.sizeResetEl = sizeReset;\n  item.downloadBtn = downloadButton;\n  item.sizeDeltaEl = imageSizeDelta;\n  updateItemStatusChip(item);\n  updateItemSizeSelectLabel(item);\n  initCropDrag(item);\n}\n\nfunction setItemState(item, state) {\n  item.status = state;\n  updateItemStatusChip(item);\n  if (state === \"ready\") {\n    item.downloadBtn.disabled = false;\n  } else {\n    item.downloadBtn.disabled = true;\n  }\n  updateApplyButtonLabel();\n}\n\nfunction updateItemPreview(item, croppedImageURL) {\n  if (item.croppedUrl) {\n    URL.revokeObjectURL(item.croppedUrl);\n  }\n  item.croppedUrl = croppedImageURL;\n  item.imgEl.src = croppedImageURL;\n  setItemState(item, \"ready\");\n  updateItemSizeDelta(item);\n  updateDownloadAllVisibility();\n}\n\nfunction updateItemSizeDelta(item) {\n  if (!item.sizeDeltaEl) return;\n  const originalSize = item.file.size;\n  if (!item.blob) {\n    item.sizeDeltaEl.innerText = `File size: ${formatFileSize(originalSize)}  `;\n    return;\n  }\n  const newSize = item.blob.size;\n  const delta = originalSize === 0 ? 0 : Math.round((1 - newSize / originalSize) * 100);\n  const sign = delta >= 0 ? \"reduced\" : \"increased\";\n  item.sizeDeltaEl.innerText = `File size: ${formatFileSize(originalSize)}  ${formatFileSize(newSize)} (${Math.abs(delta)}% ${sign})`;\n}\n\nfunction updateItemCropOverlays(item) {\n  if (!item.autoCrop || !item.originalWidth || !item.originalHeight) return;\n  updateItemCropOverlayForWrap(item, item.thumbWrapEl, item.cropBoxEl, item.shadeEls);\n}\n\nfunction updateItemCropOverlayForWrap(item, wrapEl, cropBoxEl, shadeEls) {\n  if (!wrapEl || !cropBoxEl || !shadeEls) return;\n  const metrics = getWrapMetrics(item, wrapEl);\n  if (!metrics) return;\n  const cropDisplay = getDisplayCrop(item, metrics);\n\n  cropBoxEl.style.left = `${cropDisplay.x}px`;\n  cropBoxEl.style.top = `${cropDisplay.y}px`;\n  cropBoxEl.style.width = `${cropDisplay.width}px`;\n  cropBoxEl.style.height = `${cropDisplay.height}px`;\n\n  shadeEls.shadeTop.style.left = `0px`;\n  shadeEls.shadeTop.style.top = `0px`;\n  shadeEls.shadeTop.style.width = `${metrics.wrapWidth}px`;\n  shadeEls.shadeTop.style.height = `${cropDisplay.y}px`;\n\n  shadeEls.shadeBottom.style.left = `0px`;\n  shadeEls.shadeBottom.style.top = `${cropDisplay.y + cropDisplay.height}px`;\n  shadeEls.shadeBottom.style.width = `${metrics.wrapWidth}px`;\n  shadeEls.shadeBottom.style.height = `${metrics.wrapHeight - (cropDisplay.y + cropDisplay.height)}px`;\n\n  shadeEls.shadeLeft.style.left = `0px`;\n  shadeEls.shadeLeft.style.top = `${cropDisplay.y}px`;\n  shadeEls.shadeLeft.style.width = `${cropDisplay.x}px`;\n  shadeEls.shadeLeft.style.height = `${cropDisplay.height}px`;\n\n  shadeEls.shadeRight.style.left = `${cropDisplay.x + cropDisplay.width}px`;\n  shadeEls.shadeRight.style.top = `${cropDisplay.y}px`;\n  shadeEls.shadeRight.style.width = `${metrics.wrapWidth - (cropDisplay.x + cropDisplay.width)}px`;\n  shadeEls.shadeRight.style.height = `${cropDisplay.height}px`;\n}\n\nfunction getPreviewCropSize() {\n  if (resolutionDropdown.value && (customResWidth.value || customResHeight.value)) {\n    return null;\n  }\n  if (customResWidth.value && customResHeight.value) {\n    return { width: parseInt(customResWidth.value, 10), height: parseInt(customResHeight.value, 10) };\n  }\n  if (resolutionDropdown.value) {\n    const selectedResolution = resolutionDropdown.value.split(\"x\");\n    return { width: parseInt(selectedResolution[0], 10), height: parseInt(selectedResolution[1], 10) };\n  }\n  return null;\n}\n\nfunction schedulePreviewUpdate() {\n  if (previewTimer) {\n    clearTimeout(previewTimer);\n  }\n  previewTimer = setTimeout(() => {\n    const previewSize = getPreviewCropSize();\n    if (!previewSize) return;\n    const sizeChanged = !currentGlobalSize ||\n      currentGlobalSize.width !== previewSize.width ||\n      currentGlobalSize.height !== previewSize.height;\n    currentGlobalSize = { width: previewSize.width, height: previewSize.height };\n    items.forEach(item => {\n      if (item.sizeMode === \"custom\") {\n        updateItemSizeSelectLabel(item);\n        return;\n      }\n      if (sizeChanged && item.status === \"ready\") {\n        clearItemReadyState(item);\n      }\n      if (item.status === \"queued\" || sizeChanged) {\n        item.cropSize = { width: previewSize.width, height: previewSize.height };\n        setItemState(item, \"pending\");\n      }\n      updateItemSizeSelectLabel(item);\n      generateAutoCropPreview(item, previewSize);\n    });\n    updateFileCounter();\n  }, 250);\n}\n\nfunction generateAutoCropPreview(item, previewSize) {\n  if (!item.previewUrl) return;\n  if (item.autoCropSize &&\n      item.autoCropSize.width === previewSize.width &&\n      item.autoCropSize.height === previewSize.height) {\n    updateItemCropOverlays(item);\n    return;\n  }\n  const img = new Image();\n  img.src = item.previewUrl;\n  img.onload = () => {\n    smartcrop.crop(img, { width: previewSize.width, height: previewSize.height }).then(result => {\n      item.autoCrop = result.topCrop;\n      item.autoCropSize = { width: previewSize.width, height: previewSize.height };\n      item.originalWidth = img.width;\n      item.originalHeight = img.height;\n      updateItemCropOverlays(item);\n    });\n  };\n}\n\nfunction updateItemStatusChip(item) {\n  if (!item.statusEl || !item.el) return;\n  item.statusEl.classList.remove(\"status-queued\", \"status-pending\", \"status-processing\", \"status-ready\");\n  item.el.classList.remove(\"state-queued\", \"state-pending\", \"state-processing\", \"state-ready\");\n  let label = \"\";\n  let helpText = \"\";\n  if (item.status === \"queued\") {\n    label = \"Queued\";\n    helpText = \"Select a size to preview the crop.\";\n    item.statusEl.classList.add(\"status-queued\");\n    item.el.classList.add(\"state-queued\");\n  } else if (item.status === \"pending\") {\n    label = \"Pending\";\n    helpText = \"Preview ready. Click Apply to crop.\";\n    item.statusEl.classList.add(\"status-pending\");\n    item.el.classList.add(\"state-pending\");\n  } else if (item.status === \"processing\") {\n    label = \"Processing\";\n    helpText = \"Cropping and compressing...\";\n    item.statusEl.classList.add(\"status-processing\");\n    item.el.classList.add(\"state-processing\");\n  } else if (item.status === \"ready\") {\n    label = \"Ready\";\n    helpText = \"Ready to download.\";\n    item.statusEl.classList.add(\"status-ready\");\n    item.el.classList.add(\"state-ready\");\n  }\n  item.statusEl.innerText = label;\n  if (item.statusHelpEl) {\n    item.statusHelpEl.innerText = helpText;\n  }\n}\n\nfunction updateApplyButtonLabel() {\n  const pendingCount = items.filter(item => item.status === \"pending\").length;\n  if (pendingCount > 0) {\n    resolutionSelect.classList.remove('hidden');\n    applyResolutionButton.disabled = false;\n    applyResolutionButton.innerText = `Apply resolution (${pendingCount})`;\n  } else {\n    applyResolutionButton.disabled = true;\n    applyResolutionButton.innerText = \"Apply resolution\";\n  }\n}\n\nfunction clearItemReadyState(item) {\n  if (item.croppedUrl) {\n    URL.revokeObjectURL(item.croppedUrl);\n  }\n  item.croppedUrl = null;\n  item.blob = null;\n  if (item.cropSize) {\n    setItemState(item, \"pending\");\n  } else {\n    setItemState(item, \"queued\");\n  }\n  updateItemSizeDelta(item);\n  updateFileCounter();\n}\n\nfunction buildItemSizeSelect(item) {\n  const select = document.createElement(\"select\");\n  select.classList.add(\"item-size-select\");\n  const followOption = document.createElement(\"option\");\n  followOption.value = \"\";\n  followOption.innerText = \"Follow global size\";\n  select.appendChild(followOption);\n  Array.from(resolutionDropdown.options).forEach(option => {\n    if (option.disabled) {\n      const opt = document.createElement(\"option\");\n      opt.disabled = true;\n      opt.innerText = option.text;\n      select.appendChild(opt);\n      return;\n    }\n    if (option.value === \"\") return;\n    const opt = document.createElement(\"option\");\n    opt.value = option.value;\n    opt.innerText = option.text;\n    select.appendChild(opt);\n  });\n  select.addEventListener(\"change\", () => {\n    if (!select.value) {\n      item.sizeMode = \"global\";\n      item.sizeResetEl.disabled = true;\n      if (item.blob) clearItemReadyState(item);\n      if (currentGlobalSize) {\n        item.cropSize = { width: currentGlobalSize.width, height: currentGlobalSize.height };\n        setItemState(item, \"pending\");\n        generateAutoCropPreview(item, item.cropSize);\n      } else {\n        item.cropSize = null;\n        setItemState(item, \"queued\");\n      }\n    } else {\n      const parts = select.value.split(\"x\");\n      item.sizeMode = \"custom\";\n      item.sizeResetEl.disabled = false;\n      if (item.blob) clearItemReadyState(item);\n      item.cropSize = { width: parseInt(parts[0], 10), height: parseInt(parts[1], 10) };\n      setItemState(item, \"pending\");\n      generateAutoCropPreview(item, item.cropSize);\n    }\n    updateItemSizeSelectLabel(item);\n    updateFileCounter();\n  });\n  return select;\n}\n\nfunction resetItemSize(item) {\n  if (!item.sizeSelectEl) return;\n  item.sizeSelectEl.value = \"\";\n  item.sizeMode = \"global\";\n  item.sizeResetEl.disabled = true;\n  if (item.blob) clearItemReadyState(item);\n  if (currentGlobalSize) {\n    item.cropSize = { width: currentGlobalSize.width, height: currentGlobalSize.height };\n    setItemState(item, \"pending\");\n    generateAutoCropPreview(item, item.cropSize);\n  } else {\n    item.cropSize = null;\n    setItemState(item, \"queued\");\n  }\n  updateItemSizeSelectLabel(item);\n  updateFileCounter();\n}\n\nfunction updateItemSizeSelectLabel(item) {\n  if (!item.sizeSelectEl) return;\n  const firstOption = item.sizeSelectEl.options[0];\n  if (!currentGlobalSize) {\n    firstOption.innerText = \"Follow global size\";\n  } else {\n    firstOption.innerText = `Follow global (${currentGlobalSize.width}x${currentGlobalSize.height})`;\n  }\n}\n\nfunction getItemTargetSize(item, globalSize) {\n  if (item.sizeMode === \"custom\" && item.cropSize) return item.cropSize;\n  if (globalSize && globalSize.width && globalSize.height) {\n    return { width: globalSize.width, height: globalSize.height };\n  }\n  return null;\n}\n\nfunction getWrapMetrics(item, wrapEl) {\n  if (!wrapEl) return null;\n  const wrapWidth = wrapEl.clientWidth;\n  const wrapHeight = wrapEl.clientHeight;\n  if (!wrapWidth || !wrapHeight) return null;\n  const scale = Math.min(wrapWidth / item.originalWidth, wrapHeight / item.originalHeight);\n  const displayWidth = item.originalWidth * scale;\n  const displayHeight = item.originalHeight * scale;\n  const offsetX = (wrapWidth - displayWidth) / 2;\n  const offsetY = (wrapHeight - displayHeight) / 2;\n  return { wrapWidth, wrapHeight, scale, displayWidth, displayHeight, offsetX, offsetY };\n}\n\nfunction getDisplayCrop(item, metrics) {\n  return {\n    x: item.autoCrop.x * metrics.scale + metrics.offsetX,\n    y: item.autoCrop.y * metrics.scale + metrics.offsetY,\n    width: item.autoCrop.width * metrics.scale,\n    height: item.autoCrop.height * metrics.scale\n  };\n}\n\nfunction initCropDrag(item) {\n  if (!item.cropBoxEl || !item.thumbWrapEl) return;\n  let dragState = null;\n  const onPointerMove = (e) => {\n    if (!dragState) return;\n    const dx = e.clientX - dragState.startX;\n    const dy = e.clientY - dragState.startY;\n    const nextX = clamp(dragState.startCropX + dx, dragState.bounds.minX, dragState.bounds.maxX);\n    const nextY = clamp(dragState.startCropY + dy, dragState.bounds.minY, dragState.bounds.maxY);\n    item.autoCrop.x = (nextX - dragState.metrics.offsetX) / dragState.metrics.scale;\n    item.autoCrop.y = (nextY - dragState.metrics.offsetY) / dragState.metrics.scale;\n    updateItemCropOverlays(item);\n  };\n  const onPointerUp = () => {\n    if (!dragState) return;\n    dragState = null;\n    item.el.classList.remove(\"is-dragging\");\n    window.removeEventListener(\"pointermove\", onPointerMove);\n    window.removeEventListener(\"pointerup\", onPointerUp);\n  };\n  item.cropBoxEl.addEventListener(\"pointerdown\", (e) => {\n    if (!item.autoCrop || !item.thumbWrapEl) return;\n    if (item.blob) clearItemReadyState(item);\n    const metrics = getWrapMetrics(item, item.thumbWrapEl);\n    if (!metrics) return;\n    const cropDisplay = getDisplayCrop(item, metrics);\n    dragState = {\n      startX: e.clientX,\n      startY: e.clientY,\n      startCropX: cropDisplay.x,\n      startCropY: cropDisplay.y,\n      metrics,\n      bounds: {\n        minX: metrics.offsetX,\n        minY: metrics.offsetY,\n        maxX: metrics.offsetX + metrics.displayWidth - cropDisplay.width,\n        maxY: metrics.offsetY + metrics.displayHeight - cropDisplay.height\n      }\n    };\n    item.el.classList.add(\"is-dragging\");\n    item.cropBoxEl.setPointerCapture(e.pointerId);\n    window.addEventListener(\"pointermove\", onPointerMove);\n    window.addEventListener(\"pointerup\", onPointerUp);\n  });\n}\n\nfunction clamp(value, min, max) {\n  return Math.min(Math.max(value, min), max);\n}\n\n\nfunction formatFileSize(bytes) {\n  if (bytes < 1024) return `${bytes} B`;\n  const kb = bytes / 1024;\n  if (kb < 1024) return `${kb.toFixed(1)} KB`;\n  const mb = kb / 1024;\n  return `${mb.toFixed(2)} MB`;\n}\n\nfunction removeItem(id) {\n  const index = items.findIndex(item => item.id === id);\n  if (index === -1) return;\n  const item = items[index];\n  if (item.previewUrl) URL.revokeObjectURL(item.previewUrl);\n  if (item.croppedUrl) URL.revokeObjectURL(item.croppedUrl);\n  if (item.el) item.el.remove();\n  items.splice(index, 1);\n  if (items.length === 0) {\n    downloadAllButton.classList.add('hidden');\n    finishedHeading.classList.add('hidden');\n    loader.classList.add('hidden');\n  }\n  updateFileCounter();\n}\n\nfunction updateDownloadAllVisibility() {\n  const readyCount = items.filter(item => item.status === \"ready\").length;\n  if (readyCount > 0) {\n    downloadAllButton.classList.remove('hidden');\n  } else {\n    downloadAllButton.classList.add('hidden');\n  }\n}\n\nfunction downloadImage(item) {\n  if (!item.blob) return;\n  const link = document.createElement(\"a\");\n  link.href = URL.createObjectURL(item.blob);\n  //link.download = `cropped_${fileName.replace(/\\.[^/.]+$/, \".jpg\")}`; // Replace extension with .jpg\n  link.download = `${item.file.name.replace(/\\.[^/.]+$/, \"\")}_${item.cropSize.width}x${item.cropSize.height}px.jpg`; // Replace extension with .jpg\n  link.click();\n}\n\ndownloadAllButton.onclick = () => downloadAllCroppedImages();\n\nfunction downloadAllCroppedImages() {\n  const zip = new JSZip();\n  //croppedImages.forEach(image => zip.file(`${cropSize.width}x${cropSize.height}_${image.name.replace(/\\.[^/.]+$/, \".jpg\")}`, image.blob));\n  items\n    .filter(item => item.status === \"ready\")\n    .forEach(item => zip.file(`${item.file.name.replace(/\\.[^/.]+$/, \"\")}_${item.cropSize.width}x${item.cropSize.height}.jpg`, item.blob));\n  zip.generateAsync({ type: \"blob\" }).then(blob => {\n    const link = document.createElement(\"a\");\n    link.href = URL.createObjectURL(blob);\n    link.download = \"all_cropped_images.zip\";\n    link.click();\n  });\n}\n","/*!\n\npica\nhttps://github.com/nodeca/pica\n\n*/\n\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.pica = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(_dereq_,module,exports){\n// Collection of math functions\n//\n// 1. Combine components together\n// 2. Has async init to load wasm modules\n//\n'use strict';\n\nvar Multimath = _dereq_('multimath');\n\nvar mm_unsharp_mask = _dereq_('./mm_unsharp_mask');\n\nvar mm_resize = _dereq_('./mm_resize');\n\nfunction MathLib(requested_features) {\n  var __requested_features = requested_features || [];\n\n  var features = {\n    js: __requested_features.indexOf('js') >= 0,\n    wasm: __requested_features.indexOf('wasm') >= 0\n  };\n  Multimath.call(this, features);\n  this.features = {\n    js: features.js,\n    wasm: features.wasm && this.has_wasm()\n  };\n  this.use(mm_unsharp_mask);\n  this.use(mm_resize);\n}\n\nMathLib.prototype = Object.create(Multimath.prototype);\nMathLib.prototype.constructor = MathLib;\n\nMathLib.prototype.resizeAndUnsharp = function resizeAndUnsharp(options, cache) {\n  var result = this.resize(options, cache);\n\n  if (options.unsharpAmount) {\n    this.unsharp_mask(result, options.toWidth, options.toHeight, options.unsharpAmount, options.unsharpRadius, options.unsharpThreshold);\n  }\n\n  return result;\n};\n\nmodule.exports = MathLib;\n\n},{\"./mm_resize\":4,\"./mm_unsharp_mask\":9,\"multimath\":19}],2:[function(_dereq_,module,exports){\n// Resize convolvers, pure JS implementation\n//\n'use strict'; // Precision of fixed FP values\n//var FIXED_FRAC_BITS = 14;\n\nfunction clampTo8(i) {\n  return i < 0 ? 0 : i > 255 ? 255 : i;\n}\n\nfunction clampNegative(i) {\n  return i >= 0 ? i : 0;\n} // Convolve image data in horizontal direction. Can be used for:\n//\n// 1. bitmap with premultiplied alpha\n// 2. bitmap without alpha (all values 255)\n//\n// Notes:\n//\n// - output is transposed\n// - output resolution is ~15 bits per channel(for better precision).\n//\n\n\nfunction convolveHor(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Store 15 bits between passes for better precision\n      // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n      //\n\n\n      dest[destOffset + 3] = clampNegative(a >> 7);\n      dest[destOffset + 2] = clampNegative(b >> 7);\n      dest[destOffset + 1] = clampNegative(g >> 7);\n      dest[destOffset] = clampNegative(r >> 7);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Supplementary method for `convolveHor()`\n//\n\n\nfunction convolveVert(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Sync with premultiplied version for exact result match\n\n\n      r >>= 7;\n      g >>= 7;\n      b >>= 7;\n      a >>= 7; // Bring this value back in range + round result.\n      //\n\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14);\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14);\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14);\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Premultiply & convolve image data in horizontal direction. Can be used for:\n//\n// - Any bitmap data, extracted with `.getImageData()` method (with\n//   non-premultiplied alpha)\n//\n// For images without alpha channel this method is slower than `convolveHor()`\n//\n\n\nfunction convolveHorWithPre(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a, alpha;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        alpha = src[srcPtr + 3];\n        a = a + filterVal * alpha | 0;\n        b = b + filterVal * src[srcPtr + 2] * alpha | 0;\n        g = g + filterVal * src[srcPtr + 1] * alpha | 0;\n        r = r + filterVal * src[srcPtr] * alpha | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Premultiply is (* alpha / 255).\n      // Postpone division for better performance\n\n\n      b = b / 255 | 0;\n      g = g / 255 | 0;\n      r = r / 255 | 0; // Store 15 bits between passes for better precision\n      // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n      //\n\n      dest[destOffset + 3] = clampNegative(a >> 7);\n      dest[destOffset + 2] = clampNegative(b >> 7);\n      dest[destOffset + 1] = clampNegative(g >> 7);\n      dest[destOffset] = clampNegative(r >> 7);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Supplementary method for `convolveHorWithPre()`\n//\n\n\nfunction convolveVertWithPre(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Downscale to leave room for un-premultiply\n\n\n      r >>= 7;\n      g >>= 7;\n      b >>= 7;\n      a >>= 7; // Un-premultiply\n\n      a = clampTo8(a + (1 << 13) >> 14);\n\n      if (a > 0) {\n        r = r * 255 / a | 0;\n        g = g * 255 / a | 0;\n        b = b * 255 / a | 0;\n      } // Bring this value back in range + round result.\n      // Shift value = FIXED_FRAC_BITS + 7\n      //\n\n\n      dest[destOffset + 3] = a;\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14);\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14);\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n}\n\nmodule.exports = {\n  convolveHor: convolveHor,\n  convolveVert: convolveVert,\n  convolveHorWithPre: convolveHorWithPre,\n  convolveVertWithPre: convolveVertWithPre\n};\n\n},{}],3:[function(_dereq_,module,exports){\n// This is autogenerated file from math.wasm, don't edit.\n//\n'use strict';\n/* eslint-disable max-len */\n\nmodule.exports = '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';\n\n},{}],4:[function(_dereq_,module,exports){\n'use strict';\n\nmodule.exports = {\n  name: 'resize',\n  fn: _dereq_('./resize'),\n  wasm_fn: _dereq_('./resize_wasm'),\n  wasm_src: _dereq_('./convolve_wasm_base64')\n};\n\n},{\"./convolve_wasm_base64\":3,\"./resize\":5,\"./resize_wasm\":8}],5:[function(_dereq_,module,exports){\n'use strict';\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nvar _require = _dereq_('./convolve'),\n    convolveHor = _require.convolveHor,\n    convolveVert = _require.convolveVert,\n    convolveHorWithPre = _require.convolveHorWithPre,\n    convolveVertWithPre = _require.convolveVertWithPre;\n\nfunction hasAlpha(src, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    if (src[ptr] !== 255) return true;\n    ptr = ptr + 4 | 0;\n  }\n\n  return false;\n}\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nmodule.exports = function resize(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0;\n  var offsetY = options.offsetY || 0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var filter = typeof options.filter === 'undefined' ? 'mks2013' : options.filter;\n  var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(filter, srcH, destH, scaleY, offsetY);\n  var tmp = new Uint16Array(destW * srcH * 4); // Autodetect if alpha channel exists, and use appropriate method\n\n  if (hasAlpha(src, srcW, srcH)) {\n    convolveHorWithPre(src, tmp, srcW, srcH, destW, filtersX);\n    convolveVertWithPre(tmp, dest, srcH, destW, destH, filtersY);\n  } else {\n    convolveHor(src, tmp, srcW, srcH, destW, filtersX);\n    convolveVert(tmp, dest, srcH, destW, destH, filtersY);\n    resetAlpha(dest, destW, destH);\n  }\n\n  return dest;\n};\n\n},{\"./convolve\":2,\"./resize_filter_gen\":6}],6:[function(_dereq_,module,exports){\n// Calculate convolution filters for each destination point,\n// and pack data to Int16Array:\n//\n// [ shift, length, data..., shift2, length2, data..., ... ]\n//\n// - shift - offset in src image\n// - length - filter length (in src points)\n// - data - filter values sequence\n//\n'use strict';\n\nvar FILTER_INFO = _dereq_('./resize_filter_info'); // Precision of fixed FP values\n\n\nvar FIXED_FRAC_BITS = 14;\n\nfunction toFixedPoint(num) {\n  return Math.round(num * ((1 << FIXED_FRAC_BITS) - 1));\n}\n\nmodule.exports = function resizeFilterGen(filter, srcSize, destSize, scale, offset) {\n  var filterFunction = FILTER_INFO.filter[filter].fn;\n  var scaleInverted = 1.0 / scale;\n  var scaleClamped = Math.min(1.0, scale); // For upscale\n  // Filter window (averaging interval), scaled to src image\n\n  var srcWindow = FILTER_INFO.filter[filter].win / scaleClamped;\n  var destPixel, srcPixel, srcFirst, srcLast, filterElementSize, floatFilter, fxpFilter, total, pxl, idx, floatVal, filterTotal, filterVal;\n  var leftNotEmpty, rightNotEmpty, filterShift, filterSize;\n  var maxFilterElementSize = Math.floor((srcWindow + 1) * 2);\n  var packedFilter = new Int16Array((maxFilterElementSize + 2) * destSize);\n  var packedFilterPtr = 0;\n  var slowCopy = !packedFilter.subarray || !packedFilter.set; // For each destination pixel calculate source range and built filter values\n\n  for (destPixel = 0; destPixel < destSize; destPixel++) {\n    // Scaling should be done relative to central pixel point\n    srcPixel = (destPixel + 0.5) * scaleInverted + offset;\n    srcFirst = Math.max(0, Math.floor(srcPixel - srcWindow));\n    srcLast = Math.min(srcSize - 1, Math.ceil(srcPixel + srcWindow));\n    filterElementSize = srcLast - srcFirst + 1;\n    floatFilter = new Float32Array(filterElementSize);\n    fxpFilter = new Int16Array(filterElementSize);\n    total = 0.0; // Fill filter values for calculated range\n\n    for (pxl = srcFirst, idx = 0; pxl <= srcLast; pxl++, idx++) {\n      floatVal = filterFunction((pxl + 0.5 - srcPixel) * scaleClamped);\n      total += floatVal;\n      floatFilter[idx] = floatVal;\n    } // Normalize filter, convert to fixed point and accumulate conversion error\n\n\n    filterTotal = 0;\n\n    for (idx = 0; idx < floatFilter.length; idx++) {\n      filterVal = floatFilter[idx] / total;\n      filterTotal += filterVal;\n      fxpFilter[idx] = toFixedPoint(filterVal);\n    } // Compensate normalization error, to minimize brightness drift\n\n\n    fxpFilter[destSize >> 1] += toFixedPoint(1.0 - filterTotal); //\n    // Now pack filter to useable form\n    //\n    // 1. Trim heading and tailing zero values, and compensate shitf/length\n    // 2. Put all to single array in this format:\n    //\n    //    [ pos shift, data length, value1, value2, value3, ... ]\n    //\n\n    leftNotEmpty = 0;\n\n    while (leftNotEmpty < fxpFilter.length && fxpFilter[leftNotEmpty] === 0) {\n      leftNotEmpty++;\n    }\n\n    if (leftNotEmpty < fxpFilter.length) {\n      rightNotEmpty = fxpFilter.length - 1;\n\n      while (rightNotEmpty > 0 && fxpFilter[rightNotEmpty] === 0) {\n        rightNotEmpty--;\n      }\n\n      filterShift = srcFirst + leftNotEmpty;\n      filterSize = rightNotEmpty - leftNotEmpty + 1;\n      packedFilter[packedFilterPtr++] = filterShift; // shift\n\n      packedFilter[packedFilterPtr++] = filterSize; // size\n\n      if (!slowCopy) {\n        packedFilter.set(fxpFilter.subarray(leftNotEmpty, rightNotEmpty + 1), packedFilterPtr);\n        packedFilterPtr += filterSize;\n      } else {\n        // fallback for old IE < 11, without subarray/set methods\n        for (idx = leftNotEmpty; idx <= rightNotEmpty; idx++) {\n          packedFilter[packedFilterPtr++] = fxpFilter[idx];\n        }\n      }\n    } else {\n      // zero data, write header only\n      packedFilter[packedFilterPtr++] = 0; // shift\n\n      packedFilter[packedFilterPtr++] = 0; // size\n    }\n  }\n\n  return packedFilter;\n};\n\n},{\"./resize_filter_info\":7}],7:[function(_dereq_,module,exports){\n// Filter definitions to build tables for\n// resizing convolvers.\n//\n// Presets for quality 0..3. Filter functions + window size\n//\n'use strict';\n\nvar filter = {\n  // Nearest neibor\n  box: {\n    win: 0.5,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n      return x < 0.5 ? 1.0 : 0.0;\n    }\n  },\n  // // Hamming\n  hamming: {\n    win: 1.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 1.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * (0.54 + 0.46 * Math.cos(xpi / 1.0));\n    }\n  },\n  // Lanczos, win = 2\n  lanczos2: {\n    win: 2.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 2.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * Math.sin(xpi / 2.0) / (xpi / 2.0);\n    }\n  },\n  // Lanczos, win = 3\n  lanczos3: {\n    win: 3.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 3.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * Math.sin(xpi / 3.0) / (xpi / 3.0);\n    }\n  },\n  // Magic Kernel Sharp 2013, win = 2.5\n  // http://johncostella.com/magic/\n  mks2013: {\n    win: 2.5,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 2.5) {\n        return 0.0;\n      }\n\n      if (x >= 1.5) {\n        return -0.125 * (x - 2.5) * (x - 2.5);\n      }\n\n      if (x >= 0.5) {\n        return 0.25 * (4 * x * x - 11 * x + 7);\n      }\n\n      return 1.0625 - 1.75 * x * x;\n    }\n  }\n};\nmodule.exports = {\n  filter: filter,\n  // Legacy mapping\n  f2q: {\n    box: 0,\n    hamming: 1,\n    lanczos2: 2,\n    lanczos3: 3\n  },\n  q2f: ['box', 'hamming', 'lanczos2', 'lanczos3']\n};\n\n},{}],8:[function(_dereq_,module,exports){\n'use strict';\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nfunction hasAlpha(src, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    if (src[ptr] !== 255) return true;\n    ptr = ptr + 4 | 0;\n  }\n\n  return false;\n}\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nfunction asUint8Array(src) {\n  return new Uint8Array(src.buffer, 0, src.byteLength);\n}\n\nvar IS_LE = true; // should not crash everything on module load in old browsers\n\ntry {\n  IS_LE = new Uint32Array(new Uint8Array([1, 0, 0, 0]).buffer)[0] === 1;\n} catch (__) {}\n\nfunction copyInt16asLE(src, target, target_offset) {\n  if (IS_LE) {\n    target.set(asUint8Array(src), target_offset);\n    return;\n  }\n\n  for (var ptr = target_offset, i = 0; i < src.length; i++) {\n    var data = src[i];\n    target[ptr++] = data & 0xFF;\n    target[ptr++] = data >> 8 & 0xFF;\n  }\n}\n\nmodule.exports = function resize_wasm(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0.0;\n  var offsetY = options.offsetY || 0.0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var filter = typeof options.filter === 'undefined' ? 'mks2013' : options.filter;\n  var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(filter, srcH, destH, scaleY, offsetY); // destination is 0 too.\n\n  var src_offset = 0;\n  var src_size = Math.max(src.byteLength, dest.byteLength); // buffer between convolve passes\n\n  var tmp_offset = this.__align(src_offset + src_size);\n\n  var tmp_size = srcH * destW * 4 * 2; // 2 bytes per channel\n\n  var filtersX_offset = this.__align(tmp_offset + tmp_size);\n\n  var filtersY_offset = this.__align(filtersX_offset + filtersX.byteLength);\n\n  var alloc_bytes = filtersY_offset + filtersY.byteLength;\n\n  var instance = this.__instance('resize', alloc_bytes); //\n  // Fill memory block with data to process\n  //\n\n\n  var mem = new Uint8Array(this.__memory.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer); // 32-bit copy is much faster in chrome\n\n  var src32 = new Uint32Array(src.buffer);\n  mem32.set(src32); // We should guarantee LE bytes order. Filters are not big, so\n  // speed difference is not significant vs direct .set()\n\n  copyInt16asLE(filtersX, mem, filtersX_offset);\n  copyInt16asLE(filtersY, mem, filtersY_offset); // Now call webassembly method\n  // emsdk does method names with '_'\n\n  var fn = instance.exports.convolveHV || instance.exports._convolveHV;\n\n  if (hasAlpha(src, srcW, srcH)) {\n    fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 1);\n  } else {\n    fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 0);\n    resetAlpha(dest, destW, destH);\n  } //\n  // Copy data back to typed array\n  //\n  // 32-bit copy is much faster in chrome\n\n\n  var dest32 = new Uint32Array(dest.buffer);\n  dest32.set(new Uint32Array(this.__memory.buffer, 0, destH * destW));\n  return dest;\n};\n\n},{\"./resize_filter_gen\":6}],9:[function(_dereq_,module,exports){\n'use strict';\n\nmodule.exports = {\n  name: 'unsharp_mask',\n  fn: _dereq_('./unsharp_mask'),\n  wasm_fn: _dereq_('./unsharp_mask_wasm'),\n  wasm_src: _dereq_('./unsharp_mask_wasm_base64')\n};\n\n},{\"./unsharp_mask\":10,\"./unsharp_mask_wasm\":11,\"./unsharp_mask_wasm_base64\":12}],10:[function(_dereq_,module,exports){\n// Unsharp mask filter\n//\n// http://stackoverflow.com/a/23322820/1031804\n// USM(O) = O + (2 * (Amount / 100) * (O - GB))\n// GB - gaussian blur.\n//\n// Image is converted from RGB to HSV, unsharp mask is applied to the\n// brightness channel and then image is converted back to RGB.\n//\n'use strict';\n\nvar glur_mono16 = _dereq_('glur/mono16');\n\nfunction hsv_v16(img, width, height) {\n  var size = width * height;\n  var out = new Uint16Array(size);\n  var r, g, b, max;\n\n  for (var i = 0; i < size; i++) {\n    r = img[4 * i];\n    g = img[4 * i + 1];\n    b = img[4 * i + 2];\n    max = r >= g && r >= b ? r : g >= b && g >= r ? g : b;\n    out[i] = max << 8;\n  }\n\n  return out;\n}\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  var v1, v2, vmul;\n  var diff, iTimes4;\n\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var brightness = hsv_v16(img, width, height);\n  var blured = new Uint16Array(brightness); // copy, because blur modify src\n\n  glur_mono16(blured, width, height, radius);\n  var amountFp = amount / 100 * 0x1000 + 0.5 | 0;\n  var thresholdFp = threshold << 8;\n  var size = width * height;\n  /* eslint-disable indent */\n\n  for (var i = 0; i < size; i++) {\n    v1 = brightness[i];\n    diff = v1 - blured[i];\n\n    if (Math.abs(diff) >= thresholdFp) {\n      // add unsharp mask to the brightness channel\n      v2 = v1 + (amountFp * diff + 0x800 >> 12); // Both v1 and v2 are within [0.0 .. 255.0] (0000-FF00) range, never going into\n      // [255.003 .. 255.996] (FF01-FFFF). This allows to round this value as (x+.5)|0\n      // later without overflowing.\n\n      v2 = v2 > 0xff00 ? 0xff00 : v2;\n      v2 = v2 < 0x0000 ? 0x0000 : v2; // Avoid division by 0. V=0 means rgb(0,0,0), unsharp with unsharpAmount>0 cannot\n      // change this value (because diff between colors gets inflated), so no need to verify correctness.\n\n      v1 = v1 !== 0 ? v1 : 1; // Multiplying V in HSV model by a constant is equivalent to multiplying each component\n      // in RGB by the same constant (same for HSL), see also:\n      // https://beesbuzz.biz/code/16-hsv-color-transforms\n\n      vmul = (v2 << 12) / v1 | 0; // Result will be in [0..255] range because:\n      //  - all numbers are positive\n      //  - r,g,b <= (v1/256)\n      //  - r,g,b,(v1/256),(v2/256) <= 255\n      // So highest this number can get is X*255/X+0.5=255.5 which is < 256 and rounds down.\n\n      iTimes4 = i * 4;\n      img[iTimes4] = img[iTimes4] * vmul + 0x800 >> 12; // R\n\n      img[iTimes4 + 1] = img[iTimes4 + 1] * vmul + 0x800 >> 12; // G\n\n      img[iTimes4 + 2] = img[iTimes4 + 2] * vmul + 0x800 >> 12; // B\n    }\n  }\n};\n\n},{\"glur/mono16\":18}],11:[function(_dereq_,module,exports){\n'use strict';\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var pixels = width * height;\n  var img_bytes_cnt = pixels * 4;\n  var hsv_bytes_cnt = pixels * 2;\n  var blur_bytes_cnt = pixels * 2;\n  var blur_line_byte_cnt = Math.max(width, height) * 4; // float32 array\n\n  var blur_coeffs_byte_cnt = 8 * 4; // float32 array\n\n  var img_offset = 0;\n  var hsv_offset = img_bytes_cnt;\n  var blur_offset = hsv_offset + hsv_bytes_cnt;\n  var blur_tmp_offset = blur_offset + blur_bytes_cnt;\n  var blur_line_offset = blur_tmp_offset + blur_bytes_cnt;\n  var blur_coeffs_offset = blur_line_offset + blur_line_byte_cnt;\n\n  var instance = this.__instance('unsharp_mask', img_bytes_cnt + hsv_bytes_cnt + blur_bytes_cnt * 2 + blur_line_byte_cnt + blur_coeffs_byte_cnt, {\n    exp: Math.exp\n  }); // 32-bit copy is much faster in chrome\n\n\n  var img32 = new Uint32Array(img.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer);\n  mem32.set(img32); // HSL\n\n  var fn = instance.exports.hsv_v16 || instance.exports._hsv_v16;\n  fn(img_offset, hsv_offset, width, height); // BLUR\n\n  fn = instance.exports.blurMono16 || instance.exports._blurMono16;\n  fn(hsv_offset, blur_offset, blur_tmp_offset, blur_line_offset, blur_coeffs_offset, width, height, radius); // UNSHARP\n\n  fn = instance.exports.unsharp || instance.exports._unsharp;\n  fn(img_offset, img_offset, hsv_offset, blur_offset, width, height, amount, threshold); // 32-bit copy is much faster in chrome\n\n  img32.set(new Uint32Array(this.__memory.buffer, 0, pixels));\n};\n\n},{}],12:[function(_dereq_,module,exports){\n// This is autogenerated file from math.wasm, don't edit.\n//\n'use strict';\n/* eslint-disable max-len */\n\nmodule.exports = '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';\n\n},{}],13:[function(_dereq_,module,exports){\n'use strict';\n\nvar GC_INTERVAL = 100;\n\nfunction Pool(create, idle) {\n  this.create = create;\n  this.available = [];\n  this.acquired = {};\n  this.lastId = 1;\n  this.timeoutId = 0;\n  this.idle = idle || 2000;\n}\n\nPool.prototype.acquire = function () {\n  var _this = this;\n\n  var resource;\n\n  if (this.available.length !== 0) {\n    resource = this.available.pop();\n  } else {\n    resource = this.create();\n    resource.id = this.lastId++;\n\n    resource.release = function () {\n      return _this.release(resource);\n    };\n  }\n\n  this.acquired[resource.id] = resource;\n  return resource;\n};\n\nPool.prototype.release = function (resource) {\n  var _this2 = this;\n\n  delete this.acquired[resource.id];\n  resource.lastUsed = Date.now();\n  this.available.push(resource);\n\n  if (this.timeoutId === 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this2.gc();\n    }, GC_INTERVAL);\n  }\n};\n\nPool.prototype.gc = function () {\n  var _this3 = this;\n\n  var now = Date.now();\n  this.available = this.available.filter(function (resource) {\n    if (now - resource.lastUsed > _this3.idle) {\n      resource.destroy();\n      return false;\n    }\n\n    return true;\n  });\n\n  if (this.available.length !== 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this3.gc();\n    }, GC_INTERVAL);\n  } else {\n    this.timeoutId = 0;\n  }\n};\n\nmodule.exports = Pool;\n\n},{}],14:[function(_dereq_,module,exports){\n// Add intermediate resizing steps when scaling down by a very large factor.\n//\n// For example, when resizing 10000x10000 down to 10x10, it'll resize it to\n// 300x300 first.\n//\n// It's needed because tiler has issues when the entire tile is scaled down\n// to a few pixels (1024px source tile with border size 3 should result in\n// at least 3+3+2 = 8px target tile, so max scale factor is 128 here).\n//\n// Also, adding intermediate steps can speed up processing if we use lower\n// quality algorithms for first stages.\n//\n'use strict'; // min size = 0 results in infinite loop,\n// min size = 1 can consume large amount of memory\n\nvar MIN_INNER_TILE_SIZE = 2;\n\nmodule.exports = function createStages(fromWidth, fromHeight, toWidth, toHeight, srcTileSize, destTileBorder) {\n  var scaleX = toWidth / fromWidth;\n  var scaleY = toHeight / fromHeight; // derived from createRegions equation:\n  // innerTileWidth = pixelFloor(srcTileSize * scaleX) - 2 * destTileBorder;\n\n  var minScale = (2 * destTileBorder + MIN_INNER_TILE_SIZE + 1) / srcTileSize; // refuse to scale image multiple times by less than twice each time,\n  // it could only happen because of invalid options\n\n  if (minScale > 0.5) return [[toWidth, toHeight]];\n  var stageCount = Math.ceil(Math.log(Math.min(scaleX, scaleY)) / Math.log(minScale)); // no additional resizes are necessary,\n  // stageCount can be zero or be negative when enlarging the image\n\n  if (stageCount <= 1) return [[toWidth, toHeight]];\n  var result = [];\n\n  for (var i = 0; i < stageCount; i++) {\n    var width = Math.round(Math.pow(Math.pow(fromWidth, stageCount - i - 1) * Math.pow(toWidth, i + 1), 1 / stageCount));\n    var height = Math.round(Math.pow(Math.pow(fromHeight, stageCount - i - 1) * Math.pow(toHeight, i + 1), 1 / stageCount));\n    result.push([width, height]);\n  }\n\n  return result;\n};\n\n},{}],15:[function(_dereq_,module,exports){\n// Split original image into multiple 1024x1024 chunks to reduce memory usage\n// (images have to be unpacked into typed arrays for resizing) and allow\n// parallel processing of multiple tiles at a time.\n//\n'use strict';\n/*\n * pixelFloor and pixelCeil are modified versions of Math.floor and Math.ceil\n * functions which take into account floating point arithmetic errors.\n * Those errors can cause undesired increments/decrements of sizes and offsets:\n * Math.ceil(36 / (36 / 500)) = 501\n * pixelCeil(36 / (36 / 500)) = 500\n */\n\nvar PIXEL_EPSILON = 1e-5;\n\nfunction pixelFloor(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.floor(x);\n}\n\nfunction pixelCeil(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.ceil(x);\n}\n\nmodule.exports = function createRegions(options) {\n  var scaleX = options.toWidth / options.width;\n  var scaleY = options.toHeight / options.height;\n  var innerTileWidth = pixelFloor(options.srcTileSize * scaleX) - 2 * options.destTileBorder;\n  var innerTileHeight = pixelFloor(options.srcTileSize * scaleY) - 2 * options.destTileBorder; // prevent infinite loop, this should never happen\n\n  if (innerTileWidth < 1 || innerTileHeight < 1) {\n    throw new Error('Internal error in pica: target tile width/height is too small.');\n  }\n\n  var x, y;\n  var innerX, innerY, toTileWidth, toTileHeight;\n  var tiles = [];\n  var tile; // we go top-to-down instead of left-to-right to make image displayed from top to\n  // doesn in the browser\n\n  for (innerY = 0; innerY < options.toHeight; innerY += innerTileHeight) {\n    for (innerX = 0; innerX < options.toWidth; innerX += innerTileWidth) {\n      x = innerX - options.destTileBorder;\n\n      if (x < 0) {\n        x = 0;\n      }\n\n      toTileWidth = innerX + innerTileWidth + options.destTileBorder - x;\n\n      if (x + toTileWidth >= options.toWidth) {\n        toTileWidth = options.toWidth - x;\n      }\n\n      y = innerY - options.destTileBorder;\n\n      if (y < 0) {\n        y = 0;\n      }\n\n      toTileHeight = innerY + innerTileHeight + options.destTileBorder - y;\n\n      if (y + toTileHeight >= options.toHeight) {\n        toTileHeight = options.toHeight - y;\n      }\n\n      tile = {\n        toX: x,\n        toY: y,\n        toWidth: toTileWidth,\n        toHeight: toTileHeight,\n        toInnerX: innerX,\n        toInnerY: innerY,\n        toInnerWidth: innerTileWidth,\n        toInnerHeight: innerTileHeight,\n        offsetX: x / scaleX - pixelFloor(x / scaleX),\n        offsetY: y / scaleY - pixelFloor(y / scaleY),\n        scaleX: scaleX,\n        scaleY: scaleY,\n        x: pixelFloor(x / scaleX),\n        y: pixelFloor(y / scaleY),\n        width: pixelCeil(toTileWidth / scaleX),\n        height: pixelCeil(toTileHeight / scaleY)\n      };\n      tiles.push(tile);\n    }\n  }\n\n  return tiles;\n};\n\n},{}],16:[function(_dereq_,module,exports){\n'use strict';\n\nfunction objClass(obj) {\n  return Object.prototype.toString.call(obj);\n}\n\nmodule.exports.isCanvas = function isCanvas(element) {\n  var cname = objClass(element);\n  return cname === '[object HTMLCanvasElement]'\n  /* browser */\n  || cname === '[object OffscreenCanvas]' || cname === '[object Canvas]'\n  /* node-canvas */\n  ;\n};\n\nmodule.exports.isImage = function isImage(element) {\n  return objClass(element) === '[object HTMLImageElement]';\n};\n\nmodule.exports.isImageBitmap = function isImageBitmap(element) {\n  return objClass(element) === '[object ImageBitmap]';\n};\n\nmodule.exports.limiter = function limiter(concurrency) {\n  var active = 0,\n      queue = [];\n\n  function roll() {\n    if (active < concurrency && queue.length) {\n      active++;\n      queue.shift()();\n    }\n  }\n\n  return function limit(fn) {\n    return new Promise(function (resolve, reject) {\n      queue.push(function () {\n        fn().then(function (result) {\n          resolve(result);\n          active--;\n          roll();\n        }, function (err) {\n          reject(err);\n          active--;\n          roll();\n        });\n      });\n      roll();\n    });\n  };\n};\n\nmodule.exports.cib_quality_name = function cib_quality_name(num) {\n  switch (num) {\n    case 0:\n      return 'pixelated';\n\n    case 1:\n      return 'low';\n\n    case 2:\n      return 'medium';\n  }\n\n  return 'high';\n};\n\nmodule.exports.cib_support = function cib_support(createCanvas) {\n  return Promise.resolve().then(function () {\n    if (typeof createImageBitmap === 'undefined') {\n      return false;\n    }\n\n    var c = createCanvas(100, 100);\n    return createImageBitmap(c, 0, 0, 100, 100, {\n      resizeWidth: 10,\n      resizeHeight: 10,\n      resizeQuality: 'high'\n    }).then(function (bitmap) {\n      var status = bitmap.width === 10; // Branch below is filtered on upper level. We do not call resize\n      // detection for basic ImageBitmap.\n      //\n      // https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap\n      // old Crome 51 has ImageBitmap without .close(). Then this code\n      // will throw and return 'false' as expected.\n      //\n\n      bitmap.close();\n      c = null;\n      return status;\n    });\n  })[\"catch\"](function () {\n    return false;\n  });\n};\n\nmodule.exports.worker_offscreen_canvas_support = function worker_offscreen_canvas_support() {\n  return new Promise(function (resolve, reject) {\n    if (typeof OffscreenCanvas === 'undefined') {\n      // if OffscreenCanvas is present, we assume browser supports Worker and built-in Promise as well\n      resolve(false);\n      return;\n    }\n\n    function workerPayload(self) {\n      if (typeof createImageBitmap === 'undefined') {\n        self.postMessage(false);\n        return;\n      }\n\n      Promise.resolve().then(function () {\n        var canvas = new OffscreenCanvas(10, 10); // test that 2d context can be used in worker\n\n        var ctx = canvas.getContext('2d');\n        ctx.rect(0, 0, 1, 1); // test that cib can be used to return image bitmap from worker\n\n        return createImageBitmap(canvas, 0, 0, 1, 1);\n      }).then(function () {\n        return self.postMessage(true);\n      }, function () {\n        return self.postMessage(false);\n      });\n    }\n\n    var code = btoa(\"(\".concat(workerPayload.toString(), \")(self);\"));\n    var w = new Worker(\"data:text/javascript;base64,\".concat(code));\n\n    w.onmessage = function (ev) {\n      return resolve(ev.data);\n    };\n\n    w.onerror = reject;\n  }).then(function (result) {\n    return result;\n  }, function () {\n    return false;\n  });\n}; // Check if canvas.getContext('2d').getImageData can be used,\n// FireFox randomizes the output of that function in `privacy.resistFingerprinting` mode\n\n\nmodule.exports.can_use_canvas = function can_use_canvas(createCanvas) {\n  var usable = false;\n\n  try {\n    var canvas = createCanvas(2, 1);\n    var ctx = canvas.getContext('2d');\n    var d = ctx.createImageData(2, 1);\n    d.data[0] = 12;\n    d.data[1] = 23;\n    d.data[2] = 34;\n    d.data[3] = 255;\n    d.data[4] = 45;\n    d.data[5] = 56;\n    d.data[6] = 67;\n    d.data[7] = 255;\n    ctx.putImageData(d, 0, 0);\n    d = null;\n    d = ctx.getImageData(0, 0, 2, 1);\n\n    if (d.data[0] === 12 && d.data[1] === 23 && d.data[2] === 34 && d.data[3] === 255 && d.data[4] === 45 && d.data[5] === 56 && d.data[6] === 67 && d.data[7] === 255) {\n      usable = true;\n    }\n  } catch (err) {}\n\n  return usable;\n}; // Check if createImageBitmap(img, sx, sy, sw, sh) signature works correctly\n// with JPEG images oriented with Exif;\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n// TODO: remove after it's fixed in chrome for at least 2 releases\n\n\nmodule.exports.cib_can_use_region = function cib_can_use_region() {\n  return new Promise(function (resolve) {\n    // `Image` check required for use in `ServiceWorker`\n    if (typeof Image === 'undefined' || typeof createImageBitmap === 'undefined') {\n      resolve(false);\n      return;\n    }\n\n    var image = new Image();\n    image.src = 'data:image/jpeg;base64,' + '/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAA' + 'AABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9' + 'sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRc' + 'ZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoa' + 'GhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRA' + 'f/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAA' + 'IQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAA' + 'AAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIB' + 'AT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAA' + 'AAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAA' + 'AAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQ' + 'QAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z';\n\n    image.onload = function () {\n      createImageBitmap(image, 0, 0, image.width, image.height).then(function (bitmap) {\n        if (bitmap.width === image.width && bitmap.height === image.height) {\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      }, function () {\n        return resolve(false);\n      });\n    };\n\n    image.onerror = function () {\n      return resolve(false);\n    };\n  });\n};\n\n},{}],17:[function(_dereq_,module,exports){\n// Web Worker wrapper for image resize function\n'use strict';\n\nmodule.exports = function () {\n  var MathLib = _dereq_('./mathlib');\n\n  var mathLib;\n  /* eslint-disable no-undef */\n\n  onmessage = function onmessage(ev) {\n    var tileOpts = ev.data.opts;\n    var returnBitmap = false;\n\n    if (!tileOpts.src && tileOpts.srcBitmap) {\n      var canvas = new OffscreenCanvas(tileOpts.width, tileOpts.height);\n      var ctx = canvas.getContext('2d');\n      ctx.drawImage(tileOpts.srcBitmap, 0, 0);\n      tileOpts.src = ctx.getImageData(0, 0, tileOpts.width, tileOpts.height).data;\n      canvas.width = canvas.height = 0;\n      canvas = null;\n      tileOpts.srcBitmap.close();\n      tileOpts.srcBitmap = null; // Temporary force out data to typed array, because Chrome have artefacts\n      // https://github.com/nodeca/pica/issues/223\n      // returnBitmap = true;\n    }\n\n    if (!mathLib) mathLib = new MathLib(ev.data.features); // Use multimath's sync auto-init. Avoid Promise use in old browsers,\n    // because polyfills are not propagated to webworker.\n\n    var data = mathLib.resizeAndUnsharp(tileOpts);\n\n    if (returnBitmap) {\n      var toImageData = new ImageData(new Uint8ClampedArray(data), tileOpts.toWidth, tileOpts.toHeight);\n\n      var _canvas = new OffscreenCanvas(tileOpts.toWidth, tileOpts.toHeight);\n\n      var _ctx = _canvas.getContext('2d');\n\n      _ctx.putImageData(toImageData, 0, 0);\n\n      createImageBitmap(_canvas).then(function (bitmap) {\n        postMessage({\n          bitmap: bitmap\n        }, [bitmap]);\n      });\n    } else {\n      postMessage({\n        data: data\n      }, [data.buffer]);\n    }\n  };\n};\n\n},{\"./mathlib\":1}],18:[function(_dereq_,module,exports){\n// Calculate Gaussian blur of an image using IIR filter\n// The method is taken from Intel's white paper and code example attached to it:\n// https://software.intel.com/en-us/articles/iir-gaussian-blur-filter\n// -implementation-using-intel-advanced-vector-extensions\n\nvar a0, a1, a2, a3, b1, b2, left_corner, right_corner;\n\nfunction gaussCoef(sigma) {\n  if (sigma < 0.5) {\n    sigma = 0.5;\n  }\n\n  var a = Math.exp(0.726 * 0.726) / sigma,\n      g1 = Math.exp(-a),\n      g2 = Math.exp(-2 * a),\n      k = (1 - g1) * (1 - g1) / (1 + 2 * a * g1 - g2);\n\n  a0 = k;\n  a1 = k * (a - 1) * g1;\n  a2 = k * (a + 1) * g1;\n  a3 = -k * g2;\n  b1 = 2 * g1;\n  b2 = -g2;\n  left_corner = (a0 + a1) / (1 - b1 - b2);\n  right_corner = (a2 + a3) / (1 - b1 - b2);\n\n  // Attempt to force type to FP32.\n  return new Float32Array([ a0, a1, a2, a3, b1, b2, left_corner, right_corner ]);\n}\n\nfunction convolveMono16(src, out, line, coeff, width, height) {\n  // takes src image and writes the blurred and transposed result into out\n\n  var prev_src, curr_src, curr_out, prev_out, prev_prev_out;\n  var src_index, out_index, line_index;\n  var i, j;\n  var coeff_a0, coeff_a1, coeff_b1, coeff_b2;\n\n  for (i = 0; i < height; i++) {\n    src_index = i * width;\n    out_index = i;\n    line_index = 0;\n\n    // left to right\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[6];\n    prev_out = prev_prev_out;\n\n    coeff_a0 = coeff[0];\n    coeff_a1 = coeff[1];\n    coeff_b1 = coeff[4];\n    coeff_b2 = coeff[5];\n\n    for (j = 0; j < width; j++) {\n      curr_src = src[src_index];\n\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n      prev_src = curr_src;\n\n      line[line_index] = prev_out;\n      line_index++;\n      src_index++;\n    }\n\n    src_index--;\n    line_index--;\n    out_index += height * (width - 1);\n\n    // right to left\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[7];\n    prev_out = prev_prev_out;\n    curr_src = prev_src;\n\n    coeff_a0 = coeff[2];\n    coeff_a1 = coeff[3];\n\n    for (j = width - 1; j >= 0; j--) {\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n\n      prev_src = curr_src;\n      curr_src = src[src_index];\n\n      out[out_index] = line[line_index] + prev_out;\n\n      src_index--;\n      line_index--;\n      out_index -= height;\n    }\n  }\n}\n\n\nfunction blurMono16(src, width, height, radius) {\n  // Quick exit on zero radius\n  if (!radius) { return; }\n\n  var out      = new Uint16Array(src.length),\n      tmp_line = new Float32Array(Math.max(width, height));\n\n  var coeff = gaussCoef(radius);\n\n  convolveMono16(src, out, tmp_line, coeff, width, height, radius);\n  convolveMono16(out, src, tmp_line, coeff, height, width, radius);\n}\n\nmodule.exports = blurMono16;\n\n},{}],19:[function(_dereq_,module,exports){\n'use strict';\n\n\nvar assign         = _dereq_('object-assign');\nvar base64decode   = _dereq_('./lib/base64decode');\nvar hasWebAssembly = _dereq_('./lib/wa_detect');\n\n\nvar DEFAULT_OPTIONS = {\n  js: true,\n  wasm: true\n};\n\n\nfunction MultiMath(options) {\n  if (!(this instanceof MultiMath)) return new MultiMath(options);\n\n  var opts = assign({}, DEFAULT_OPTIONS, options || {});\n\n  this.options         = opts;\n\n  this.__cache         = {};\n\n  this.__init_promise  = null;\n  this.__modules       = opts.modules || {};\n  this.__memory        = null;\n  this.__wasm          = {};\n\n  this.__isLE = ((new Uint32Array((new Uint8Array([ 1, 0, 0, 0 ])).buffer))[0] === 1);\n\n  if (!this.options.js && !this.options.wasm) {\n    throw new Error('mathlib: at least \"js\" or \"wasm\" should be enabled');\n  }\n}\n\n\nMultiMath.prototype.has_wasm = hasWebAssembly;\n\n\nMultiMath.prototype.use = function (module) {\n  this.__modules[module.name] = module;\n\n  // Pin the best possible implementation\n  if (this.options.wasm && this.has_wasm() && module.wasm_fn) {\n    this[module.name] = module.wasm_fn;\n  } else {\n    this[module.name] = module.fn;\n  }\n\n  return this;\n};\n\n\nMultiMath.prototype.init = function () {\n  if (this.__init_promise) return this.__init_promise;\n\n  if (!this.options.js && this.options.wasm && !this.has_wasm()) {\n    return Promise.reject(new Error('mathlib: only \"wasm\" was enabled, but it\\'s not supported'));\n  }\n\n  var self = this;\n\n  this.__init_promise = Promise.all(Object.keys(self.__modules).map(function (name) {\n    var module = self.__modules[name];\n\n    if (!self.options.wasm || !self.has_wasm() || !module.wasm_fn) return null;\n\n    // If already compiled - exit\n    if (self.__wasm[name]) return null;\n\n    // Compile wasm source\n    return WebAssembly.compile(self.__base64decode(module.wasm_src))\n      .then(function (m) { self.__wasm[name] = m; });\n  }))\n    .then(function () { return self; });\n\n  return this.__init_promise;\n};\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Methods below are for internal use from plugins\n\n\n// Simple decode base64 to typed array. Useful to load embedded webassembly\n// code. You probably don't need to call this method directly.\n//\nMultiMath.prototype.__base64decode = base64decode;\n\n\n// Increase current memory to include specified number of bytes. Do nothing if\n// size is already ok. You probably don't need to call this method directly,\n// because it will be invoked from `.__instance()`.\n//\nMultiMath.prototype.__reallocate = function mem_grow_to(bytes) {\n  if (!this.__memory) {\n    this.__memory = new WebAssembly.Memory({\n      initial: Math.ceil(bytes / (64 * 1024))\n    });\n    return this.__memory;\n  }\n\n  var mem_size = this.__memory.buffer.byteLength;\n\n  if (mem_size < bytes) {\n    this.__memory.grow(Math.ceil((bytes - mem_size) / (64 * 1024)));\n  }\n\n  return this.__memory;\n};\n\n\n// Returns instantinated webassembly item by name, with specified memory size\n// and environment.\n// - use cache if available\n// - do sync module init, if async init was not called earlier\n// - allocate memory if not enougth\n// - can export functions to webassembly via \"env_extra\",\n//   for example, { exp: Math.exp }\n//\nMultiMath.prototype.__instance = function instance(name, memsize, env_extra) {\n  if (memsize) this.__reallocate(memsize);\n\n  // If .init() was not called, do sync compile\n  if (!this.__wasm[name]) {\n    var module = this.__modules[name];\n    this.__wasm[name] = new WebAssembly.Module(this.__base64decode(module.wasm_src));\n  }\n\n  if (!this.__cache[name]) {\n    var env_base = {\n      memoryBase: 0,\n      memory: this.__memory,\n      tableBase: 0,\n      table: new WebAssembly.Table({ initial: 0, element: 'anyfunc' })\n    };\n\n    this.__cache[name] = new WebAssembly.Instance(this.__wasm[name], {\n      env: assign(env_base, env_extra || {})\n    });\n  }\n\n  return this.__cache[name];\n};\n\n\n// Helper to calculate memory aligh for pointers. Webassembly does not require\n// this, but you may wish to experiment. Default base = 8;\n//\nMultiMath.prototype.__align = function align(number, base) {\n  base = base || 8;\n  var reminder = number % base;\n  return number + (reminder ? base - reminder : 0);\n};\n\n\nmodule.exports = MultiMath;\n\n},{\"./lib/base64decode\":20,\"./lib/wa_detect\":21,\"object-assign\":22}],20:[function(_dereq_,module,exports){\n// base64 decode str -> Uint8Array, to load WA modules\n//\n'use strict';\n\n\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n\nmodule.exports = function base64decode(str) {\n  var input = str.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max   = input.length;\n\n  var out = new Uint8Array((max * 3) >> 2);\n\n  // Collect by 6*4 bits (3 bytes)\n\n  var bits = 0;\n  var ptr  = 0;\n\n  for (var idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      out[ptr++] = (bits >> 16) & 0xFF;\n      out[ptr++] = (bits >> 8) & 0xFF;\n      out[ptr++] = bits & 0xFF;\n    }\n\n    bits = (bits << 6) | BASE64_MAP.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  var tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    out[ptr++] = (bits >> 16) & 0xFF;\n    out[ptr++] = (bits >> 8) & 0xFF;\n    out[ptr++] = bits & 0xFF;\n  } else if (tailbits === 18) {\n    out[ptr++] = (bits >> 10) & 0xFF;\n    out[ptr++] = (bits >> 2) & 0xFF;\n  } else if (tailbits === 12) {\n    out[ptr++] = (bits >> 4) & 0xFF;\n  }\n\n  return out;\n};\n\n},{}],21:[function(_dereq_,module,exports){\n// Detect WebAssembly support.\n// - Check global WebAssembly object\n// - Try to load simple module (can be disabled via CSP)\n//\n'use strict';\n\n\nvar wa;\n\n\nmodule.exports = function hasWebAssembly() {\n  // use cache if called before;\n  if (typeof wa !== 'undefined') return wa;\n\n  wa = false;\n\n  if (typeof WebAssembly === 'undefined') return wa;\n\n  // If WebAssenbly is disabled, code can throw on compile\n  try {\n    // https://github.com/brion/min-wasm-fail/blob/master/min-wasm-fail.in.js\n    // Additional check that WA internals are correct\n\n    /* eslint-disable comma-spacing, max-len */\n    var bin      = new Uint8Array([ 0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11 ]);\n    var module   = new WebAssembly.Module(bin);\n    var instance = new WebAssembly.Instance(module, {});\n\n    // test storing to and loading from a non-zero location via a parameter.\n    // Safari on iOS 11.2.5 returns 0 unexpectedly at non-zero locations\n    if (instance.exports.test(4) !== 0) wa = true;\n\n    return wa;\n  } catch (__) {}\n\n  return wa;\n};\n\n},{}],22:[function(_dereq_,module,exports){\n/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n},{}],23:[function(_dereq_,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],\"/index.js\":[function(_dereq_,module,exports){\n'use strict';\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar assign = _dereq_('object-assign');\n\nvar webworkify = _dereq_('webworkify');\n\nvar MathLib = _dereq_('./lib/mathlib');\n\nvar Pool = _dereq_('./lib/pool');\n\nvar utils = _dereq_('./lib/utils');\n\nvar worker = _dereq_('./lib/worker');\n\nvar createStages = _dereq_('./lib/stepper');\n\nvar createRegions = _dereq_('./lib/tiler');\n\nvar filter_info = _dereq_('./lib/mm_resize/resize_filter_info'); // Deduplicate pools & limiters with the same configs\n// when user creates multiple pica instances.\n\n\nvar singletones = {};\nvar NEED_SAFARI_FIX = false;\n\ntry {\n  if (typeof navigator !== 'undefined' && navigator.userAgent) {\n    NEED_SAFARI_FIX = navigator.userAgent.indexOf('Safari') >= 0;\n  }\n} catch (e) {}\n\nvar concurrency = 1;\n\nif (typeof navigator !== 'undefined') {\n  concurrency = Math.min(navigator.hardwareConcurrency || 1, 4);\n}\n\nvar DEFAULT_PICA_OPTS = {\n  tile: 1024,\n  concurrency: concurrency,\n  features: ['js', 'wasm', 'ww'],\n  idle: 2000,\n  createCanvas: function createCanvas(width, height) {\n    var tmpCanvas = document.createElement('canvas');\n    tmpCanvas.width = width;\n    tmpCanvas.height = height;\n    return tmpCanvas;\n  }\n};\nvar DEFAULT_RESIZE_OPTS = {\n  filter: 'mks2013',\n  unsharpAmount: 0,\n  unsharpRadius: 0.0,\n  unsharpThreshold: 0\n};\nvar CAN_NEW_IMAGE_DATA = false;\nvar CAN_CREATE_IMAGE_BITMAP = false;\nvar CAN_USE_CANVAS_GET_IMAGE_DATA = false;\nvar CAN_USE_OFFSCREEN_CANVAS = false;\nvar CAN_USE_CIB_REGION_FOR_IMAGE = false;\n\nfunction workerFabric() {\n  return {\n    value: webworkify(worker),\n    destroy: function destroy() {\n      this.value.terminate();\n\n      if (typeof window !== 'undefined') {\n        var url = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n        if (url && url.revokeObjectURL && this.value.objectURL) {\n          url.revokeObjectURL(this.value.objectURL);\n        }\n      }\n    }\n  };\n} ////////////////////////////////////////////////////////////////////////////////\n// API methods\n\n\nfunction Pica(options) {\n  if (!(this instanceof Pica)) return new Pica(options);\n  this.options = assign({}, DEFAULT_PICA_OPTS, options || {});\n  var limiter_key = \"lk_\".concat(this.options.concurrency); // Share limiters to avoid multiple parallel workers when user creates\n  // multiple pica instances.\n\n  this.__limit = singletones[limiter_key] || utils.limiter(this.options.concurrency);\n  if (!singletones[limiter_key]) singletones[limiter_key] = this.__limit; // List of supported features, according to options & browser/node.js\n\n  this.features = {\n    js: false,\n    // pure JS implementation, can be disabled for testing\n    wasm: false,\n    // webassembly implementation for heavy functions\n    cib: false,\n    // resize via createImageBitmap (only FF at this moment)\n    ww: false // webworkers\n\n  };\n  this.__workersPool = null; // Store requested features for webworkers\n\n  this.__requested_features = [];\n  this.__mathlib = null;\n}\n\nPica.prototype.init = function () {\n  var _this = this;\n\n  if (this.__initPromise) return this.__initPromise; // Test if we can create ImageData without canvas and memory copy\n\n  if (typeof ImageData !== 'undefined' && typeof Uint8ClampedArray !== 'undefined') {\n    try {\n      /* eslint-disable no-new */\n      new ImageData(new Uint8ClampedArray(400), 10, 10);\n      CAN_NEW_IMAGE_DATA = true;\n    } catch (__) {}\n  } // ImageBitmap can be effective in 2 places:\n  //\n  // 1. Threaded jpeg unpack (basic)\n  // 2. Built-in resize (blocked due problem in chrome, see issue #89)\n  //\n  // For basic use we also need ImageBitmap wo support .close() method,\n  // see https://developer.mozilla.org/ru/docs/Web/API/ImageBitmap\n\n\n  if (typeof ImageBitmap !== 'undefined') {\n    if (ImageBitmap.prototype && ImageBitmap.prototype.close) {\n      CAN_CREATE_IMAGE_BITMAP = true;\n    } else {\n      this.debug('ImageBitmap does not support .close(), disabled');\n    }\n  }\n\n  var features = this.options.features.slice();\n\n  if (features.indexOf('all') >= 0) {\n    features = ['cib', 'wasm', 'js', 'ww'];\n  }\n\n  this.__requested_features = features;\n  this.__mathlib = new MathLib(features); // Check WebWorker support if requested\n\n  if (features.indexOf('ww') >= 0) {\n    if (typeof window !== 'undefined' && 'Worker' in window) {\n      // IE <= 11 don't allow to create webworkers from string. We should check it.\n      // https://connect.microsoft.com/IE/feedback/details/801810/web-workers-from-blob-urls-in-ie-10-and-11\n      try {\n        var wkr = _dereq_('webworkify')(function () {});\n\n        wkr.terminate();\n        this.features.ww = true; // pool uniqueness depends on pool config + webworker config\n\n        var wpool_key = \"wp_\".concat(JSON.stringify(this.options));\n\n        if (singletones[wpool_key]) {\n          this.__workersPool = singletones[wpool_key];\n        } else {\n          this.__workersPool = new Pool(workerFabric, this.options.idle);\n          singletones[wpool_key] = this.__workersPool;\n        }\n      } catch (__) {}\n    }\n  }\n\n  var initMath = this.__mathlib.init().then(function (mathlib) {\n    // Copy detected features\n    assign(_this.features, mathlib.features);\n  });\n\n  var checkCibResize;\n\n  if (!CAN_CREATE_IMAGE_BITMAP) {\n    checkCibResize = Promise.resolve(false);\n  } else {\n    checkCibResize = utils.cib_support(this.options.createCanvas).then(function (status) {\n      if (_this.features.cib && features.indexOf('cib') < 0) {\n        _this.debug('createImageBitmap() resize supported, but disabled by config');\n\n        return;\n      }\n\n      if (features.indexOf('cib') >= 0) _this.features.cib = status;\n    });\n  }\n\n  CAN_USE_CANVAS_GET_IMAGE_DATA = utils.can_use_canvas(this.options.createCanvas);\n  var checkOffscreenCanvas;\n\n  if (CAN_CREATE_IMAGE_BITMAP && CAN_NEW_IMAGE_DATA && features.indexOf('ww') !== -1) {\n    checkOffscreenCanvas = utils.worker_offscreen_canvas_support();\n  } else {\n    checkOffscreenCanvas = Promise.resolve(false);\n  }\n\n  checkOffscreenCanvas = checkOffscreenCanvas.then(function (result) {\n    CAN_USE_OFFSCREEN_CANVAS = result;\n  }); // we use createImageBitmap to crop image data and pass it to workers,\n  // so need to check whether function works correctly;\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n\n  var checkCibRegion = utils.cib_can_use_region().then(function (result) {\n    CAN_USE_CIB_REGION_FOR_IMAGE = result;\n  }); // Init math lib. That's async because can load some\n\n  this.__initPromise = Promise.all([initMath, checkCibResize, checkOffscreenCanvas, checkCibRegion]).then(function () {\n    return _this;\n  });\n  return this.__initPromise;\n}; // Call resizer in webworker or locally, depending on config\n\n\nPica.prototype.__invokeResize = function (tileOpts, opts) {\n  var _this2 = this;\n\n  // Share cache between calls:\n  //\n  // - wasm instance\n  // - wasm memory object\n  //\n  opts.__mathCache = opts.__mathCache || {};\n  return Promise.resolve().then(function () {\n    if (!_this2.features.ww) {\n      // not possible to have ImageBitmap here if user disabled WW\n      return {\n        data: _this2.__mathlib.resizeAndUnsharp(tileOpts, opts.__mathCache)\n      };\n    }\n\n    return new Promise(function (resolve, reject) {\n      var w = _this2.__workersPool.acquire();\n\n      if (opts.cancelToken) opts.cancelToken[\"catch\"](function (err) {\n        return reject(err);\n      });\n\n      w.value.onmessage = function (ev) {\n        w.release();\n        if (ev.data.err) reject(ev.data.err);else resolve(ev.data);\n      };\n\n      var transfer = [];\n      if (tileOpts.src) transfer.push(tileOpts.src.buffer);\n      if (tileOpts.srcBitmap) transfer.push(tileOpts.srcBitmap);\n      w.value.postMessage({\n        opts: tileOpts,\n        features: _this2.__requested_features,\n        preload: {\n          wasm_nodule: _this2.__mathlib.__\n        }\n      }, transfer);\n    });\n  });\n}; // this function can return promise if createImageBitmap is used\n\n\nPica.prototype.__extractTileData = function (tile, from, opts, stageEnv, extractTo) {\n  if (this.features.ww && CAN_USE_OFFSCREEN_CANVAS && ( // createImageBitmap doesn't work for images (Image, ImageBitmap) with Exif orientation in Chrome,\n  // can use canvas because canvas doesn't have orientation;\n  // see https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n  utils.isCanvas(from) || CAN_USE_CIB_REGION_FOR_IMAGE)) {\n    this.debug('Create tile for OffscreenCanvas');\n    return createImageBitmap(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height).then(function (bitmap) {\n      extractTo.srcBitmap = bitmap;\n      return extractTo;\n    });\n  } // Extract tile RGBA buffer, depending on input type\n\n\n  if (utils.isCanvas(from)) {\n    if (!stageEnv.srcCtx) stageEnv.srcCtx = from.getContext('2d'); // If input is Canvas - extract region data directly\n\n    this.debug('Get tile pixel data');\n    extractTo.src = stageEnv.srcCtx.getImageData(tile.x, tile.y, tile.width, tile.height).data;\n    return extractTo;\n  } // If input is Image or decoded to ImageBitmap,\n  // draw region to temporary canvas and extract data from it\n  //\n  // Note! Attempt to reuse this canvas causes significant slowdown in chrome\n  //\n\n\n  this.debug('Draw tile imageBitmap/image to temporary canvas');\n  var tmpCanvas = this.options.createCanvas(tile.width, tile.height);\n  var tmpCtx = tmpCanvas.getContext('2d');\n  tmpCtx.globalCompositeOperation = 'copy';\n  tmpCtx.drawImage(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height, 0, 0, tile.width, tile.height);\n  this.debug('Get tile pixel data');\n  extractTo.src = tmpCtx.getImageData(0, 0, tile.width, tile.height).data; // Safari 12 workaround\n  // https://github.com/nodeca/pica/issues/199\n\n  tmpCanvas.width = tmpCanvas.height = 0;\n  return extractTo;\n};\n\nPica.prototype.__landTileData = function (tile, result, stageEnv) {\n  var toImageData;\n  this.debug('Convert raw rgba tile result to ImageData');\n\n  if (result.bitmap) {\n    stageEnv.toCtx.drawImage(result.bitmap, tile.toX, tile.toY);\n    return null;\n  }\n\n  if (CAN_NEW_IMAGE_DATA) {\n    // this branch is for modern browsers\n    // If `new ImageData()` & Uint8ClampedArray suported\n    toImageData = new ImageData(new Uint8ClampedArray(result.data), tile.toWidth, tile.toHeight);\n  } else {\n    // fallback for `node-canvas` and old browsers\n    // (IE11 has ImageData but does not support `new ImageData()`)\n    toImageData = stageEnv.toCtx.createImageData(tile.toWidth, tile.toHeight);\n\n    if (toImageData.data.set) {\n      toImageData.data.set(result.data);\n    } else {\n      // IE9 don't have `.set()`\n      for (var i = toImageData.data.length - 1; i >= 0; i--) {\n        toImageData.data[i] = result.data[i];\n      }\n    }\n  }\n\n  this.debug('Draw tile');\n\n  if (NEED_SAFARI_FIX) {\n    // Safari draws thin white stripes between tiles without this fix\n    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth + 1e-5, tile.toInnerHeight + 1e-5);\n  } else {\n    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth, tile.toInnerHeight);\n  }\n\n  return null;\n};\n\nPica.prototype.__tileAndResize = function (from, to, opts) {\n  var _this3 = this;\n\n  var stageEnv = {\n    srcCtx: null,\n    srcImageBitmap: null,\n    isImageBitmapReused: false,\n    toCtx: null\n  };\n\n  var processTile = function processTile(tile) {\n    return _this3.__limit(function () {\n      if (opts.canceled) return opts.cancelToken;\n      var tileOpts = {\n        width: tile.width,\n        height: tile.height,\n        toWidth: tile.toWidth,\n        toHeight: tile.toHeight,\n        scaleX: tile.scaleX,\n        scaleY: tile.scaleY,\n        offsetX: tile.offsetX,\n        offsetY: tile.offsetY,\n        filter: opts.filter,\n        unsharpAmount: opts.unsharpAmount,\n        unsharpRadius: opts.unsharpRadius,\n        unsharpThreshold: opts.unsharpThreshold\n      };\n\n      _this3.debug('Invoke resize math');\n\n      return Promise.resolve(tileOpts).then(function (tileOpts) {\n        return _this3.__extractTileData(tile, from, opts, stageEnv, tileOpts);\n      }).then(function (tileOpts) {\n        _this3.debug('Invoke resize math');\n\n        return _this3.__invokeResize(tileOpts, opts);\n      }).then(function (result) {\n        if (opts.canceled) return opts.cancelToken;\n        stageEnv.srcImageData = null;\n        return _this3.__landTileData(tile, result, stageEnv);\n      });\n    });\n  }; // Need to normalize data source first. It can be canvas or image.\n  // If image - try to decode in background if possible\n\n\n  return Promise.resolve().then(function () {\n    stageEnv.toCtx = to.getContext('2d');\n    if (utils.isCanvas(from)) return null;\n\n    if (utils.isImageBitmap(from)) {\n      stageEnv.srcImageBitmap = from;\n      stageEnv.isImageBitmapReused = true;\n      return null;\n    }\n\n    if (utils.isImage(from)) {\n      // try do decode image in background for faster next operations;\n      // if we're using offscreen canvas, cib is called per tile, so not needed here\n      if (!CAN_CREATE_IMAGE_BITMAP) return null;\n\n      _this3.debug('Decode image via createImageBitmap');\n\n      return createImageBitmap(from).then(function (imageBitmap) {\n        stageEnv.srcImageBitmap = imageBitmap;\n      }) // Suppress error to use fallback, if method fails\n      // https://github.com/nodeca/pica/issues/190\n\n      /* eslint-disable no-unused-vars */\n      [\"catch\"](function (e) {\n        return null;\n      });\n    }\n\n    throw new Error('Pica: \".from\" should be Image, Canvas or ImageBitmap');\n  }).then(function () {\n    if (opts.canceled) return opts.cancelToken;\n\n    _this3.debug('Calculate tiles'); //\n    // Here we are with \"normalized\" source,\n    // follow to tiling\n    //\n\n\n    var regions = createRegions({\n      width: opts.width,\n      height: opts.height,\n      srcTileSize: _this3.options.tile,\n      toWidth: opts.toWidth,\n      toHeight: opts.toHeight,\n      destTileBorder: opts.__destTileBorder\n    });\n    var jobs = regions.map(function (tile) {\n      return processTile(tile);\n    });\n\n    function cleanup(stageEnv) {\n      if (stageEnv.srcImageBitmap) {\n        if (!stageEnv.isImageBitmapReused) stageEnv.srcImageBitmap.close();\n        stageEnv.srcImageBitmap = null;\n      }\n    }\n\n    _this3.debug('Process tiles');\n\n    return Promise.all(jobs).then(function () {\n      _this3.debug('Finished!');\n\n      cleanup(stageEnv);\n      return to;\n    }, function (err) {\n      cleanup(stageEnv);\n      throw err;\n    });\n  });\n};\n\nPica.prototype.__processStages = function (stages, from, to, opts) {\n  var _this4 = this;\n\n  if (opts.canceled) return opts.cancelToken;\n\n  var _stages$shift = stages.shift(),\n      _stages$shift2 = _slicedToArray(_stages$shift, 2),\n      toWidth = _stages$shift2[0],\n      toHeight = _stages$shift2[1];\n\n  var isLastStage = stages.length === 0; // Optimization for legacy filters -\n  // only use user-defined quality for the last stage,\n  // use simpler (Hamming) filter for the first stages where\n  // scale factor is large enough (more than 2-3)\n  //\n  // For advanced filters (mks2013 and custom) - skip optimization,\n  // because need to apply sharpening every time\n\n  var filter;\n  if (isLastStage || filter_info.q2f.indexOf(opts.filter) < 0) filter = opts.filter;else if (opts.filter === 'box') filter = 'box';else filter = 'hamming';\n  opts = assign({}, opts, {\n    toWidth: toWidth,\n    toHeight: toHeight,\n    filter: filter\n  });\n  var tmpCanvas;\n\n  if (!isLastStage) {\n    // create temporary canvas\n    tmpCanvas = this.options.createCanvas(toWidth, toHeight);\n  }\n\n  return this.__tileAndResize(from, isLastStage ? to : tmpCanvas, opts).then(function () {\n    if (isLastStage) return to;\n    opts.width = toWidth;\n    opts.height = toHeight;\n    return _this4.__processStages(stages, tmpCanvas, to, opts);\n  }).then(function (res) {\n    if (tmpCanvas) {\n      // Safari 12 workaround\n      // https://github.com/nodeca/pica/issues/199\n      tmpCanvas.width = tmpCanvas.height = 0;\n    }\n\n    return res;\n  });\n};\n\nPica.prototype.__resizeViaCreateImageBitmap = function (from, to, opts) {\n  var _this5 = this;\n\n  var toCtx = to.getContext('2d');\n  this.debug('Resize via createImageBitmap()');\n  return createImageBitmap(from, {\n    resizeWidth: opts.toWidth,\n    resizeHeight: opts.toHeight,\n    resizeQuality: utils.cib_quality_name(filter_info.f2q[opts.filter])\n  }).then(function (imageBitmap) {\n    if (opts.canceled) return opts.cancelToken; // if no unsharp - draw directly to output canvas\n\n    if (!opts.unsharpAmount) {\n      toCtx.drawImage(imageBitmap, 0, 0);\n      imageBitmap.close();\n      toCtx = null;\n\n      _this5.debug('Finished!');\n\n      return to;\n    }\n\n    _this5.debug('Unsharp result');\n\n    var tmpCanvas = _this5.options.createCanvas(opts.toWidth, opts.toHeight);\n\n    var tmpCtx = tmpCanvas.getContext('2d');\n    tmpCtx.drawImage(imageBitmap, 0, 0);\n    imageBitmap.close();\n    var iData = tmpCtx.getImageData(0, 0, opts.toWidth, opts.toHeight);\n\n    _this5.__mathlib.unsharp_mask(iData.data, opts.toWidth, opts.toHeight, opts.unsharpAmount, opts.unsharpRadius, opts.unsharpThreshold);\n\n    toCtx.putImageData(iData, 0, 0); // Safari 12 workaround\n    // https://github.com/nodeca/pica/issues/199\n\n    tmpCanvas.width = tmpCanvas.height = 0;\n    iData = tmpCtx = tmpCanvas = toCtx = null;\n\n    _this5.debug('Finished!');\n\n    return to;\n  });\n};\n\nPica.prototype.resize = function (from, to, options) {\n  var _this6 = this;\n\n  this.debug('Start resize...');\n  var opts = assign({}, DEFAULT_RESIZE_OPTS);\n\n  if (!isNaN(options)) {\n    opts = assign(opts, {\n      quality: options\n    });\n  } else if (options) {\n    opts = assign(opts, options);\n  }\n\n  opts.toWidth = to.width;\n  opts.toHeight = to.height;\n  opts.width = from.naturalWidth || from.width;\n  opts.height = from.naturalHeight || from.height; // Legacy `.quality` option\n\n  if (Object.prototype.hasOwnProperty.call(opts, 'quality')) {\n    if (opts.quality < 0 || opts.quality > 3) {\n      throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n    }\n\n    opts.filter = filter_info.q2f[opts.quality];\n  } // Prevent stepper from infinite loop\n\n\n  if (to.width === 0 || to.height === 0) {\n    return Promise.reject(new Error(\"Invalid output size: \".concat(to.width, \"x\").concat(to.height)));\n  }\n\n  if (opts.unsharpRadius > 2) opts.unsharpRadius = 2;\n  opts.canceled = false;\n\n  if (opts.cancelToken) {\n    // Wrap cancelToken to avoid successive resolve & set flag\n    opts.cancelToken = opts.cancelToken.then(function (data) {\n      opts.canceled = true;\n      throw data;\n    }, function (err) {\n      opts.canceled = true;\n      throw err;\n    });\n  }\n\n  var DEST_TILE_BORDER = 3; // Max possible filter window size\n\n  opts.__destTileBorder = Math.ceil(Math.max(DEST_TILE_BORDER, 2.5 * opts.unsharpRadius | 0));\n  return this.init().then(function () {\n    if (opts.canceled) return opts.cancelToken; // if createImageBitmap supports resize, just do it and return\n\n    if (_this6.features.cib) {\n      if (filter_info.q2f.indexOf(opts.filter) >= 0) {\n        return _this6.__resizeViaCreateImageBitmap(from, to, opts);\n      }\n\n      _this6.debug('cib is enabled, but not supports provided filter, fallback to manual math');\n    }\n\n    if (!CAN_USE_CANVAS_GET_IMAGE_DATA) {\n      var err = new Error('Pica: cannot use getImageData on canvas, ' + \"make sure fingerprinting protection isn't enabled\");\n      err.code = 'ERR_GET_IMAGE_DATA';\n      throw err;\n    } //\n    // No easy way, let's resize manually via arrays\n    //\n\n\n    var stages = createStages(opts.width, opts.height, opts.toWidth, opts.toHeight, _this6.options.tile, opts.__destTileBorder);\n    return _this6.__processStages(stages, from, to, opts);\n  });\n}; // RGBA buffer resize\n//\n\n\nPica.prototype.resizeBuffer = function (options) {\n  var _this7 = this;\n\n  var opts = assign({}, DEFAULT_RESIZE_OPTS, options); // Legacy `.quality` option\n\n  if (Object.prototype.hasOwnProperty.call(opts, 'quality')) {\n    if (opts.quality < 0 || opts.quality > 3) {\n      throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n    }\n\n    opts.filter = filter_info.q2f[opts.quality];\n  }\n\n  return this.init().then(function () {\n    return _this7.__mathlib.resizeAndUnsharp(opts);\n  });\n};\n\nPica.prototype.toBlob = function (canvas, mimeType, quality) {\n  mimeType = mimeType || 'image/png';\n  return new Promise(function (resolve) {\n    if (canvas.toBlob) {\n      canvas.toBlob(function (blob) {\n        return resolve(blob);\n      }, mimeType, quality);\n      return;\n    }\n\n    if (canvas.convertToBlob) {\n      resolve(canvas.convertToBlob({\n        type: mimeType,\n        quality: quality\n      }));\n      return;\n    } // Fallback for old browsers\n\n\n    var asString = atob(canvas.toDataURL(mimeType, quality).split(',')[1]);\n    var len = asString.length;\n    var asBuffer = new Uint8Array(len);\n\n    for (var i = 0; i < len; i++) {\n      asBuffer[i] = asString.charCodeAt(i);\n    }\n\n    resolve(new Blob([asBuffer], {\n      type: mimeType\n    }));\n  });\n};\n\nPica.prototype.debug = function () {};\n\nmodule.exports = Pica;\n\n},{\"./lib/mathlib\":1,\"./lib/mm_resize/resize_filter_info\":7,\"./lib/pool\":13,\"./lib/stepper\":14,\"./lib/tiler\":15,\"./lib/utils\":16,\"./lib/worker\":17,\"object-assign\":22,\"webworkify\":23}]},{},[])(\"/index.js\")\n});\n"],"names":["a","$41faaf01e3f65d27$exports","r","e","n","t","o","i","f","c","undefined","u","Error","code","p","exports","call","length","_dereq_","module1","Multimath","mm_unsharp_mask","mm_resize","MathLib","requested_features","__requested_features","features","js","indexOf","wasm","has_wasm","use","prototype","Object","create","constructor","resizeAndUnsharp","options","cache","result","resize","unsharpAmount","unsharp_mask","toWidth","toHeight","unsharpRadius","unsharpThreshold","clampTo8","clampNegative","convolveHor","src","dest","srcW","srcH","destW","filters","g","b","filterPtr","filterShift","filterSize","srcPtr","srcY","destX","filterVal","srcOffset","destOffset","convolveVert","convolveHorWithPre","alpha","convolveVertWithPre","name","fn","wasm_fn","wasm_src","createFilters","_require","width","height","destH","scaleX","scaleY","offsetX","offsetY","Uint8Array","filter","filtersX","filtersY","tmp","Uint16Array","hasAlpha","ptr","len","resetAlpha","dst","FILTER_INFO","toFixedPoint","num","Math","round","srcSize","destSize","scale","offset","destPixel","srcPixel","srcFirst","srcLast","filterElementSize","floatFilter","fxpFilter","total","pxl","idx","floatVal","filterTotal","leftNotEmpty","rightNotEmpty","filterFunction","scaleInverted","scaleClamped","min","srcWindow","win","packedFilter","Int16Array","maxFilterElementSize","floor","packedFilterPtr","slowCopy","subarray","set","max","Float32Array","ceil","box","x","hamming","xpi","PI","sin","cos","lanczos2","lanczos3","mks2013","f2q","q2f","IS_LE","Uint32Array","buffer","__","copyInt16asLE","target","target_offset","byteLength","data","src_size","tmp_offset","__align","src_offset","tmp_size","filtersX_offset","filtersY_offset","alloc_bytes","instance","__instance","mem","__memory","mem32","src32","convolveHV","_convolveHV","dest32","glur_mono16","img","amount","radius","threshold","v1","v2","vmul","diff","iTimes4","brightness","hsv_v16","size","out","blured","amountFp","thresholdFp","abs","pixels","img_bytes_cnt","hsv_bytes_cnt","blur_bytes_cnt","blur_line_byte_cnt","blur_offset","hsv_offset","blur_tmp_offset","blur_line_offset","exp","img32","_hsv_v16","blurMono16","_blurMono16","unsharp","_unsharp","Pool","idle","available","acquired","lastId","timeoutId","acquire","resource","_this","pop","id","release","_this2","lastUsed","Date","now","push","setTimeout","gc","_this3","destroy","fromWidth","fromHeight","srcTileSize","destTileBorder","minScale","stageCount","log","pow","pixelFloor","nearest","pixelCeil","y","innerX","innerY","toTileWidth","toTileHeight","innerTileWidth","innerTileHeight","tiles","toX","toY","toInnerX","toInnerY","toInnerWidth","toInnerHeight","objClass","obj","toString","isCanvas","element","cname","isImage","isImageBitmap","limiter","concurrency","active","queue","roll","shift","Promise","resolve","reject","then","err","cib_quality_name","cib_support","createCanvas","createImageBitmap","resizeWidth","resizeHeight","resizeQuality","bitmap","status","close","worker_offscreen_canvas_support","OffscreenCanvas","btoa","concat","workerPayload","self","postMessage","canvas","ctx","getContext","rect","w","Worker","onmessage","ev","onerror","can_use_canvas","usable","d","createImageData","putImageData","getImageData","cib_can_use_region","Image","image","onload","mathLib","tileOpts","opts","srcBitmap","drawImage","a0","a1","a2","a3","b1","b2","left_corner","right_corner","convolveMono16","line","coeff","prev_src","curr_src","curr_out","prev_out","prev_prev_out","src_index","out_index","line_index","j","coeff_a0","coeff_a1","coeff_b1","coeff_b2","sigma","g1","g2","k","tmp_line","assign","base64decode","hasWebAssembly","DEFAULT_OPTIONS","MultiMath","__cache","__init_promise","__modules","modules","__wasm","__isLE","init","all","keys","map","WebAssembly","compile","__base64decode","m","__reallocate","bytes","Memory","initial","mem_size","grow","memsize","env_extra","Module","env_base","memoryBase","memory","tableBase","table","Table","Instance","env","number","base","reminder","str","input","replace","bits","BASE64_MAP","charAt","tailbits","wa","bin","test","getOwnPropertySymbols","hasOwnProperty","propIsEnumerable","propertyIsEnumerable","shouldUseNative","test1","String","getOwnPropertyNames","test2","fromCharCode","order2","join","test3","split","forEach","letter","source","from","symbols","to","toObject","val","TypeError","s","arguments","key","bundleFn","sources","stringify","JSON","wkey","cacheKeys","l","default","random","wcache","skey","scache","workerSources","resolveSources","depPath","depKey","URL","window","webkitURL","mozURL","msURL","blob","Blob","type","bare","workerUrl","createObjectURL","worker","objectURL","_arrayLikeToArray","arr","arr2","Array","webworkify","utils","createStages","createRegions","filter_info","singletones","NEED_SAFARI_FIX","navigator","userAgent","hardwareConcurrency","DEFAULT_PICA_OPTS","tile","tmpCanvas","document","createElement","DEFAULT_RESIZE_OPTS","CAN_NEW_IMAGE_DATA","CAN_CREATE_IMAGE_BITMAP","CAN_USE_CANVAS_GET_IMAGE_DATA","CAN_USE_OFFSCREEN_CANVAS","CAN_USE_CIB_REGION_FOR_IMAGE","workerFabric","value","terminate","url","revokeObjectURL","Pica","limiter_key","__limit","cib","ww","__workersPool","__mathlib","checkCibResize","checkOffscreenCanvas","__initPromise","ImageData","Uint8ClampedArray","ImageBitmap","debug","slice","wkr","wpool_key","initMath","mathlib","checkCibRegion","__invokeResize","__mathCache","cancelToken","transfer","preload","wasm_nodule","__extractTileData","stageEnv","extractTo","srcImageBitmap","srcCtx","tmpCtx","globalCompositeOperation","__landTileData","toImageData","toCtx","__tileAndResize","isImageBitmapReused","imageBitmap","canceled","jobs","regions","__destTileBorder","srcImageData","cleanup","__processStages","stages","_this4","_stages$shift2","_arrayWithHoles","isArray","_iterableToArrayLimit","_s","_e","_i","Symbol","iterator","_arr","_n","_d","next","done","_unsupportedIterableToArray","minLen","_nonIterableRest","isLastStage","res","__resizeViaCreateImageBitmap","_this5","iData","_this6","isNaN","quality","naturalWidth","naturalHeight","resizeBuffer","_this7","toBlob","mimeType","convertToBlob","asString","atob","toDataURL","asBuffer","charCodeAt","$e73bf42412feb220$var$dropArea","getElementById","$e73bf42412feb220$var$previewList","$e73bf42412feb220$var$downloadAllButton","querySelector","$e73bf42412feb220$var$resolutionSelect","$e73bf42412feb220$var$resolutionDropdown","$e73bf42412feb220$var$applyResolutionButton","$e73bf42412feb220$var$uploadButton","$e73bf42412feb220$var$fileInput","$e73bf42412feb220$var$customResWidth","$e73bf42412feb220$var$customResHeight","$e73bf42412feb220$var$loader","$e73bf42412feb220$var$fileCounter","$e73bf42412feb220$var$fileCounterContent","$e73bf42412feb220$var$finishedHeading","$e73bf42412feb220$var$items","$e73bf42412feb220$var$itemIdCounter","$e73bf42412feb220$var$cropSize","$e73bf42412feb220$var$previewTimer","$e73bf42412feb220$var$currentGlobalSize","$e73bf42412feb220$var$pica","__esModule","$e73bf42412feb220$var$handleIncomingFiles","fileList","preparedFiles","file","$e73bf42412feb220$var$prepareFileForProcessing","Boolean","$e73bf42412feb220$var$addItem","previewUrl","item","cropSize","croppedUrl","autoCrop","autoCropSize","originalWidth","originalHeight","sizeMode","el","statusEl","imgEl","originalImgEl","overlayEl","shadeEls","cropBoxEl","thumbWrapEl","sizeSelectEl","sizeResetEl","downloadBtn","$e73bf42412feb220$var$createListItem","listItem","classList","add","dataset","thumbWrap","croppedImage","originalImage","overlay","shadeTop","shadeRight","shadeBottom","shadeLeft","cropBox","imageInfoContainer","sizeRow","imageNameInfo","imageStatus","imageSizeDelta","statusHelp","innerText","$e73bf42412feb220$var$formatFileSize","appendChild","sizeSelect","$e73bf42412feb220$var$buildItemSizeSelect","select","followOption","option","disabled","opt","text","addEventListener","parts","$e73bf42412feb220$var$clearItemReadyState","parseInt","$e73bf42412feb220$var$setItemState","$e73bf42412feb220$var$generateAutoCropPreview","$e73bf42412feb220$var$updateItemSizeSelectLabel","$e73bf42412feb220$var$updateFileCounter","sizeReset","onclick","downloadButton","downloadIcon","createElementNS","downloadIconPath1","downloadIconPath2","setAttribute","$e73bf42412feb220$var$downloadImage","link","href","download","click","removeButton","removeIcon","removeIconPath","title","$e73bf42412feb220$var$removeItem","index","findIndex","remove","splice","actionsContainer","statusHelpEl","sizeDeltaEl","$e73bf42412feb220$var$updateItemStatusChip","$e73bf42412feb220$var$initCropDrag","dragState","onPointerMove","dx","clientX","startX","dy","clientY","startY","nextX","$e73bf42412feb220$var$clamp","startCropX","bounds","minX","maxX","nextY","startCropY","minY","maxY","metrics","$e73bf42412feb220$var$updateItemCropOverlays","onPointerUp","removeEventListener","$e73bf42412feb220$var$getWrapMetrics","cropDisplay","$e73bf42412feb220$var$getDisplayCrop","displayWidth","displayHeight","setPointerCapture","pointerId","$e73bf42412feb220$var$schedulePreviewUpdate","$e73bf42412feb220$var$isHeicFile","toLowerCase","heic2any","alert","converted","toType","convertedBlob","baseName","File","lastModified","console","error","$e73bf42412feb220$var$handleFiles","sizeToUse","globalSize","Compressor","success","compressedFile","reader","FileReader","$e73bf42412feb220$var$createPreview","imageSrc","cropPromise","useExistingCrop","topCrop","smartcrop","crop","downscaleCanvas","croppedImageURL","$e73bf42412feb220$var$updateItemSizeDelta","$e73bf42412feb220$var$updateDownloadAllVisibility","catch","readAsDataURL","$e73bf42412feb220$var$isImagePlural","files","readyCount","queuedCount","pendingCount","processingCount","style","backgroundColor","$e73bf42412feb220$var$updateApplyButtonLabel","state","originalSize","newSize","delta","$e73bf42412feb220$var$updateItemCropOverlayForWrap","wrapEl","left","top","wrapWidth","wrapHeight","clearTimeout","previewSize","$e73bf42412feb220$var$getPreviewCropSize","selectedResolution","sizeChanged","label","helpText","firstOption","clientWidth","clientHeight","kb","toFixed","mb","preventDefault","dataTransfer","$e73bf42412feb220$var$handleUserEntry","some","$e73bf42412feb220$var$downloadAllCroppedImages","zip","JSZip","generateAsync"],"version":3,"file":"index.6301a1e5.js.map"}